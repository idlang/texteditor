/*!
 * ==========================================================
 *  USER INTERFACE MODULE FOR TEXT EDITOR PLUGIN 1.0.0
 * ==========================================================
 * Author: Taufik Nurrohman <http://latitudu.com>
 * License: MIT
 * ----------------------------------------------------------
 */

var TE_ui = function(o, parent) {

    var w = window,
	    d = document,
		r = this,
		el = parent.el,
		C = 'text-editor',
	    target = parent.target,
		field = el('span', {
			'class': C
		}).$,
		controls = el('nav', {
			'class': C + '-controls'
		}).$,
		noop = function() {},

	// default option(s)
	defaults = {
		
	};

	// wrap text area with `<span class="text-editor-field"></span>`
	target.className = C + '-field';
	target.parentNode.insertBefore(field, target);
	field.appendChild(target);
	field.insertBefore(controls, target);

	function is_object(x) {
		return typeof x === "object";
	}

    function extend(a, b) {
        a = a || {};
        for (var i in b) {
            if (is_object(b[i])) {
                a[i] = extend(a[i], b[i]);
            } else {
                a[i] = b[i];
            }
        }
        return a;
    }

	function printf(s, a) {
		return s.replace(/%(\d+)s/g, function(b, c) {
			return a[c] ? a[c] : b;
		}).replace(/%s/g, a[0] || '%s');
	}

	function slug(s) {
		return s.toLowerCase().replace(/[^\da-z-]/g, '-').replace(/\-+/g, '-').replace(/^\-|\-$/g, "");
	}

	function control(n, a) {
		var btn = el('a', {
			'href': 'javascript:;',
			'title': a.title || "",
			'tabindex': -1,
			'class': C + '-control ' + C + '-control-' + slug(n)
		}).content(a.text || "").on("click", a.click ? function(e) {
			a.click(parent, e, n), e.preventDefault();
		} : noop).$;
		controls.insertBefore(btn, null);
		return r;
	}

	r.parent = parent;
	r.control = control;
	r.controls = function(a) {
		for (var i in a) {
			control(i, a[i]);
		}
		return r;
	};

	return r;

};

TE.prototype.ui = function(o) {
	return new TE_ui(o, this);
};