/*!
 * ==========================================================
 *  HTML TEXT EDITOR PLUGIN 1.2.6
 * ==========================================================
 * Author: Taufik Nurrohman <https://github.com/tovic>
 * License: MIT
 * ----------------------------------------------------------
 */
TE.HTML=function(A,e){function $(A){return A.split(a("("+d[3]+")+"))[0]}function v(A){return g=A.match(/(?:^|\n)([\t ]*).*$/),g&&g[1]||""}function k(A,e,E){var l,O=r.$(),t=O.value,R=O.before,I=H[e]||e,L=H[E]||E,N=$(I),n=$(L),T=v(R),S=Y[""];return b=I,r[0](),t&&t!==S?(r.tidy("\n\n","").replace(/[\t ]*\n[\t ]*/g,P[0]+P[2]+n+P[1]+"\n"+B+P[0]+L+P[1]).wrap(P[0]+I+P[1]+"\n"+B+P[0]+L+P[1],P[0]+P[2]+n+P[1]+"\n"+P[0]+P[2]+N+P[1]+"\n\n",1).replace(a("\\n"+i(B)+W[0]+i(L)+W[1]+"\\s*"+W[0]+W[2]+i(n)+W[1]+"\\n","g"),"\n"+P[0]+P[2]+N+P[1]+"\n\n"+P[0]+I+P[1]+"\n").select(r.$().end),f&&C.tools.p.click(A,r),r[1](),!1):void((l=R.match(a("(?:^|\\n)[\\t ]+"+W[0]+"("+W[2]+"?)(?:"+i($(H.ul))+"|"+i($(H.ol))+")"+h+W[1]+"\\s*$")))?r.insert("\n"+T+(l[1]?"":B),0):(l=R.match(a(W[0]+i(n)+K+W[1]+".*?$")))?a(W[0]+W[2]+i(n)+W[1]+"\\s*$").test(R)?r.tidy("\n"+T,!1).insert(S).wrap(P[0]+n+l[1]+P[1],P[0]+P[2]+n+P[1]):a(W[1]+"\\s*$").test(R)?r.insert(S).wrap("\n"+T+B+P[0]+I+P[1]+"\n"+T+B+B+P[0]+n+l[1]+P[1],P[0]+P[2]+n+P[1]+"\n"+T+B+P[0]+P[2]+N+P[1]+"\n"+T):r.insert(P[0]+P[2]+n+P[1]+"\n"+T+P[0]+n+l[1]+P[1],0).insert(S):a(W[0]+W[2]+i(n)+W[1]+"\\s*$").test(R)?r.insert(S).wrap("\n"+T+P[0]+L+P[1],P[0]+P[2]+n+P[1]):r.tidy("\n\n").insert(S).wrap(P[0]+I+P[1]+"\n"+B+P[0]+L+P[1],P[0]+P[2]+n+P[1]+"\n"+P[0]+P[2]+N+P[1]))}function V(A,e){return!e.get(0)&&f&&C.tools.p.click(A,e),e}function w(A){return o(A.replace(/\s+/g," "))}function y(A){return G(w(A),[a(W[0]+".*?"+W[1],"g"),'"',"'"],["","&#34;","&#39;"])}function x(A){return G(w(A),[a(W[0]+".*?"+W[1],"g"),/\s/g,'"'],["","%20","%22"])}var b,g,E="–",O="…",t="↑",R="↓",I="↵",L="⌘",N="✘",n="⇧",r=new TE(A),T=r._,S=T.edge,i=T.x,l=T.extend,F=T.i,a=T.pattern,o=T.trim,C=r.ui(l({auto_encode_html:1,auto_p:1,tools:"clear | b i u s | sub sup | abbr | a img | p,h1,h2,h3,h4,h5,h6 | blockquote,q pre,code | ul ol | indent outdent | table | hr | undo redo",states:{tr:[1,10],td:[1,10],abbr:{}},languages:{tools:{clear:["Clear Format",N],b:["Bold",L+"+B"],i:["Italic",L+"+I"],u:["Underline",L+"+U"],s:["Strike",L+"+"+N],a:["Link",L+"+L"],img:["Image",L+"+G"],sub:["Subscript",L+"+"+R],sup:["Superscript",L+"+"+t],abbr:["Abbreviation",L+"+"+n+"+?"],p:["Paragraph",L+"+"+I],"p,h1,h2,h3,h4,h5,h6":["H1 "+E+" H6",L+"+H"],"blockquote,q":["Quote",L+"+Q"],"pre,code":["Code",L+"+K"],ul:["Unordered List",L+"+-"],ol:["Ordered List",L+"++"],table:["Table",L+"+T"],hr:["Horizontal Rule",L+"+R"]},modals:{a:{title:["Link URL","Link Title"],placeholder:["http://","link title here"+O]},img:{title:["Image URL","Image Title","Image Caption"],placeholder:["http://","image title here"+O,"image caption here"+O]},abbr:{title:"Abbreviation",placeholder:"meaning here"+O},table:{title:["Number of Columns","Number of Rows","Table Caption"],placeholder:["3","3","table caption here"+O]}},placeholders:{table:["Table Head %1.%2","Table Data %1.%2","Table Foot %1.%2"]}},advance_a:1,advance_img:1,advance_table:1,formats:{b:"strong",i:"em",u:"u",s:'del datetime="%1-%2-%3"',a:"a",figure:"figure",figcaption:"figcaption",img:"img",sub:"sub",sup:"sup",abbr:"abbr",p:"p",br:"br",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",blockquote:"blockquote",q:"q",pre:"pre",code:"code",ul:"ul",ol:"ol",li:"li",table:'table border="1"',caption:"caption",thead:"thead",tbody:"tbody",tfoot:"tfoot",tr:"tr",th:"th",td:"td",hr:"hr"}},e)),s=T.format,G=T.replace,c=r.config,f=c.auto_p,H=(c.classes,c.formats),u=c.languages,M=c.states,U=c.suffix,B=c.tab,P=c.unit[0][0],p=c.unit[0][1],W=c.unit[1][0],d=c.unit[1][1],h="(?:"+d[3]+"[^"+W[0]+W[1]+"]*?)?",K="(|"+d[3]+"[^"+W[0]+W[1]+"]*?)",m="([\\s\\S]*?)",Y=u.placeholders;return r.type="HTML",l(C.tools,{clear:{i:"eraser",click:function(A,e){var I,E=e[0]().$(),O=E.before,t=E.after,R=E.value,L=W[0]+"[^"+W[0]+W[1]+"]+?"+W[1],N=W[0]+"[^"+W[2]+W[0]+W[1]+"]+?"+W[1],n=W[0]+W[2]+"[^"+W[0]+W[1]+"]+?"+W[1];return!R&&t&&(I=a("^"+L)).test(t)?(e.replace(I,"",1),!1):(a(L).test(R)||O.slice(-1)===P[1]||t[0]===P[0]?e.replace(a(L,"g"),"").unwrap(a(N),a(n)):e.insert(""),e[1](),!!t)}},b:{i:"bold",click:function(A,e){return V(A,e).i().format(H.b),!1}},i:{i:"italic",click:function(A,e){return V(A,e).i().format(H.i),!1}},u:{i:"underline",click:function(A,e){return V(A,e).i().format(H.u),!1}},s:{i:"strikethrough",click:function(A,e){return V(A,e).i().format(s(H.s,e._.time())),!1}},a:{i:"link",click:function(A,e){var t,R,E=H.a,O=u.modals.a;return C.prompt(["a[href]",O.title[0]],O.placeholder[0],1,function(A,e,I){I=x(I),t=I;var N,n,L=location.host;-1!==t.indexOf("://")&&(N=1),""!==L&&-1!==t.indexOf("://"+L)&&(N=0),/^([.\/?&#]|javascript:)/.test(t)&&(N=0),C.prompt(["a[title]",O.title[1]],O.placeholder[1],0,function(A,e,O){R=y(O),V(A,e).$().length||e.insert(Y[""]),n=c.advance_a&&N?p[3]+"rel"+p[0]+p[1]+"nofollow"+p[2]+p[3]+"target"+p[0]+p[1]+"_blank"+p[2]:"",e.i().format(E+p[3]+"href"+p[0]+p[1]+t+p[2]+(R?p[3]+"title"+p[0]+p[1]+R+p[2]:"")+n)})}).record(),!1}},img:{i:"image",click:function(A,e){var n,r,E=e.$(),O=H.img,t=H.figure,R=H.figcaption,I=E.value,L=u.modals.img,N=c.advance_img;return C.prompt(["img[src]",L.title[0]],L.placeholder[0],1,function(A,e,E){E=x(E),n=E,C.prompt(["img[title]",L.title[N?2:1]],L.placeholder[N?2:1],0,function(A,e,E){r=y(E),I||(I=n.split(/[\/\\\\]/).pop()),I=y(I),e[0](),N&&r?(e.tidy("\n\n","").insert(P[0]+t+P[1]+"\n"+B+P[0]+O+p[3]+"alt"+p[0]+p[1]+I+p[2]+p[3]+"src"+p[0]+p[1]+n+p[2]+U+"\n"+B+P[0]+R+P[1]+r+P[0]+P[2]+$(R)+P[1]+"\n"+P[0]+P[2]+$(t)+P[1]+"\n\n",0,1),f&&C.tools.p.click(A,e)):V(A,e).tidy(a(W[0]+"[^"+W[0]+W[1]+W[2]+"]+?"+W[1]+"\\s*$").test(e.$().before)?"":" ","").insert(P[0]+O+p[3]+"alt"+p[0]+p[1]+I+p[2]+p[3]+"src"+p[0]+p[1]+n+p[2]+(r?p[3]+"title"+p[0]+p[1]+r+p[2]:"")+U+" ",0,1),e[1]()})}),!1}},sub:{i:"subscript",click:function(A,e){var E=H.sub,O=H.sup,t=$(O);return V(A,e)[0]().unwrap(a(W[0]+i(t)+h+W[1]),P[0]+P[2]+t+P[1]).i().format(E)[1](),!1}},sup:{i:"superscript",click:function(A,e){var E=H.sub,O=H.sup,t=$(E);return V(A,e)[0]().unwrap(a(W[0]+i(t)+h+W[1]),P[0]+P[2]+t+P[1]).i().format(O)[1](),!1}},abbr:{i:"question",click:function(A,e){var l,F,E=e.$(),O=o(E.value),t=u.modals.abbr,R=e.get(),I=o(O||Y[""]),L=H.abbr,N=$(L),n=W[0]+i(L)+K+W[1],r=W[0]+i(L)+h+W[1],T=W[0]+W[2]+i(N)+W[1],S=a(n+m+T);return R.replace(S,function(A,e,E){(E=o(E))&&(M.abbr[E]=(e.match(a(d[3]+"+title"+d[0]+d[1]+"\\s*(.*?)\\s*"+d[2]))||["",""])[1])}),l=M.abbr,O&&l[O]?(e.i().format(L+p[3]+"title"+p[0]+p[1]+l[O]+p[2]),!1):(C.prompt(["abbr[title]",t.title],l[I]||t.placeholder,!l[O],function(A,e,E,t){E=y(E||t),e[0](),O||e.insert(E.replace(/[^a-z\d]/gi," ").replace(/([a-z\d])[^ ]* */gi,"$1").toUpperCase());for(F in l)if(y(l[F])===E){e.insert(F);break}V(A,e).unwrap(a(r),a(T)).unwrap(a(r),a(T),1).i().format(L+p[3]+"title"+p[0]+p[1]+E+p[2])[1]()}).record(),!1)}},p:{i:"paragraph",click:function(A,e){var S,E=e.$(),O=E.value,t=H.p,R=H.br,I=$(t),L=$(R),N=E.before,n=E.after,r=v(N),T=Y[""];if(e[0](),O&&-1!==O.indexOf("\n")){var l=a("^(?:\\s*"+W[0]+i(I)+h+W[1]+"\\s*)+"+m+"(?:\\s*"+W[0]+W[2]+i(I)+W[1]+"\\s*)+$");l.test(O)?e.replace(l,"$1").replace(a("\\s*"+W[0]+W[2]+i(I)+W[1]+"\\s*"+W[0]+i(I)+h+W[1]+"\\s*","g"),"\n\n").replace(a("\\s*"+W[0]+i(L)+h+W[1]+"\\s*","g"),"\n"):e.replace(/\n/g,"\n"+P[0]+R+U+"\n").replace(a("(\\s*"+W[0]+i(L)+h+U+"\\s*){2,}","g"),P[0]+P[2]+I+P[1]+"\n"+P[0]+t+P[1]).wrap(P[0]+t+P[1],P[0]+P[2]+I+P[1],1).replace(a("("+W[0]+i(I)+h+W[1]+")+","g"),"$1").replace(a("("+W[0]+W[2]+i(I)+W[1]+")+","g"),"$1").tidy("\n")}else a("^\\s*"+W[0]+W[2]+i(I)+W[1]).test(n)?a(W[0]+i(I)+h+W[1]+"\\s*$").test(N)?e.unwrap(a("\\s*"+W[0]+i(I)+h+W[1]+"\\s*"),a("\\s*"+W[0]+W[2]+i(I)+W[1])).replace(T,"").tidy("\n","\n"+r):(S=N.match(a(W[0]+i(I)+K+W[1]+".*?$")))&&e.wrap(P[0]+P[2]+I+P[1]+"\n"+r+P[0]+I+S[1]+P[1],"").insert(T):e.tidy("\n\n").format(t,0,"\n\n");return e[1](),!1}},"p,h1,h2,h3,h4,h5,h6":{i:"header",click:function(A,e){var R,I,E=e.$(),O=[H.p,H.h1,H.h2,H.h3,H.h4,H.h5,H.h6],t=[];for(R in O)t[R]=$(O[R]);var N=(i(O).join("|"),i(t).join("|")),n="\\s*"+W[0]+"("+N+")"+K+W[1]+"\\s*",r=a("\\s*"+W[0]+"(?:"+N+")"+h+W[1]+"\\s*"),T=a("\\s*"+W[0]+W[2]+"(?:"+N+")"+W[1]+"\\s*"),S=E.value.match(a("^"+n));return S||(S=E.before.match(a(n+"$"))||[]),I=S[2]||"",R=+(S[1]||"h0").slice(1),e[0]().unwrap(r,T).unwrap(r,T,1).i().tidy("\n\n").format(R>5?t[0]+I:t[R+1]+I,0,"\n\n")[1](),!1}},"blockquote,q":{i:"quote-right",click:function(A,e){var E=e.$(),O=E.value,t=H.blockquote,R=H.q,I=H.p,L=$(I),N=W[0]+i(L)+h+W[1];if(a("(^|\\n|"+N+")$").test(E.before)){if(f&&(O===Y[""]||a("("+N+")$").test(E.before)))return e.select(),!1;e[0]().format(t,0,"\n\n","\n"),f&&(!O||e.match(a("^[^"+W[0]+"\\n]*?[^"+W[1]+"]$"))?e.wrap(B+P[0]+I+P[1],P[0]+P[2]+L+P[1]):e[a("((^|\\n)"+i(B)+")+").test(O)?"outdent":"indent"](B)),e[1]()}else e.i().format(R);return!1}},"pre,code":{i:"code",click:function(A,e){function F(A){return t?G(A,["&","<",">"],["&amp;","&lt;","&gt;"]):A}function o(A){return t?G(A,["&amp;","&lt;","&gt;"],["&","<",">"]):A}var E=e.$(),O=E.value,t=c.auto_encode_html,R=H.pre,I=H.code,L=$(R),N=$(I),n=W[0]+i(L)+h+W[1]+"\\s*"+W[0]+i(N)+h+W[1]+"\\s*",r="\\s*"+W[0]+W[2]+i(N)+W[1]+"\\s*"+W[0]+W[2]+i(L)+W[1],T=a(n+"\\s*$"),S=a("^\\s*"+r),l=a("^"+m+"$");return a("(^|\\n|"+n+")$").test(E.before)?T.test(E.before)&&S.test(E.after)?e[0]().unwrap(a(T),a(S)).replace(l,o)[1]():e[0]().tidy("\n\n").wrap(P[0]+R+P[1]+P[0]+I+P[1],P[0]+P[2]+N+P[1]+P[0]+P[2]+L+P[1]).insert(O||Y[""]).replace(l,F)[1]():e[0]().format(I).replace(l,function(A){return w(a("^\\s*"+W[0]+W[2]+i(N)+W[1]).test(e.$().after)?F(A):o(A))})[1](),!1}},ul:{i:"list-ul",click:function(A,e){var E=H.ol,O=H.ul,t=$(E),R=$(O),I="("+i(R)+"|"+i(t)+")";return e.match(a(W[0]+I+h+W[1]+m+W[0]+W[2]+I+W[1]))?e[0]().replace(a(W[0]+i(t)+K+W[1],"g"),P[0]+R+"$1"+P[1]).replace(a(W[0]+W[2]+i(t)+W[1],"g"),P[0]+P[2]+R+P[1])[1]():k(A,O,H.li),!1}},ol:{i:"list-ol",click:function(A,e){var E=H.ol,O=H.ul,t=$(E),R=$(O),I="("+i(R)+"|"+i(t)+")";return e.match(a(W[0]+I+h+W[1]+m+W[0]+W[2]+I+W[1]))?e[0]().replace(a(W[0]+i(R)+K+W[1],"g"),P[0]+t+"$1"+P[1]).replace(a(W[0]+W[2]+i(R)+W[1],"g"),P[0]+P[2]+t+P[1])[1]():k(A,E,H.li),!1}},table:function(A,e){var Y,b,g,v,E=M.tr,O=M.td,t=u.modals.table,R=u.placeholders.table,I=o(s(R[0],[1,1])),L=c.advance_table?B:"",N=H.table,n=H.caption,r=H.thead,T=H.tbody,i=H.tfoot,l=H.tr,a=H.th,G=H.td,f=$(N),D=$(n),U=$(r),p=$(T),W=$(i),d=$(l),h=$(a),K=$(G),m=[];return e[0]().$().value===I?(e.select(),!1):(C.prompt(["table>td",t.title[0]],t.placeholder[0],0,function(A,e,c,H){b=S(F(c)||H,O[0],O[1]),C.prompt(["table>tr",t.title[1]],t.placeholder[1],0,function(A,e,O,c){g=S(F(O)||c,E[0],E[1]),C.prompt(["table>caption",t.title[2]],t.placeholder[2],0,function(A,e,E){var t,S,F,c,H,O="";for(v=w(E),t=0;g>t;++t){for(Y=L+B+P[0]+l+P[1]+"\n",S=0;b>S;++S)Y+=L+B+B+P[0]+G+P[1]+o(s(R[1],[t+1,S+1]))+P[0]+P[2]+K+P[1]+"\n";Y+=L+B+P[0]+P[2]+d+P[1],m.push(Y)}for(m=m.join("\n"),Y=B+(L?P[0]+r+P[1]+"\n"+B+B+P[0]+l+P[1]:P[0]+d+P[1])+"\n",F=0;b>F;++F)Y+=L+B+B+P[0]+a+P[1]+o(s(R[0],[1,F+1]))+P[0]+P[2]+h+P[1]+"\n";if(L){for(O+=B+P[0]+i+P[1]+"\n",O+=B+B+P[0]+l+P[1]+"\n",F=0;b>F;++F)O+=B+B+B+P[0]+G+P[1]+o(s(R[2],[1,F+1]))+P[0]+P[2]+K+P[1]+"\n";O+=B+B+P[0]+P[2]+l+P[1]+"\n",O+=B+P[0]+P[2]+W+P[1]+"\n"}Y+=L+B+P[0]+P[2]+d+P[1]+(L?"\n"+B+P[0]+P[2]+U+P[1]+"\n"+O+B+P[0]+T+P[1]:"")+"\n",m=Y+m+(L?"\n"+B+P[0]+P[2]+p+P[1]:"")+"\n",e.tidy("\n\n").insert(P[0]+N+P[1]+"\n"+(v&&n?B+P[0]+n+P[1]+v+P[0]+P[2]+D+P[1]+"\n":"")+m+P[0]+P[2]+f+P[1]),c=e.$(),H=c.start+c.value.indexOf(I),e.select(H,H+I.length)[1]()})})}),!1)},hr:{i:"ellipsis-h",click:function(A,e){return g=v(e.$().before),e.tidy("\n\n","").insert(g+P[0]+H.hr+U+"\n\n",0),!1}}}),c.keys&&l(C.keys,{"delete":"clear","control+delete":"s","control+b":"b","control+i":"i","control+u":"u","control+l":"a","control+g":"img","control+arrowdown":"sub","control+arrowup":"sup","control+shift+?":"abbr","control+enter":"p","shift+enter":function(A,e){return g=v(e.$().before),e.tidy("\n","").insert(g+P[0]+H.br+U+"\n",0),!1},enter:function(A,e){var S,l,F,E=e.$(),O=E.value,t=e.get(),R=H.p,I=H.li,L=$(R),N=$(I),r=(v(E.before),Y[""]),T=C.tools;if(!O||O===r){if(S=E.after.match(a("^\\s*"+W[0]+W[2]+"("+i(L)+"|"+i(N)+")"+W[1])))l=S[1],(T[l===N?b:l]||T.ul).click(A,e);else{if(!(f&&R&&o(t)&&E.end===t.length&&a("^\\s*[^"+W[0]+"\\n]*?[^"+W[1]+"]\\s*$").test(t)))return;t=P[0]+R+P[1]+t+P[0]+P[2]+L+P[1]+"\n"+P[0]+R+P[1],F=r+P[0]+P[2]+L+P[1],e.set(t+F).select(t.length,(t+r).length)}return!1}},tab:function(A,e){var E=e.$(),O=H.li,t=$(O),R=v(E.before);return a(W[0]+W[2]+i(t)+W[1]).test(E.after)?(e[0]().wrap("\n"+R+B+P[0]+(H[b]||b)+P[1]+"\n"+R+B+B+P[0]+O+P[1],P[0]+P[2]+t+P[1]+"\n"+R+B+P[0]+P[2]+b+P[1]+"\n"+R).insert(Y[""])[1](),!1):C.tools.indent.click(A,e)},backspace:function(A,e){var t,E=e.$(),O=E.value,R=E.before,I=E.after,L=W[0]+"[^"+W[0]+W[1]+"]+?"+W[1];return!O&&a(L+"$").test(R)?(t=R.split(P[0]).pop().match(a("^([^"+W[2]+"\\s]+).*?"+W[1]+"$")),t=t&&t[1]||0,t&&a("^\\s*"+W[0]+W[2]+i(t)+W[1]).test(I)?e.unwrap(a(W[0]+i(t)+h+W[1]),a("\\s*"+W[0]+W[2]+i(t)+W[1])):e.outdent(a(L)),!1):void 0},"control+h":"p,h1,h2,h3,h4,h5,h6","control+q":"blockquote,q","control+k":"pre,code","control+-":"ul","control++":"ol","control+=":"ol","control+shift++":"ol","control+t":"table","control+r":"hr"}),r.update({},0)};