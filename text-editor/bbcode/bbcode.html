<!DOCTYPE html>
<html dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>BBCode Text Editor</title>
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <style>
    body {
      background:#fff;
      font-family:Helmet,FreeSans,Sans-Serif;
      font-size:14px;
      color:#000;
      padding:5em;
    }
    pre {
      background:#eef;
      padding:.5em;
      overflow:auto;
    }
    mark {
      background:#ff0;
      color:#000;
    }
    .text-editor-content {height:300px}
    </style>
  </head>
  <body>
    <h1>BBCode Text Editor</h1>
    <form action="#">
      <p><textarea></textarea></p>
      <p>
        <strong>Theme:</strong>
        <select id="select-css">
          <option value="../../text-editor/ui/ui.min.css">Default</option>
          <option value="../../text-editor/ui/ui.1960.min.css">1960</option>
          <option value="../../text-editor/ui/ui.fam-fam-fam.min.css">Fam Fam Fam</option>
          <option value="../../text-editor/ui/ui.negate.min.css">Negate</option>
        </select>
      </p>
      <script>
      // dynamic stylesheet
      var css = document.querySelector('#select-css');
      function select_css() {
          var link = document.createElement('link'), o;
          link.id = 'the-css';
          link.rel = 'stylesheet';
          link.href = this.value || css.value;
          if (o = document.querySelector('#the-css')) {
              o.parentNode.removeChild(o);
          }
          document.querySelector('head').appendChild(link);
      }
      select_css();
      css.onchange = select_css;
      </script>
    </form>
    <div>
      <h2>Keyboard Shortcuts</h2>
      <ul>
        <li><kbd>&#8984;+b</kbd> &rarr; Bold</li>
        <li><kbd>&#8984;+g</kbd> &rarr; Image</li>
        <li><kbd>&#8984;+h</kbd> &rarr; Header</li>
        <li><kbd>&#8984;+i</kbd> &rarr; Italic</li>
        <li><kbd>&#8984;+k</kbd> &rarr; Code</li>
        <li><kbd>&#8984;+l</kbd> &rarr; Link</li>
        <li><kbd>&#8984;+q</kbd> &rarr; Quote</li>
        <li><kbd>&#8984;+r</kbd> &rarr; Horizontal Rule</li>
        <li><kbd>&#8984;+t</kbd> &rarr; Table</li>
        <li><kbd>&#8984;+u</kbd> &rarr; Underline</li>
        <li><kbd>&#8984;+y</kbd> &rarr; Redo</li>
        <li><kbd>&#8984;+z</kbd> &rarr; Undo</li>
        <li><kbd>&#8984;++</kbd> &rarr; List</li>
        <li><kbd>&#8984;+-</kbd> &rarr; Bullet</li>
        <li><kbd>&#8984;+&#10008;</kbd> &rarr; Strike</li>
        <li><kbd>&#8984;+&darr;</kbd> &rarr; Subscript</li>
        <li><kbd>&#8984;+&uarr;</kbd> &rarr; Superscript</li>
        <li><kbd>&#8984;+&#8629;</kbd> &rarr; Paragraph</li>
        <li><kbd>&#8679;+&#8629;</kbd> &rarr; Line Break</li>
        <li><kbd>F5</kbd> &rarr; Preview</li>
        <li><kbd>&#8677;</kbd> &rarr; Indent &amp; <em>Depends</em></li>
        <li><kbd>&#8679;+&#8677;</kbd> &rarr; Outdent</li>
        <li><kbd>&#8629;</kbd> &rarr; <em>Depends</em></li>
        <li><kbd>&#9003;</kbd> &rarr; <em>Depends</em></li>
      </ul>
      <h3>Depends &rarr; Special Cases</h3>
      <p>Try pressing the <kbd>&#8629;</kbd> key in these position, where <code><mark>|</mark></code> represent the text editor caret.</p>
      <pre><code>[list]
  [*]<mark>|</mark>[/*]
[/list]</code></pre>
      <pre><code>[list]
  [*]foo<mark>|</mark>[/*]
[/list]</code></pre>
      <pre><code>    <mark>|</mark></code></pre>
      <pre><code>"<mark>|</mark>"</code></pre>
      <pre><code>'<mark>|</mark>'</code></pre>
      <pre><code>(<mark>|</mark>)</code></pre>
      <pre><code>{<mark>|</mark>}</code></pre>
      <pre><code>[<mark>|</mark>]</code></pre>
      <pre><code>&lt;<mark>|</mark>&gt;</code></pre>
      <p>Try pressing the <kbd>&#8677;</kbd> key in these position, where <code><mark>|</mark></code> represent the text editor caret.</p>
      <pre><code>[*]abc<mark>|</mark>[/*]</code></pre>
      <p>Try pressing the <kbd>&#9003;</kbd> key in these position, where <code><mark>|</mark></code> represent the text editor caret.</p>
      <pre><code>[b][/b]<mark>|</mark></code></pre>
      <pre><code>[b]<mark>|</mark>[/b]</code></pre>
      <pre><code>    <mark>|</mark></code></pre>
    </div>
    <script src="../../text-editor.min.js"></script>
    <script src="../../text-editor/ui/ui.min.js"></script>
    <script src="../../text-editor/html/html.min.js"></script>
    <script src="../../text-editor/bbcode/bbcode.min.js"></script>
    <script>

    var editor = new TE.BBCode(document.querySelector('textarea'));

    </script>
    <script src="https://cdn.rawgit.com/patorjk/Extendible-BBCode-Parser/master/xbbcode.js"></script>
    <script>

    // Using <https://github.com/patorjk/Extendible-BBCode-Parser> library to create proper HTML preview.
    editor.config.css += '.xbbcode-b{font-weight:700}.xbbcode-center{margin-left:auto;margin-right:auto;display:block;text-align:center}.xbbcode-code{white-space:pre-wrap;font-family:monospace}.xbbcode-i{font-style:italic}.xbbcode-justify{display:block;text-align:justify}.xbbcode-left{display:block;text-align:left}.xbbcode-right{display:block;text-align:right}.xbbcode-s{text-decoration:line-through}.xbbcode-size-4{font-size:4px}.xbbcode-size-5{font-size:5px}.xbbcode-size-6{font-size:6px}.xbbcode-size-7{font-size:7px}.xbbcode-size-8{font-size:8px}.xbbcode-size-9{font-size:9px}.xbbcode-size-10{font-size:10px}.xbbcode-size-11{font-size:11px}.xbbcode-size-12{font-size:12px}.xbbcode-size-13{font-size:13px}.xbbcode-size-14{font-size:14px}.xbbcode-size-15{font-size:15px}.xbbcode-size-16{font-size:16px}.xbbcode-size-17{font-size:17px}.xbbcode-size-18{font-size:18px}.xbbcode-size-19{font-size:19px}.xbbcode-size-20{font-size:20px}.xbbcode-size-21{font-size:21px}.xbbcode-size-22{font-size:22px}.xbbcode-size-23{font-size:23px}.xbbcode-size-24{font-size:24px}.xbbcode-size-25{font-size:25px}.xbbcode-size-26{font-size:26px}.xbbcode-size-27{font-size:27px}.xbbcode-size-28{font-size:28px}.xbbcode-size-29{font-size:29px}.xbbcode-size-30{font-size:30px}.xbbcode-size-31{font-size:31px}.xbbcode-size-32{font-size:32px}.xbbcode-size-33{font-size:33px}.xbbcode-size-34{font-size:34px}.xbbcode-size-35{font-size:35px}.xbbcode-size-36{font-size:36px}.xbbcode-size-37{font-size:37px}.xbbcode-size-38{font-size:38px}.xbbcode-size-39{font-size:39px}.xbbcode-size-40{font-size:40px}.xbbcode-u{text-decoration:underline}.xbbcode-table{border-collapse:collapse}.xbbcode-table,.xbbcode-td,.xbbcode-th{border:1px solid #666}';
    editor._.hook.set('enter.overlay.preview', function(e, $, value, container) {
        var html = value[1].replace(/<body(|\s[^<>]*?)>([\s\S]*?)<\/body>/, function(a, b, c) {
            return '<body' + b + '>' + XBBCODE.process({text: c}).html + '</body>';
        });
        container.firstChild.src = 'data:text/html,' + encodeURIComponent(html);
    });

    </script>
  </body>
</html>