/*!
 * ==========================================================
 *  BBCODE TEXT EDITOR PLUGIN 1.0.6
 * ==========================================================
 * Author: Taufik Nurrohman <https://github.com/tovic>
 * License: MIT
 * ----------------------------------------------------------
 */
TE.BBCode=function(e,t){function h(e){return e.split(c("("+b[3]+")+"))[0]}function m(e){return l(e.replace(/\s+/g," "))}function k(e){return s(m(e),[/(<.*?>)|(\[.*?\])/g,/\s/g,'"',"(",")","[","]"],["","%20","%22","%28","%29","%5B","%5D"])}var d,n=new TE.HTML(e,{auto_p:0,advance_table:0,tools:"clear | b i u s | sub sup | a img | p,h1,h2,h3,h4,h5,h6 | blockquote,q pre,code | ul ol | indent outdent | table | hr | undo redo",unit:[[["[","]"]],[["\\u005B","\\u005D"],["\\u003D","\\u0022","\\u0022","\\u0020|\\u003D"]]],formats:{b:"b",i:"i",u:"u",s:"s",a:"url",email:"email",p:"",blockquote:"quote",code:"code",table:"table=1",caption:""}}),i=n.ui,o=n._,r=o.x,a=o.extend,l=o.trim,s=o.replace,c=o.pattern,u=o.hook,f=o.event,p=n.config.unit[1][0],b=n.config.unit[1][1];n.update(t,0),n.type="BBCode";var _=n.config,y=(_.states,_.languages),E=_.formats,A=(_.tab,y.placeholders);return a(i.tools,{a:{click:function(e,t){var n=E.a,i=y.modals.a,o=t.$().value;return/^[a-z]+:\/\/\S+$/i.test(o)?(t.format(n),!1):/^[\w.-]+@[\w.-]+(?:\.[\w.-]+)?$/i.test(o)?(t.format(E.email),!1):(t.record().ui.prompt(["a[href]",i.title[0]],i.placeholder[0],1,function(e,t,i){t.format(n+"="+k(i))}),!1)}},img:{click:function(e,t){var n=E.img,i=y.modals.img;return t.$().length?(t.format(n),!1):(t.record().ui.prompt(["img[src]",i.title[0]],i.placeholder[0],1,function(e,t,i){t[0]().format(n).insert(k(i))[1]()}),!1)}},abbr:0,p:{click:function(e,t){return t.$().length?(t.tidy("\n\n").replace(/([\t ]*\n[\t ]*){2,}/g,"\n\n"),!1):(t.tidy("\n\n").insert(A[""]),!1)}},"blockquote,q":{click:function(e,t){return t.format(E.blockquote,0,"\n\n","\n"),!1}},"pre,code":{click:function(e,t){function a(e){return n?s(e,["&","<",">"],["&amp;","&lt;","&gt;"]):e}function l(e){return n?s(e,["&amp;","&lt;","&gt;"],["&","<",">"]):e}var n=_.auto_encode_html,i=E.code,o=h(i);return t[0]().format(i,0,"\n\n","\n").replace(/^[\s\S]*?$/,function(e){return c("^\\s*"+p[0]+p[2]+r(o)+p[1]).test(t.$().after)?a(e):l(e)})[1](),!1}}}),a(i.keys,{"control+shift+?":0}),u.set("enter.modal.prompt:table>caption",function(e){!E.caption&&(d=i.el.modal.querySelector("[name=y]"))&&f.fire("click",d)}),n.update({},0)};