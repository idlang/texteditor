/*!
 * ==========================================================
 *  USER INTERFACE MODULE FOR TEXT EDITOR PLUGIN 1.8.2
 * ==========================================================
 * Author: Taufik Nurrohman <https://github.com/tovic>
 * License: MIT
 * ----------------------------------------------------------
 */
TE.ui=function(n,e){function jn(n){return S(n)?g(n).split(/\s+/):n}function Nn(n){return C(n)?n.join(" "):n}function On(n,e){return-1!==n.indexOf(e)}function Bn(n){return Object.keys(n)}function Hn(n){return n.length}function kn(n){return Hn(Bn(n))}function Dn(n,e,t){return T(n)?T(e)?(T(x[n])||(x[n]={}),T(t)||(t=kn(x[n])),x[n][t]=e,s):x[n]:x}function In(n,e){return T(n)?T(e)&&T(x[n])?(delete x[n][e],s):(x[n]={},s):(x={},s)}function Rn(n,e,t){if(!T(x[n]))return x[n]={},s;if(T(t))T(x[n][t])&&x[n][t].apply(s,e);else for(U in x[n])x[n][U].apply(s,e);return s}function _n(n,e,t){if(C(e))for(U in e)_n(n,U,e[U]);else n[(null===t?"remove":"set")+"Attribute"](e,t)}function zn(n,t,r){if(!t){for(e={},U=0,Z=n.attributes,V=Hn(Z);V>U;++U)Y=Z[U],e[Y.name]=Y.value;return kn(e)?e:T(r)?r:{}}if(S(t))return zn(n,[t],[T(r)?r:""])[0];e=[];for(U in t)U=t[U],(U=n.getAttribute(U))&&e.push(U);return Hn(e)?e:T(r)?r:[]}function qn(n,e){if(C(e))for(U in e)qn(n,e[U]);else if(T(e))n.removeAttribute(e);else for(qn(n,"class"),U=0,Z=n.attributes,V=Hn(Z);V>U;++U)Z[U]&&qn(n,Z[U].name)}function Pn(n,e,t){if(C(e))for(U in e)Pn(n,U,e[U]);else _n(n,"data-"+e,t)}function Un(n,t,r){if(!t){for(e={},U=0,Z=n.attributes,V=Hn(Z);V>U;++U)Y=Z[U],"data-"===Y.name.slice(0,5)&&(e[Y.name]=Y.value);return kn(e)?e:T(r)?r:{}}if(S(t))return Un(n,[t],[T(r)?r:""])[0];e=[];for(U in t)U=t[U],(U=zn(n,"data-"+U))&&e.push(U);return Hn(e)?e:T(r)?r:[]}function Zn(n,e){if(C(e))for(U in e)qn(n,"data-"+e[U]);else if(T(e))qn(n,"data-"+e);else for(U=0,Z=n.attributes,V=Hn(Z);V>U;++U)Z[U]&&"data-"===Z[U].name.slice(0,5)&&qn(n,Z[U].name)}function Vn(n){return n&&n.preventDefault(),!1}function Yn(n,e,t){if(e){for(n=jn(n),U=0,Z=Hn(n);Z>U;++U)e.addEventListener(n[U],t,!1),Dn("on:"+n[U],t,ce(e));return s}}function Wn(n,e,t){if(e){for(n=jn(n),U=0,Z=Hn(n);Z>U;++U)e.removeEventListener(n[U],t,!1),In("on:"+n[U],ce(e));return F(e)&&e.id.split(":")[0]===Oe+"-dom"&&qn(e,"id"),s}}function Xn(n,e,t){n=jn(n);var i,r="createEvent"in c;for(U=0,Z=Hn(n);Z>U;++U)r?(i=c.createEvent("HTMLEvents"),i.data=t,i.initEvent(n[U],!0,!1),e.dispatchEvent(i)):Rn("on:"+n[U],t,ce(e));return s}function Kn(n,e,t){for(U=0,Z=Hn(e),V;Z>U;++U)V=e[U],n=n.replace(M(V)?V:m(p(V),"g"),t&&t[U]||"");return n}function Gn(n,e){return n.replace(/%(\d+)/g,function(n,t){return--t,T(e[t])?e[t]:n})}function Jn(n){return g(Kn(n.toLowerCase(),[/[^ \/a-z\d-]/g,/([ -])+/g,/^-|-$/g],["-","$1",""]))}function Qn(n,e){var t=e.touches?e.touches[0].pageX:e.pageX,r=e.touches?e.touches[0].pageY:e.pageY,i=ne(n);return{x:t-i.l,y:r-i.t}}function ne(n){for(Y=n.offsetLeft,nn=n.offsetTop;n=n.offsetParent;)Y+=n.offsetLeft,nn+=n.offsetTop;return{l:Y,t:nn}}function ee(n){return n===o?{w:n.innerWidth,h:n.innerHeight}:{w:n.offsetWidth,h:n.offsetHeight}}function te(n,e){for(;(n=de(n))&&n!==e;);return n}function re(n,e){e=jn(e);for(U in e)n.classList.add(e[U])}function ie(n,t,r){if(!t)return e=jn(n.className),Hn(e)?e:T(r)?r:[];if(S(t))return ie(n,[t],[T(r)?r:""])[0];e=[];for(U in t)U=t[U],n.classList.contains(U)&&e.push(U);return Hn(e)?e:T(r)?r:[]}function ue(n,e){if(T(e)){e=jn(e);for(U in e)n.classList.remove(e[U])}else qn(n,"class")}function fe(n,e){e=jn(e);for(U in e)n.classList.toggle(e[U])}function oe(n,e,t){if(n=n||"div",n=S(n)?c.createElement(n):n,C(t))for(U in t)if(tn=t[U],"classes"===U)re(n,tn);else if("data"===U)for(Z in tn)tn=tn[Z],null===tn?Zn(n,Z):Pn(n,Z,tn);else"css"===U?S(tn)?_n(n,"style",tn):null===tn?qn(n,"style"):a(n,tn):w(tn)?n[U]=tn:null===tn?qn(n,U):_n(n,U,L(tn)?tn.join(" "):""+tn);if(F(e))Ae(n,e);else if(C(e))for(U in e)tn=e[U],F(tn)?Ae(n,tn):tn!==!1&&se(n,tn);else T(e)&&e!==!1&&se(n,e);return n}function ce(n){var e=n.id;return e||(e=Oe+"-dom:"+Math.floor(Date.now()*Math.random()),n.id=e),e}function se(n,e){n.innerHTML=e}function le(n,e){return n.innerHTML||(T(e)?e:"")}function ae(n,e){if((!T(e)||e)&&(I=pe(n)))for(U=0,Z=Hn(I);Z>U;++U)ae(I[U]);se(n,"")}function de(n){return n&&n.parentNode}function pe(n){return n&&n.children||[]}function ve(n,e){return T(e)?S(e)?n.closest(e):te(n,e):de(n)}function me(n){return n&&n.nextSibling}function he(n){return n&&n.previousSibling}function be(n){for(U=0;n=he(n);)++U;return U}function ge(n,e){return n&&S(e)?n.nodeName.toLowerCase()===e.toLowerCase():n&&w(e)?n===e(n):n===e}function xe(n,t){if(!(t=T(t)?t:c))return[];if(e=[],S(n)){if(/^[#.]?(?:\\.|[\w-]|[^\x00-\xa0])+$/.test(n)){if("#"===n[0]&&(n=t.getElementById(n.slice(1))))return[n];if("."===n[0]&&(n=t.getElementsByClassName(n.slice(1)))||(n=t.getElementsByTagName(n))){for(U=0,Z=Hn(n);Z>U;++U)e.push(n[U]);return e}return[]}for(n=t.querySelectorAll(n),U=0,Z=Hn(n);Z>U;++U)e.push(n[U]);return e}return ye(n)?[n]:[]}function ye(n,e){var t=de(n);return 1===Hn(arguments)?t||!1:n&&t===n?t:!1}function Ee(n,e){K=de(n),K&&K.insertBefore(e,n)}function Fe(n,e){K=de(n),K&&K.insertBefore(e,me(n))}function Le(n,e){I=n.firstChild,I?Ee(I,e):Ae(n,e)}function we(n,e){Ae(n,e)}function Ae(n,e){n.appendChild(e)}function Ce(n,e){var t=de(n);if(t){if(!T(e)||e)for(I=n.firstChild;I;)Ce(I);t.removeChild(n)}}function Me(n,e){return n.cloneNode(T(e)?!!e:!0)}function Te(n,e){return de(n).replaceChild(e,n),e}function Se(n){ae(oe(n,!1,{style:""})),Ce(n)}function $e(n,e,t){return oe(e,t,{"class":n})}function it(n){return!n||T(n.active)&&!n.active}function ut(n,e,t){return w(n)&&(n={click:n}),S(n.click)&&(n.click=(t[n.click]||{}).click),n.title=Be[e]||"",T(n.attributes)||(n.attributes={}),t[e]&&(t[e]=n),n}function ft(n){je.exit(0,0,0);var e=Un(this,"tool-id"),t=je.tools,r=t[e];return je.drop.target=n.currentTarget||n.target,!it(r)&&w(Z=r.click)&&(Z=Z(n,s,e),Rn("on:change",[n,s,e]),Z===!1)?Vn(n):(s.select(),Vn(n))}function ot(n){if(nn=this,(V=n.TE.key)(/^(escape|f10)$/))je.exit(1);else if(V("enter")||V("arrowdown")&&Un(nn,"ui-drop"))je.drop.target=nn,Xn(sn,nn,[n]);else if(V("arrowright")&&(Y=me(nn))){for(;!ge(Y,"a")&&Y;)Y=me(Y);Y&&Y.focus()}else if(V("arrowleft")&&(Y=he(nn))){for(;!ge(Y,"a")&&Y;)Y=he(Y);Y&&Y.focus()}return Vn(n)}function st(){ae(Ue,0);var i,u,f,o,c,l,a,n=je.tools,e=jn(B.tools),t=Oe+"-button",r=Oe+"-separator";B.tools=e;for(l in e)a=e[l],u=n[a],(u||u==={})&&(u=ut(u,a,n),f=u.i||a,"|"===f||On(f,"<")||(f=Jn(f)),o="|"!==f,c=Jn(a).replace(/[\/\s]/g,"-"),tt=$e(o?t+" "+t+"-"+c:r+" "+r+"-"+l,o?"a":"span"),o?(tt=u.target||tt,i=t+":"+c,_n(tt,{href:Sn,id:i,tabindex:-1}),Pn(tt,"tool-id",a),f=On(f,"<")?f:je.i(c,f),it(u)?re(tt,"x"):ue(tt,"x"),u.on?re(tt,"on"):ue(tt,"on"),u.text&&(f=Gn('<span class="'+Oe+'-text">'+u.text+"</span>",[f]),re(tt,"text")),se(tt,f),oe(tt,!1,u.attributes),!u.attributes.title&&(Z=u.title)&&(tt.title=C(Z)?Z[0]+(Z[1]?" ("+Z[1]+")":""):Z),Yn(sn,tt,ft),Yn(vn,tt,ot)):tt.id=r+":"+l,u.target=tt,(c=Un(tt,ct))&&je.menu.set(a,c),Ae(Ue,tt));Rn("update.tools",[s])}function lt(){je.keys=function(){var t,n=Bn(je.keys).sort().reverse(),e={};for(U=0,Z=Hn(n);Z>U;++U)t=n[U],e[t]=je.keys[t];return e}(),dt(),Rn("update.keys",[s])}function at(n){function v(n){return n.replace(/\+/g,"\n").replace(/\n\n/g,"\n+").split("\n")}var t=s.$(),r=t.before,i=t.after,u=r.slice(-1),f=i[0],o=t.length,c=je.keys,l=TE.keys_alias,a={control:0,shift:0,option:"alt",meta:0},d=(r.match(/(?:^|\n)([\t ]*).*$/)||[""]).pop();for(U in a)n.TE[U]()&&(H[a[U]||U]=1);X=n.TE.key(),H[X]=1,e=kn(H),b(function(){s.record()});for(U in c){V=v(U),I=0;for(Z in V)Z=V[Z],H[l[Z]||Z]&&++I;if(V=Hn(V),I===V&&e===V&&(S(c[U])&&(c[U]=je.tools[c[U]].click),Y=w(c[U])&&c[U](n,s),Y===!1))return Vn(n)}if(En)for(U in En)if(W=En[U],W!==!1){if(X===W&&f===W)return"\\"===u?(s.insert(X,0),Vn(n)):(s.select(t.end+1),Vn(n));if(U===X)return s.wrap(U,W),Vn(n);if(u===U&&f===W){if("backspace"===X&&r.slice(-2)!=="\\"+U)return s.unwrap(U,W),Vn(n);if(Fn&&"enter"===X&&U!==W&&!o)return s.tidy("\n"+d+wn,"\n"+d).scroll(1),Vn(n)}}if(Fn&&!o){if("backspace"===X&&m(p(wn)+"$").test(r))return s.outdent(wn),Vn(n);if("enter"===X&&m("(^|\\n)("+p(wn)+")+.*$").test(r))return s.insert("\n"+d,0,1).scroll(1),Vn(n)}}function dt(n){n&&n.TE&&n.TE.key?delete H[n.TE.key()]:H={}}function bt(n){return pt=Ie,Q=ee(Pe),Vn(n)}function gt(n){pt===Ie&&a(Ze,{height:Qn(qe,n).y-Q.h+$n})}function xt(){pt=0}function yt(){je.exit(1)}function Et(){e=ee(Xe),rn=e.w,P=e.h,e=ee(We),vt=e.w,mt=e.h}function Ft(n,e){return e&&Rn("exit.modal."+e,[s]),Xn(sn,We,[n]),Vn(n)}function Lt(n){pt=n.target,e=Qn(Xe,n),un=e.x,fn=e.y,Et()}function wt(n){var t=ht.header,r=ht.sizer;pt===t||te(pt,t)===t?(e=Qn(qe,n),Y=e.x-un,nn=e.y-fn,a(Xe,{left:(rn>vt?Y:d(Y,0,vt-rn))+$n,top:(P>mt?nn:d(nn,0,mt-P))+$n})):pt===r&&(e=Qn(Xe,n),Q=ee(r),a(Xe,{width:e.x+Q.w/4+$n,height:e.y+Q.h/4+$n}))}function At(){pt=0}function Ct(n,e,t){return{header:n,body:e,footer:t}}function Mt(n){k=je.drop.target,D=Ke,I=n&&n.target||0,(!I||I!==k&&te(I,k)!==k)&&(je.drop.target=0,je.exit(I===Ze))}var k,D,I,z,P,U,Z,V,Y,W,X,e,K,J,Q,nn,en,tn,rn,un,fn,t="⌘",r="…",u="⇥",f="⇧",o=window,c=document,s=new TE(n),l=s._,a=l.css,d=l.edge,p=l.x,v=l.extend,m=l.pattern,h=l.timer.reset,b=l.timer.set,g=l.trim,x={},y=function(){},E=TE.is,F=E.e,L=E.a,w=E.f,A=E.i,C=E.o,M=E.r,T=function(n){return!E.x(n)},S=E.s,$=c.documentElement,N=(c.head,c.body),B=(c.currentScript,v({tab:"  ",direction:"ltr",path:TE.path,resize:1,keys:1,tools:"indent outdent | undo redo",attributes:{spellcheck:"false"},union:[[["\\u003C","\\u003E","\\u002F"],["\\u003D","\\u0022","\\u0022","\\u0020"]],[["<",">","/"],["=",'"','"'," "]]],auto_tab:1,auto_close:{'"':'"',"'":"'","(":")","{":"}","[":"]","<":">"},languages:{tools:{tools:["Focus Tools","F10"],undo:["Undo",t+"+Z"],redo:["Redo",t+"+Y"],indent:["Indent",u],outdent:["Outdent",f+"+"+u]},buttons:{okay:"OK",cancel:"Cancel",yes:"Yes",no:"No",enter:"Enter",exit:"Exit",open:"Open",close:"Close",ignore:"Ignore"},placeholders:{"":"text here"+r},labels:{},others:{}},classes:{"":"text-editor",i:"text-editor-i text-editor-i-%1 text-editor-i-%1--%2 fa fa-%2"}},e)),H={},cn="blur",sn="click",vn="keydown",mn="keyup",hn="touchstart mousedown",bn="touchmove mousemove",gn="touchend mouseup",yn="orientationchange resize",En=B.auto_close,Fn=B.auto_tab,Ln=B.languages,wn=B.tab,Cn=(B.union[1][1],B.union[1][0]),Mn=B.union[0][1],Tn=B.union[0][0],Sn="javascript:;",$n="px",je=s.ui={};s.tidy=function(n,e){var t=s.$(),r=g(t.before)?n:"",i=g(t.after)?T(e)?e:n:"";return s.trim(r,i)},s.i=function(){return g(s.replace(/\s+/g," "))},s.format=function(n,e,t,r){C(n)||(n=[n]),T(t)||(t=" "),T(r)||(r="");var i=s.h,u=s[0]().$(),f=n[0].split(m("("+Mn[3]+")+"))[0],o=(n[0]?Cn[0]+n[0]+Cn[1]:"")+r,c=r+(n[0]?Cn[0]+Cn[2]+(n[1]||f)+Cn[1]:""),l=p(n[0]?Cn[0]+f+Cn[1]:""),a=p(c),d=m("^"+l+"([\\s\\S]*?)"+a+"$"),v=m(l+"$"),h=m("^"+a),b=u.before,g=u.after;return u.length?t=!1:s.insert(Ln.placeholders[""]),s.toggle(e?!d.test(u.value):!v.test(b)&&!h.test(g),[function(n){n.unwrap(o,c,1).tidy(m(Tn[0]+"[^"+Tn[0]+Tn[1]+Tn[2]+"]+?"+Tn[1]+"$").test(b)?"":t,m("^"+Tn[0]+Tn[2]+"[^"+Tn[0]+Tn[1]+"]+?"+Tn[1]).test(g)?"":t).wrap(o,c,e)},function(n){n.unwrap(o,c,e)}])[i]()};var tt,Ne=B.classes,Oe=Ne[""],Be=Ln.tools,He=Ln.buttons,ke=Ln.labels,De=Oe+"-textarea "+Oe+"-content block",Ie=$e(Oe+"-sizer s"),Re=$e(Oe+"-sizer se"),_e=$e(Oe),ze=$e(Oe+"-header"),qe=$e(Oe+"-body"),Pe=$e(Oe+"-footer"),Ue=$e(Oe+"-tool"),Ze=oe(n,!1,B.attributes),Ve=$e(Oe+"-description"),Ye=oe(),We=oe(),Xe=oe(),Ke=oe(),Ge=oe(),Je=oe(),Qe=$e("left","span"),nt=$e("right","span"),et=0;je.i=function(n,e,t){return n=Jn(n).replace(/[\/\s]/g,"-"),Q=Gn(Ne.i,[n,e||n]),t?(ue(t),re(t,Q),t):'<i class="'+Q+'"></i>'},T(B.suffix)||(B.suffix=Cn[1]);var ct="ui-drop-data",pt=0,un=0,fn=0,rn=0,P=0,vt=0,mt=0,ht={};s.create=function(n,e){if(s.is.create)return s;s.is.create=!0,C(n)&&(B=v(B,n));var t=ye(Ze);return re(_e,Oe+"-is-can-update"),re(_e,Oe+"-is-can-copy"),re(Ze,De),t&&ge(t,"p")?(Ee(t,_e),et=t,Ce(t,!1)):Ee(Ze,_e),_e.dir=B.direction,Ae(_e,ze),Ae(_e,qe),Ae(_e,Pe),Ae(qe,Ze),B.tools&&(Ae(ze,Ue),Ae(Pe,Ve),Ae(Ve,Qe),Ae(Ve,nt)),Yn(vn,Ze,at),Yn(mn+" "+cn,Ze,dt),B.resize&&(Ae(_e,Ie),re(_e,Oe+"-is-can-resize"),Yn(hn,Ie,bt),Yn(bn,c,gt),Yn(gn,N,xt)),st(),lt(),0!==e?Rn("create",[s]):s},s.update=function(n,e){return s.is.create&&s.destroy(0),(0!==e?Rn("update",[s]):s).create(n,0)},s.destroy=function(n){return s.is.create?(s.is.create=!1,je.exit(0,0,0),ue(Ze,De),B.tools=Nn(B.tools),B.keys&&(Wn(vn,Ze,at),Wn(mn,Ze,dt)),B.resize&&(Wn(hn,Ie,bt),Wn(bn,c,gt),Wn(gn,c,xt)),et?(Ee(_e,et),Ae(et,Ze),et=0):Ee(_e,Ze),Se(_e),0!==n?Rn("destroy",[s]):s):s},s.enable=function(n){return Ze.disabled=Ze.readOnly=!1,re(_e,Oe+"-is-can-update"),re(_e,Oe+"-is-can-copy"),0!==n?Rn("enable",[s]):s},s.disable=function(n){return Ze.disabled=!0,ue(_e,Oe+"-is-can-update"),ue(_e,Oe+"-is-can-copy"),0!==n?Rn("disable",[s]):s},s.freeze=function(n){return Ze.disabled=!1,Ze.readOnly=!0,ue(_e,Oe+"-is-can-update"),re(_e,Oe+"-is-can-copy"),0!==n?Rn("freeze",[s]):s},je.exit=function(n,e,t){if(z={panel:function(){Se(Ye)},overlay:function(){Wn(sn,We,yt),Se(We)},modal:function(){Wn(sn+" "+vn,ht.x,Ft),Wn(hn,qe,Lt),Wn(bn,qe,wt),Wn(gn,c,At),Se(Xe)},drop:function(){Wn(sn,c,Mt),Wn(yn,o,Mt),Se(Ke)},bubble:function(){Se(Ge)}},dt(),e)if(C(e))for(U in e)U=e[U],z[U]&&z[U](),0!==t&&Rn("exit."+U,[s]);else z[e]&&z[e](),0!==t&&Rn("exit."+U,[s]);else for(U in z)z[U]();return n&&s.select(),0!==t&&Rn("exit",[s]),s},je.panel=function(n,e,t,r){function i(n){return Wn(sn+" "+vn,un,i),je.panel.exit(1),Vn(n)}return je.exit(0,0,0),Y=Jn(n),nn=0,r&&(Y+=" "+Y+"--"+Jn(r)),C(e)&&!F(e)&&(nn=$e(Oe+"-panel-header "+Y,0,e.header),e=e.body),en=$e(Oe+"-panel-body "+Y,0,$e(Oe+"-panel-content "+Y,0,w(e)?"":e)),w(e)&&e(en),un=oe("a",!1,{href:Sn,"class":Oe+"-a "+Oe+"-x "+Y}),un.title=He.close,oe(Ye,!1,{"class":Oe+"-panel "+Y}),Yn(sn+" "+vn,un,i),ae(Ye,0),nn&&Ae(Ye,nn),Ae(qe,oe(Ye,[en,un])),w(t)?t(Ye):S(t)&&oe(Ye,t),k=[s,Ye],r&&Rn("enter.panel."+n+":"+r,k),Rn("enter.panel."+n,k),Rn("enter.panel",k),Rn("enter",k),un.focus(),s},je.panel.fit=function(){},je.overlay=function(n,e,t,r){return je.exit(0,0,0),Y=Jn(n),r&&(Y+=" "+Y+"--"+Jn(r)),Ae(qe,oe(We,!1,{"class":Oe+"-overlay "+Y})),e&&Yn(sn,We,yt),w(t)?t(We):S(t)&&oe(We,t),k=[s,We],r&&Rn("enter.overlay."+n+":"+r,k),Rn("enter.overlay."+n,k),Rn("enter.overlay",k),Rn("enter",k),s},je.overlay.fit=function(){},je.message=function(n,e,t,r,i){function f(n){return Wn(sn+" "+vn,un,f),h(u),je.overlay.exit(1),Vn(n)}var u;return Y=Jn(n),i&&(Y+=" "+Y+"--"+Jn(i)),un=oe("a",!1,{href:Sn,"class":Oe+"-a "+Oe+"-x "+Y}),un.title=He.close,oe(Je,w(e)?e(Je):e,{"class":Oe+"-message "+Y}),Yn(sn+" "+vn,un,f),je.overlay("message message-"+Y,0,function(n){Ae(Je,un),t&&(u=b(function(){f()},t)),Ae(n,Je)},i),w(r)?r(Je):S(r)&&oe(Je,r),s},je.modal=function(){var o,l,n=arguments,e=n[0],t=n[1],r=n[2],i=n[3],u=Oe+"-modal",f=t.footer;if(C(e)&&(e="default",t=n[0],r=n[1],i=n[2]),je.overlay(e,1,0,i).blur(),Y=Jn(e),i&&(Y+=" "+Y+"--"+Jn(i)),oe(Xe,!1,{"class":u+" "+Y}),T(t.body)&&(t.body=oe("div",t.body,{"class":u+"-content "+Y})),T(f)&&C(f)&&!F(f)){l=[];for(U in f)Z=f[U],F(Z)?l.push(Z):(Z=ut(Z,U,f),V=U.text||He[U]||U,o=oe("button",V,v({name:"y["+U+"]",type:"button","class":Oe+"-button",data:{"button-id":U}},Z.attributes)),Yn(sn,o,function(n){return V=f[Un(this,"button-id")].click(n,s),V===!1?Vn(n):void 0}),l.push(o));t.footer=l}for(U in t)u[1]=U,ht[U]=$e(u+"-"+Gn(U,u)+" "+Y,0,t[U]);return ht.x=oe("a",!1,{href:Sn,"class":Oe+"-a "+Oe+"-x "+Y}),ht.sizer=Re,ae(Xe,0),ht.x.title=He.close,Ae(qe,oe(Xe,ht,{style:""})),je.modal.fit(),Fe(Xe,We),Yn(sn+" "+vn,ht.x,Ft),Yn(hn,ht.header,Vn),Yn(hn,ht.sizer,Vn),Yn(hn,qe,Lt),Yn(bn,qe,wt),Yn(gn,c,At),w(r)&&r(ht),k=[s,Xe,ht],i&&Rn("enter.modal."+e+":"+i,k),Rn("enter.modal."+e,k),Rn("enter.modal",k),Rn("enter",k),ht.x.focus(),s},je.modal.fit=function(n){return Et(),Y=vt/2-rn/2,nn=mt/2-P/2,C(n)?(T(n[0])&&(Y=n[0]),T(n[1])&&(nn=n[1])):(Y=d(Y,0),nn=d(nn,0)),a(Xe,{left:Y+$n,top:nn+$n,"min-width":rn+$n,"min-height":P+$n,visibility:"visible"}),k=[s,Xe,ht],Rn("fit.modal",k),Rn("fit",k),s};var Tt={"class":Oe+"-button",name:"y"};return je.alert=function(n,e,t,r,i){var u=oe("button",He.okay,Tt),f="alert";return t=t||y,C(n)&&(f+=":"+n[0],n=n[1]||n[0]),Yn(sn,u,function(n){return t(n,s),Ft(n,f+".y")}),Yn(vn,u,function(n){var e=n.TE.key;return e(/^(escape|enter)$/)&&Xn(sn,u,[n]),Vn(n)}),je.modal(f,Ct(n,e,u),r,i),u.focus(),s},je.confirm=function(n,e,t,r,i,u){function a(n){return w(t)&&t(n,s),Ft(n,c+".y")}function d(n){return w(r)&&r(n,s),Ft(n,c+".n")}var l,f=oe("button",He.okay,Tt),o=oe("button",He.cancel,Tt),c="confirm";return o.name="n",Yn(sn,f,a),Yn(sn,o,d),Yn(vn,f,function(n){return l=n.TE.key,l("arrowright")?o.focus():l("enter")?a(n):l("escape")&&Ft(n,c+".y"),Vn(n)}),Yn(vn,o,function(n){return l=n.TE.key,l("arrowleft")?f.focus():l("enter")?d(n):l("escape")&&Ft(n,c+".n"),Vn(n)}),je.modal(c,Ct(n,e,[f,o]),i,u),o.focus(),s},je.prompt=function(n,e,t,r,i,u,f){function h(){l.focus(),"placeholder"in l&&l.select()}function b(n){return p=l.value,w(t)&&!t(p)?h():!t||g(p)&&p!==e?(Ft(n,a+".y"),r(n,s,p!==e?p:"",e)):h(),Vn(n)}function x(n){return Ft(n,a+".n")}var p,v,m,o=oe("button",He.okay,Tt),c=oe("button",He.cancel,Tt),l=oe("input",!1,{type:"text",value:e,placeholder:e,spellcheck:"false","class":Oe+"-input block"}),a="prompt",d=[];if(i=i||0,1===i)l=oe("textarea",e,{placeholder:e.split("\n")[0],"class":Oe+"-textarea block",spellcheck:"false"});else if(2===i){for(U in e)d.push(oe("option",e[U],{value:U,selected:U===t||null}));l=oe("select",d,{"class":Oe+"-select block"})}return r=r||y,l.name="data",c.name="n",Yn(vn,l,function(n){return v=n.TE.key,m=n.TE.control,v("enter")&&0===i||m("enter")?b(n):v("escape")||v("backspace")&&!this.value?x(n):v("arrowdown")&&0===i||v("enter")&&2===i||m("arrowdown")?(o.focus(),Vn(n)):void 0}),Yn(vn,o,function(n){return v=n.TE.key,v("enter")?b(n):v("escape")?x(n):v("arrowup")?l.focus():v("arrowright")&&c.focus(),Vn(n)}),Yn(vn,c,function(n){return v=n.TE.key,v(/^(enter|escape)$/)?x(n):v("arrowup")?l.focus():v("arrowleft")&&o.focus(),Vn(n)}),Yn(sn,o,b),Yn(sn,c,x),je.modal(a,Ct(n,l,[o,c]),u,f),h(),s},je.drop=function(){je.exit(0,0,0);var n=arguments,e=n[0],t=n[1],r=n[2];return 1===Hn(n)&&(e="default",t=n[0],r=n[1]),Y=Jn(e),ae(Ke,0),Ae(N,oe(Ke,!1,{"class":Oe+"-drop "+Y})),w(t)?t(Ke):oe(Ke,t),je.drop.fit(),r===!1||(Yn(sn,c,Mt),Yn(yn,o,Mt)),k=[s,Ke],Rn("enter.drop."+e,k),Rn("enter.drop",k),s},je.drop.fit=function(n){return k=ee($),D=ee(Ke),I=je.drop.target,Y=k.w/2-D.w/2,nn=k.h/2-D.h/2,!T(n)&&I&&(e=ne(I),Y=e.l,nn=e.t+ee(I).h),C(n)?(T(n[0])&&(Y=n[0]),T(n[1])&&(nn=n[1])):(Y=d(Y,0,k.w-D.w),nn=d(nn,0,Math.max(k.h,ee(o).h)-D.h)),a(Ke,{left:Y+$n,top:nn+$n,visibility:"visible"}),k=[s,Ke],Rn("fit.drop",k),Rn("fit",k),s},je.menu=function(n,t,r,i){var o,u=je.tools,f=0;if(t===!1)return je.tool(n,t);for(i in r)rn="%"===i[0],o=r[i],o=S(o)&&!rn?u[o]:o,o&&(o=ut(o,i,u),r[i]=o);return je.tool(n,{i:C(t)?t[0]:0,text:C(t)?t[1]||0:t&&r[t]&&r[t].text||t,click:function(c){var l=je.drop.target=u[n].target;return je.drop("menu menu-"+Jn(n),function(c){function a(f){return nn=this,e=Un(nn,"tool-id"),W=r[e],W=S(W)?u[W]:W||{},X=le(nn),!it(W)&&w(i=W.click)&&(i=i(f,s),W.i&&(u[n].i=W.i),je.menu.set(n,C(W.text)?[W.text[0],e]:C(t)?[t[0],e]:e),i===!1)?(s.select(),Vn(f)):(s.select(),Vn(f))}function d(n){if(nn=this,(V=n.TE.key)("escape"))je.exit(1);else if(V("enter"))Xn(sn,nn,[n]);else if(V("f10")&&l)l.focus();else if(V("arrowdown")&&(Y=me(nn))){for(;!ge(Y,"a")&&Y;)Y=me(Y);Y&&Y.focus()}else if(V("arrowup")&&(Y=he(nn))){for(;!ge(Y,"a")&&Y;)Y=he(Y);!Y&&l?(je.exit(),l.focus()):Y&&Y.focus()}else V("arrowup")&&l&&(je.exit(),l.focus());return Vn(n)}for(i in r)if(o=r[i],rn="%"===i[0],o){var p={href:rn?null:Sn,"class":Oe+"-"+(rn?"label":"button")};rn?Z=ke[n]&&ke[n][+i.slice(1)-1]||i:(p.data={},p.data["tool-id"]=i,Z=Be[i]||i),J=o.text,J=C(J)?J[1]||"":J,Z=C(Z)?Z[0]:Z,Q=oe(rn?"span":"a","<span>"+(rn?Z||"%"+f:J||Z)+"</span>",v(p,o.attributes||{})),re(Q,"menu-"+Jn(i).replace(/[\/\s]/g,"-")),!p.title&&(nn=o.title)&&(Q.title=C(nn)?nn[0]+(nn[1]?" ("+nn[1]+")":""):nn),rn?_n(Q,{id:Oe+"-label:"+f}):(it(o)?re(Q,"x"):ue(Q,"x"),o.on?re(Q,"on"):ue(Q,"on"),Yn(sn,Q,a),Yn(vn,Q,d)),Ae(c,Q),++f}b(function(){(xe('[data-tool-id="'+Un(l,ct)+'"]',c)[0]||xe("a",c)[0]).focus()},1)}),!1}},i),Pn(u[n].target,{"ui-drop":n}),u[n].data=r,je.menu.set(n,t)},je.menu.set=function(n,e){var u,f,t=je.tools[n]||{},r=t.target,i=t.data;return r?(C(e)?Pn(r,ct,e[1]||""):(Pn(r,ct,e),e=i[e]&&i[e].text||e),C(e)?(f=e[0],f=On(f,"<")?f:je.i(f,t.i),e=T(e[1])?e[1]:0,e=e&&i[e]&&i[e].text||e,e=f+(0!==e?"<span>"+(C(e)?e[1]||e:e)+"</span>":"")):f=je.i(n,t.i),(u=xe("."+Oe+"-text",r)[0])?(re(r,"text"),se(u,e)):(ue(r,"text"),se(r,f)),s):s},je.bubble=function(){je.exit(0,0,0);var n=arguments,e=n[0],t=n[1];return 1===Hn(n)&&(e="default",t=n[0]),Y=Jn(e),ae(Ge,0),Ae(N,oe(Ge,!1,{"class":Oe+"-bubble "+Y})),w(t)?t(Ge):oe(Ge,t),je.bubble.fit(),k=[s,Ge],Rn("enter.bubble."+e,k),Rn("enter.bubble",k),s},je.bubble.fit=function(n){Q=s.$(1),e=ne(Ze),P=a(Ze,"line-height");var t="border-",r="-width";Y=Q.caret[0].x+e.l-Ze.scrollLeft,nn=Q.caret[1].y+e.t+P-Ze.scrollTop,D=a(qe,[t+"top"+r,t+"bottom"+r,t+"left"+r,t+"right"+r]);var i=ee(qe),u=ee(Ge),f=D[0]+D[1],o=D[2]+D[3];return C(n)?(T(n[0])&&(Y=n[0]),T(n[1])&&(nn=n[1])):(Y=d(Y,e.l,e.l+i.w-u.w-o),nn=d(nn,e.t,e.t+i.h-u.h-f)),a(Ge,{left:Y+$n,top:nn+$n,visibility:"visible"}),k=[s,Ge],Rn("fit.bubble",k),Rn("fit",k),s},je.panel.exit=function(n){return je.exit(n,"panel")},je.overlay.exit=function(n){return je.exit(n,"overlay")},je.modal.exit=function(n){return je.exit(n,"modal")},je.drop.exit=function(n){return je.exit(n,"drop")},je.bubble.exit=function(n){return je.exit(n,"bubble")},je.tool=function(n,e,t){var r=je.tools;return Z="",V=T(r[n])?"update":"create","|"!==n&&(B.tools=jn(B.tools).filter(function(e,t){return e===n?(Z=t,!1):!0})),e===!1?(delete r[n],V="destroy"):("|"===n?(t=e,e={}):(w(e)&&(e={click:e}),r[n]=v(r[n]||{},e),T(t)||""===Z||(t=Z)),A(t)?B.tools.splice(t,0,n):B.tools.push(n)),Rn(V+".tool."+n,[s,r[n]]),st(),s},je.separator=function(n,e){return je.tool("|",n!==!1?{attributes:n||{}}:!1,e)},je.key=function(n,e){var t=je.keys;return V=T(t[n])?"update":"create",e===!1?(delete t[n],V="destroy"):t[n]=e,Rn(V+".key."+n,[s,t[n]]),lt(),s},je.key.set=function(n){H[n]=1},je.key.reset=function(n){n?delete H[n]:H={}},je.tools={"|":{},undo:{i:"undo",click:function(n,e){return e.undo(),!1}},redo:{i:"repeat",click:function(n,e){return e.redo(),!1}},indent:function(n,e){return e.indent(wn),!1},outdent:function(n,e){return e.outdent(wn),!1}},je.keys={"control+y":"redo","control+z":"undo",escape:function(n,e){return J=":not([tabindex]):not([disabled])",(Q=xe("input"+J+",button"+J+",select"+J+",textarea"+J+",a[href]"+J+",[contenteditable]"+J+',[tabindex]:not([tabindex="-1"])',c,0))&&-1!==(nn=Q.indexOf(Ze))?((Q[nn+1]||c).focus(),!1):void 0},f10:function(n,e){return xe("a",Ue)[0].focus(),!1},tab:Fn?"indent":0,"shift+tab":Fn?"outdent":0},je.el={container:_e,header:ze,body:qe,footer:Pe,panel:Ye,overlay:We,modal:Xe,drop:Ke,bubble:Ge},s.config=B,v(TE._,{time:function(n){var e=new Date(T(n)?n:Date.now()),t=e.getFullYear(),r=e.getMonth()+1,i=e.getDate(),u=e.getHours(),f=e.getMinutes(),o=e.getSeconds(),c=e.getMilliseconds();return 10>r&&(r="0"+r),10>i&&(i="0"+i),10>u&&(u="0"+u),10>f&&(f="0"+f),10>o&&(o="0"+o),10>c&&(c="0"+c),[""+t,""+r,""+i,""+u,""+f,""+o,""+c]},replace:Kn,format:Gn,dom:{set:Ae,reset:Ce,get:xe,id:ce,copy:Me,replace:Te,classes:{set:re,reset:ue,toggle:fe,get:ie},attributes:{set:_n,reset:qn,get:zn},data:{set:Pn,reset:Zn,get:Un},is:ge,offset:ne,pointer:Qn,size:ee,content:{set:se,reset:ae,get:le},closest:te,parent:de,children:pe,closest:ve,next:me,previous:he,index:be,before:Ee,after:Fe,prepend:Le,append:we},el:oe,event:{set:Yn,reset:Wn,fire:Xn,x:Vn}}),v(s._,TE._),v(s._,{hooks:x,hook:{set:Dn,reset:In,fire:Rn}}),s.create()};