TE.ui=function(e,t){function Me(e){return _(e)?x(e).split(/\s+/):e}function Oe(e){return z(e)?e.join(" "):e}function De(e,t){return-1!==e.indexOf(t)}function Ne(e){return e.length}function Se(e){return Object.keys(e)}function He(e){return Ne(Se(e))}function Fe(e,t,n){return C(e)?C(t)?(C(v[e])||(v[e]={}),C(n)||(n=He(v[e])),v[e][n]=t,u):v[e]:v}function je(e,t){return C(e)?C(t)&&C(v[e])?(delete v[e][t],u):(v[e]={},u):(v={},u)}function Be(e,t,n){if(!C(v[e]))return v[e]={},u;if(C(n))C(v[e][n])&&v[e][n].apply(u,t);else for(P in v[e])v[e][P].apply(u,t);return u}function Ye(e,t,n){if(z(t))for(P in t)Ye(e,P,t[P]);else e[(null===n?"remove":"set")+"Attribute"](t,n)}function Ae(e,n,i){if(_(n))return Ae(e,[n],C(i)?i:"")[0];t=[];for(P in n)P=n[P],(P=e.getAttribute(P))&&t.push(P);return Ne(t)?t:C(i)?i:[]}function Ie(e,t){if(z(t))for(P in t)Ie(e,t[P]);else if(C(t))e.removeAttribute(t);else for(Ie(e,"class"),P=0,R=e.attributes,q=Ne(R);q>P;++P)R[P]&&Ie(e,R[P].name)}function We(e,t,n){if(z(t))for(P in t)We(e,P,t[P]);else Ye(e,"data-"+t,n)}function Xe(e,n,i){if(_(n))return Xe(e,[n],C(i)?i:"")[0];t=[];for(P in n)P=n[P],(P=Ae(e,"data-"+P))&&t.push(P);return Ne(t)?t:C(i)?i:[]}function Pe(e,t){if(z(t))for(P in t)Ie(e,"data-"+t[P]);else if(C(t))Ie(e,"data-"+t);else for(P=0,R=e.attributes,q=Ne(R);q>P;++P)R[P]&&"data-"===R[P].name.slice(0,5)&&Ie(e,R[P].name)}function Re(e){return e&&e.preventDefault(),!1}function qe(e,t,n){if(t){for(e=Me(e),P=0,R=Ne(e);R>P;++P)t.addEventListener(e[P],n,!1),Fe("on:"+e[P],n,st(t));return u}}function Ke(e,t,n){if(t){for(e=Me(e),P=0,R=Ne(e);R>P;++P)t.removeEventListener(e[P],n,!1),je("on:"+e[P],st(t));return w(t)&&t.id.split(":")[0]===_t+"-dom"&&Ie(t,"id"),u}}function Ue(e,t,n){e=Me(e);var r,i="createEvent"in a;for(P=0,R=Ne(e);R>P;++P)i?(r=a.createEvent("HTMLEvents"),r.data=n,r.initEvent(e[P],!0,!1),t.dispatchEvent(r)):Be("on:"+e[P],n,st(t));return u}function Ze(e,t,n){for(P=0,R=Ne(t),q;R>P;++P)q=t[P],e=e.replace(L(q)?q:h(p(q),"g"),n&&n[P]||"");return e}function Ge(e,t){return e.replace(/%(\d+)/g,function(e,n){return--n,C(t[n])?t[n]:e})}function Je(e){return x(Ze(e.toLowerCase(),[/[^ \/a-z\d-]/g,/([ -])+/g,/^-|-$/g],["-","$1",""]))}function Qe(e,t){var n=t.touches?t.touches[0].pageX:t.pageX,i=t.touches?t.touches[0].pageY:t.pageY,r=Ve(e);return{x:n-r.l,y:i-r.t}}function Ve(e){for(K=e.offsetLeft,ee=e.offsetTop;e=e.offsetParent;)K+=e.offsetLeft,ee+=e.offsetTop;return{l:K,t:ee}}function et(e){return e===s?{w:e.innerWidth,h:e.innerHeight}:{w:e.offsetWidth,h:e.offsetHeight}}function tt(e,t){for(;(e=ct(e))&&e!==t;);return e}function nt(e,t){t=Me(t);for(P in t)e.classList.add(t[P])}function it(e,n,i){if(_(n))return it(e,[n],C(i)?[i]:[""])[0];t=[];for(P in n)P=n[P],e.classList.contains(P)&&t.push(P);return Ne(t)?t:C(i)?i:!1}function rt(e,t){if(C(t)){t=Me(t);for(P in t)e.classList.remove(t[P])}else Ie(e,"class")}function ot(e,t){t=Me(t);for(P in t)e.classList.toggle(t[P])}function ft(e,t,n){if(e=e||"div",e=_(e)?a.createElement(e):e,z(n))for(P in n)if(ne=n[P],"classes"===P)nt(e,ne);else if("data"===P)for(R in ne)ne=ne[R],null===ne?Pe(e,R):We(e,R,ne);else"css"===P?_(ne)?Ye(e,"style",ne):null===ne?Ie(e,"style"):c(e,ne):T(ne)?e[P]=ne:null===ne?Ie(e,P):Ye(e,P,E(ne)?ne.join(" "):""+ne);if(w(t))Et(e,t);else if(z(t))for(P in t)ne=t[P],w(ne)?Et(e,ne):ne!==!1&&at(e,ne);else C(t)&&t!==!1&&at(e,t);return e}function st(e){var t=e.id;return t||(t=_t+"-dom:"+Math.floor(Date.now()*Math.random()),e.id=t),t}function at(e,t){e.innerHTML=t}function ut(e,t){return e.innerHTML||(C(t)?t:"")}function lt(e,t){if((!C(t)||t)&&(B=dt(e)))for(P=0,R=Ne(B);R>P;++P)lt(B[P]);at(e,"")}function ct(e){return e&&e.parentNode}function dt(e){return e&&e.children||[]}function pt(e){return e&&e.nextSibling}function bt(e){return e&&e.previousSibling}function ht(e){for(P=0;e=bt(e);)++P;return P}function yt(e,t){return e&&_(t)?e.nodeName.toLowerCase()===t.toLowerCase():e&&T(t)?e===t(e):e===t}function gt(e,n){if(!(n=C(n)?n:a))return[];if(t=[],_(e)){if(/^([#.]?[\w-]+|\*)$/.test(e)){if("#"===e[0]&&(e=n.getElementById(e.slice(1))))return[e];if("."===e[0]&&(e=n.getElementsByClassName(e.slice(1)))||(e=n.getElementsByTagName(e))){for(P=0,R=Ne(e);R>P;++P)t.push(e[P]);return t}return[]}for(e=n.querySelectorAll(e),P=0,R=Ne(e);R>P;++P)t.push(e[P]);return t}return xt(e)?[e]:[]}function xt(e,t){var n=ct(e);return 1===Ne(arguments)?n||!1:e&&n===e?n:!1}function vt(e,t){G=ct(e),G&&G.insertBefore(t,e)}function mt(e,t){G=ct(e),G&&G.insertBefore(t,pt(e))}function kt(e,t){B=dt(e)[0],B?vt(B,t):Et(e,t)}function wt(e,t){Et(e,t)}function Et(e,t){e.appendChild(t)}function Tt(e,t){var n=xt(e);if(n){if(!C(t)||t)for(B=dt(e)[0];B;)Tt(B);n.removeChild(e)}}function $t(e){lt(ft(e,!1,{style:""})),Tt(e)}function zt(e,t,n){return ft(t,n,{"class":e})}function en(e){return!e||C(e.active)&&!e.active}function tn(e,t,n){return T(e)&&(e={click:e}),_(e.click)&&(e.click=(n[e.click]||{}).click),e.title=Mt[t]||"",C(e.attributes)||(e.attributes={}),n[t]&&(n[t]=e),e}function nn(e){Lt.exit(0,0,0);var t=Xe(this,"tool-id"),n=Lt.tools,i=n[t];return Lt.drop.target=e.currentTarget||e.target,!en(i)&&T(R=i.click)&&(R=R(e,u,t),Be("on:change",[e,u,t]),R===!1)?Re(e):(u.select(),Re(e))}function rn(e){if(ee=this,(q=e.TE.key)(/^(escape|f10)$/))Lt.exit(1);else if(q("enter")||q("arrowdown")&&Xe(ee,"ui-drop"))Lt.drop.target=ee,Ue(ae,ee,[e]);else if(q("arrowright")&&(K=pt(ee))){for(;!yt(K,"a")&&K;)K=pt(K);K&&K.focus()}else if(q("arrowleft")&&(K=bt(ee))){for(;!yt(K,"a")&&K;)K=bt(K);K&&K.focus()}return Re(e)}function fn(){lt(At,0);var r,o,f,s,a,l,c,e=Lt.tools,t=Me(S.tools),n=_t+"-button",i=_t+"-separator";S.tools=t;for(l in t)c=t[l],o=e[c],(o||o==={})&&(o=tn(o,c,e),f=o.i||c,"|"===f||De(f,"<")||(f=Je(f)),s="|"!==f,a=Je(c).replace(/[\/\s]/g,"-"),Qt=zt(s?n+" "+n+"-"+a:i+" "+i+"-"+l,s?"a":"span"),s?(Qt=o.target||Qt,r=n+":"+a,Ye(Qt,{href:Ce,id:r,tabindex:-1}),We(Qt,"tool-id",c),f=De(f,"<")?f:Lt.i(a,f),en(o)?nt(Qt,"x"):rt(Qt,"x"),o.on?nt(Qt,"on"):rt(Qt,"on"),o.text&&(f=Ge('<span class="'+_t+'-text">'+o.text+"</span>",[f]),nt(Qt,"text")),at(Qt,f),ft(Qt,!1,o.attributes),!o.attributes.title&&(R=o.title)&&(Qt.title=z(R)?R[0]+(R[1]?" ("+R[1]+")":""):R),qe(ae,Qt,nn),qe(pe,Qt,rn)):Qt.id=i+":"+l,o.target=Qt,(a=Xe(Qt,on))&&Lt.menu.set(c,a),Et(At,Qt));Be("update.tools",[u])}function sn(){Lt.keys=function(){var n,e=Se(Lt.keys).sort().reverse(),t={};for(P=0,R=Ne(e);R>P;++P)n=e[P],t[n]=Lt.keys[n];return t}(),un(),Be("update.keys",[u])}function an(e){function b(e){return e.replace(/\+/g,"\n").replace(/\n\n/g,"\n+").split("\n")}var n=u.$(),i=n.before,r=n.after,o=i.slice(-1),f=r[0],s=n.length,a=Lt.keys,l=TE.keys_alias,c={control:0,shift:0,option:"alt",meta:0},d=(i.match(/(?:^|\n)([\t ]*).*$/)||[""]).pop();for(P in c)e.TE[P]()&&(H[c[P]||P]=1);Z=e.TE.key(),H[Z]=1,t=He(H),g(function(){u.record()});for(P in a){q=b(P),B=0;for(R in q)R=q[R],H[l[R]||R]&&++B;if(q=Ne(q),B===q&&t===q&&(_(a[P])&&(a[P]=Lt.tools[a[P]].click),K=T(a[P])&&a[P](e,u),K===!1))return Re(e)}if(me)for(P in me)if(U=me[P],U!==!1){if(Z===U&&f===U)return"\\"===o?(u.insert(Z,0),Re(e)):(u.select(n.end+1),Re(e));if(P===Z)return u.wrap(P,U),Re(e);if(o===P&&f===U){if("backspace"===Z&&i.slice(-2)!=="\\"+P)return u.unwrap(P,U),Re(e);if(ke&&"enter"===Z&&P!==U&&!s)return u.tidy("\n"+d+Ee,"\n"+d).scroll(1),Re(e)}}if(ke&&!s){if("backspace"===Z&&h(p(Ee)+"$").test(i))return u.outdent(Ee),Re(e);if("enter"===Z&&h("(^|\\n)("+p(Ee)+")+.*$").test(i))return u.insert("\n"+d,0,1).scroll(1),Re(e)}}function un(e){e&&e.TE&&e.TE.key?delete H[e.TE.key()]:H={}}function bn(e){return ln=St,V=et(Yt),Re(e)}function hn(e){ln===St&&c(It,{height:Qe(Bt,e).y-V.h+_e})}function yn(){ln=0}function gn(){Lt.exit(1)}function xn(){t=et(Rt),ie=t.w,X=t.h,t=et(Pt),cn=t.w,dn=t.h}function vn(e,t){return t&&Be("exit.modal."+t,[u]),Ue(ae,Pt,[e]),Re(e)}function mn(e){ln=e.target,t=Qe(Rt,e),re=t.x,oe=t.y,xn()}function kn(e){var n=pn.header,i=pn.sizer;ln===n||tt(ln,n)===n?(t=Qe(Bt,e),K=t.x-re,ee=t.y-oe,c(Rt,{left:(ie>cn?K:d(K,0,cn-ie))+_e,top:(X>dn?ee:d(ee,0,dn-X))+_e})):ln===i&&(t=Qe(Rt,e),V=et(i),c(Rt,{width:t.x+V.w/4+_e,height:t.y+V.h/4+_e}))}function wn(){ln=0}function En(e,t,n){return{header:e,body:t,footer:n}}function Tn(e){F=Lt.drop.target,j=qt,B=e&&e.target||0,(!B||B!==F&&tt(B,F)!==F)&&(Lt.drop.target=0,Ke(ae,a,Tn),Ke(ve,s,Tn),Lt.exit(e.target===It))}var F,j,B,I,X,P,R,q,K,U,Z,t,G,Q,V,ee,te,ne,ie,re,oe,n="⌘",i="…",o="⇥",f="⇧",s=window,a=document,u=new TE(e),l=u._,c=l.css,d=l.edge,p=l.x,b=l.extend,h=l.pattern,y=l.timer.reset,g=l.timer.set,x=l.trim,v={},m=function(){},k=TE.is,w=k.e,E=k.a,T=k.f,$=k.i,z=k.o,L=k.r,C=function(e){return!k.x(e)},_=k.s,M=a.documentElement,D=(a.head,a.body),N=a.currentScript,S=b({tab:"  ",direction:"ltr",path:(N&&N.src||s.location.href).split("/").slice(0,-1).join("/"),resize:1,keys:1,tools:"indent outdent | undo redo",attributes:{spellcheck:"false"},unit:[[["<",">","/"],["=",'"','"'," "]],[["\\u003C","\\u003E","\\u002F"],["\\u003D","\\u0022","\\u0022","\\u0020"]]],auto_tab:1,auto_close:{'"':'"',"'":"'","(":")","{":"}","[":"]","<":">"},languages:{tools:{tools:["Focus Tools","F10"],undo:["Undo",n+"+Z"],redo:["Redo",n+"+Y"],indent:["Indent",o],outdent:["Outdent",f+"+"+o]},buttons:{okay:"OK",cancel:"Cancel",yes:"Yes",no:"No",enter:"Enter",exit:"Exit",open:"Open",close:"Close",ignore:"Ignore"},placeholders:{"":"text here"+i},labels:{},others:{}},classes:{"":"text-editor",i:"text-editor-i text-editor-i-%1 text-editor-i-%1--%2 fa fa-%2"}},t),H={},se="blur",ae="click",pe="keydown",be="keyup",he="touchstart mousedown",ye="touchmove mousemove",ge="touchend mouseup",ve="orientationchange resize",me=S.auto_close,ke=S.auto_tab,we=S.languages,Ee=S.tab,$e=(S.unit[0][1],S.unit[0][0]),ze=S.unit[1][1],Le=S.unit[1][0],Ce="javascript:;",_e="px",Lt=u.ui={};u.tidy=function(e,t){var n=u.$(),i=x(n.before)?e:"",r=x(n.after)?C(t)?t:e:"";return u.trim(i,r)},u.i=function(){return x(u.replace(/\s+/g," "))},u.format=function(e,t,n,i){z(e)||(e=[e]),C(n)||(n=" "),C(i)||(i="");var r=u.h,o=u[0]().$(),f=e[0].split(h("("+ze[3]+")+"))[0],s=(e[0]?$e[0]+e[0]+$e[1]:"")+i,a=i+(e[0]?$e[0]+$e[2]+(e[1]||f)+$e[1]:""),l=p(e[0]?$e[0]+f+$e[1]:""),c=p(a),d=h("^"+l+"([\\s\\S]*?)"+c+"$"),b=h(l+"$"),y=h("^"+c),g=o.before,x=o.after;return o.length?n=!1:u.insert(we.placeholders[""]),u.toggle(t?!d.test(o.value):!b.test(g)&&!y.test(x),[function(e){e.unwrap(s,a,1).tidy(h(Le[0]+"[^"+Le[0]+Le[1]+Le[2]+"]+?"+Le[1]+"$").test(g)?"":n,h("^"+Le[0]+Le[2]+"[^"+Le[0]+Le[1]+"]+?"+Le[1]).test(x)?"":n).wrap(s,a,t)},function(e){e.unwrap(s,a,t)}])[r]()};var Qt,Ct=S.classes,_t=Ct[""],Mt=we.tools,Ot=we.buttons,Dt=we.labels,Nt=_t+"-textarea "+_t+"-content block",St=zt(_t+"-sizer s"),Ht=zt(_t+"-sizer se"),Ft=zt(_t),jt=zt(_t+"-header"),Bt=zt(_t+"-body"),Yt=zt(_t+"-footer"),At=zt(_t+"-tool"),It=ft(e,!1,S.attributes),Wt=zt(_t+"-description"),Xt=ft(),Pt=ft(),Rt=ft(),qt=ft(),Kt=ft(),Ut=ft(),Zt=zt("left","span"),Gt=zt("right","span"),Jt=0;Lt.i=function(e,t,n){return e=Je(e).replace(/[\/\s]/g,"-"),V=Ge(Ct.i,[e,t||e]),n?(rt(n),nt(n,V),n):'<i class="'+V+'"></i>'},C(S.suffix)||(S.suffix=$e[1]);var on="ui-drop-data",ln=0,re=0,oe=0,ie=0,X=0,cn=0,dn=0,pn={};u.create=function(e,t){if(u.is.create)return u;u.is.create=!0,z(e)&&(S=b(S,e));var n=xt(It);return nt(Ft,_t+"-is-can-update"),nt(Ft,_t+"-is-can-copy"),nt(It,Nt),n&&yt(n,"p")?(vt(n,Ft),Jt=n,Tt(n,!1)):vt(It,Ft),Ft.dir=S.direction,Et(Ft,jt),Et(Ft,Bt),Et(Ft,Yt),Et(Bt,It),S.tools&&(Et(jt,At),Et(Yt,Wt),Et(Wt,Zt),Et(Wt,Gt)),qe(pe,It,an),qe(be+" "+se,It,un),S.resize&&(Et(Ft,St),nt(Ft,_t+"-is-can-resize"),qe(he,St,bn),qe(ye,a,hn),qe(ge,D,yn)),fn(),sn(),0!==t?Be("create",[u]):u},u.update=function(e,t){return u.is.create&&u.destroy(0),(0!==t?Be("update",[u]):u).create(e,0)},u.destroy=function(e){return u.is.create?(u.is.create=!1,Lt.exit(0,0,0),rt(It,Nt),S.tools=Oe(S.tools),S.keys&&(Ke(pe,It,an),Ke(be,It,un)),S.resize&&(Ke(he,St,bn),Ke(ye,a,hn),Ke(ge,a,yn)),Jt?(vt(Ft,Jt),Et(Jt,It),Jt=0):vt(Ft,It),$t(Ft),0!==e?Be("destroy",[u]):u):u},u.enable=function(e){return It.disabled=It.readOnly=!1,nt(Ft,_t+"-is-can-update"),nt(Ft,_t+"-is-can-copy"),0!==e?Be("enable",[u]):u},u.disable=function(e){return It.disabled=!0,rt(Ft,_t+"-is-can-update"),rt(Ft,_t+"-is-can-copy"),0!==e?Be("disable",[u]):u},u.freeze=function(e){return It.disabled=!1,It.readOnly=!0,rt(Ft,_t+"-is-can-update"),nt(Ft,_t+"-is-can-copy"),0!==e?Be("freeze",[u]):u},Lt.exit=function(e,t,n){if(I={panel:function(){$t(Xt)},overlay:function(){Ke(ae,Pt,gn),$t(Pt)},modal:function(){Ke(ae+" "+pe,pn.x,vn),Ke(he,Bt,mn),Ke(ye,Bt,kn),Ke(ge,a,wn),$t(Rt)},drop:function(){$t(qt)},bubble:function(){$t(Kt)}},un(),t)if(z(t))for(P in t)P=t[P],I[P]&&I[P](),0!==n&&Be("exit."+P,[u]);else I[t]&&I[t](),0!==n&&Be("exit."+P,[u]);else for(P in I)I[P]();return e&&u.select(),0!==n&&Be("exit",[u]),u},Lt.panel=function(e,t,n,i){function r(e){return Ke(ae+" "+pe,re,r),Lt.panel.exit(1),Re(e)}return Lt.exit(0,0,0),K=Je(e),ee=0,i&&(K+=" "+K+"--"+Je(i)),z(t)&&!w(t)&&(ee=zt(_t+"-panel-header "+K,0,t.header),t=t.body),te=zt(_t+"-panel-body "+K,0,zt(_t+"-panel-content "+K,0,T(t)?"":t)),T(t)&&t(te),re=ft("a",!1,{href:Ce,"class":_t+"-a "+_t+"-x "+K}),re.title=Ot.close,ft(Xt,!1,{"class":_t+"-panel "+K}),qe(ae+" "+pe,re,r),lt(Xt,0),ee&&Et(Xt,ee),Et(Bt,ft(Xt,[te,re])),T(n)?n(Xt):_(n)&&ft(Xt,n),F=[u,Xt],i&&Be("enter.panel."+e+":"+i,F),Be("enter.panel."+e,F),Be("enter.panel",F),Be("enter",F),re.focus(),u},Lt.panel.fit=function(){},Lt.overlay=function(e,t,n,i){return Lt.exit(0,0,0),K=Je(e),i&&(K+=" "+K+"--"+Je(i)),Et(Bt,ft(Pt,!1,{"class":_t+"-overlay "+K})),t&&qe(ae,Pt,gn),T(n)?n(Pt):_(n)&&ft(Pt,n),F=[u,Pt],i&&Be("enter.overlay."+e+":"+i,F),Be("enter.overlay."+e,F),Be("enter.overlay",F),Be("enter",F),u},Lt.overlay.fit=function(){},Lt.message=function(e,t,n,i,r){function f(e){return Ke(ae+" "+pe,re,f),y(o),Lt.overlay.exit(1),Re(e)}var o;return K=Je(e),r&&(K+=" "+K+"--"+Je(r)),re=ft("a",!1,{href:Ce,"class":_t+"-a "+_t+"-x "+K}),re.title=Ot.close,ft(Ut,T(t)?t(Ut):t,{"class":_t+"-message "+K}),qe(ae+" "+pe,re,f),Lt.overlay("message message-"+K,0,function(e){Et(Ut,re),n&&(o=g(function(){f()},n)),Et(e,Ut)},r),T(i)?i(Ut):_(i)&&ft(Ut,i),u},Lt.modal=function(){var s,l,e=arguments,t=e[0],n=e[1],i=e[2],r=e[3],o=_t+"-modal",f=n.footer;if(z(t)&&(t="default",n=e[0],i=e[1],r=e[2]),Lt.overlay(t,1,0,r).blur(),K=Je(t),r&&(K+=" "+K+"--"+Je(r)),ft(Rt,!1,{"class":o+" "+K}),C(n.body)&&(n.body=ft("div",n.body,{"class":o+"-content "+K})),C(f)&&z(f)&&!w(f)){l=[];for(P in f)R=f[P],w(R)?l.push(R):(R=tn(R,P,f),q=P.text||Ot[P]||P,s=ft("button",q,b({name:"y["+P+"]",type:"button","class":_t+"-button",data:{"button-id":P}},R.attributes)),qe(ae,s,function(e){return q=f[Xe(this,"button-id")].click(e,u),q===!1?Re(e):void 0}),l.push(s));n.footer=l}for(P in n)o[1]=P,pn[P]=zt(o+"-"+Ge(P,o)+" "+K,0,n[P]);return pn.x=ft("a",!1,{href:Ce,"class":_t+"-a "+_t+"-x "+K}),pn.sizer=Ht,lt(Rt,0),pn.x.title=Ot.close,Et(Bt,ft(Rt,pn,{style:""})),Lt.modal.fit(),mt(Rt,Pt),qe(ae+" "+pe,pn.x,vn),qe(he,pn.header,Re),qe(he,pn.sizer,Re),qe(he,Bt,mn),qe(ye,Bt,kn),qe(ge,a,wn),T(i)&&i(pn),F=[u,Rt,pn],r&&Be("enter.modal."+t+":"+r,F),Be("enter.modal."+t,F),Be("enter.modal",F),Be("enter",F),pn.x.focus(),u},Lt.modal.fit=function(e){return xn(),K=cn/2-ie/2,ee=dn/2-X/2,z(e)?(C(e[0])&&(K=e[0]),C(e[1])&&(ee=e[1])):(K=d(K,0),ee=d(ee,0)),c(Rt,{left:K+_e,top:ee+_e,"min-width":ie+_e,"min-height":X+_e,visibility:"visible"}),F=[u,Rt,pn],Be("fit.modal",F),Be("fit",F),u};var $n={"class":_t+"-button",name:"y"};return Lt.alert=function(e,t,n,i,r){var o=ft("button",Ot.okay,$n),f="alert";return n=n||m,z(e)&&(f+=":"+e[0],e=e[1]||e[0]),qe(ae,o,function(e){return n(e,u),vn(e,f+".y")}),qe(pe,o,function(e){var t=e.TE.key;return t(/^(escape|enter)$/)&&Ue(ae,o,[e]),Re(e)}),Lt.modal(f,En(e,t,o),i,r),o.focus(),u},Lt.confirm=function(e,t,n,i,r,o){function c(e){return T(n)&&n(e,u),vn(e,a+".y")}function d(e){return T(i)&&i(e,u),vn(e,a+".n")}var l,f=ft("button",Ot.okay,$n),s=ft("button",Ot.cancel,$n),a="confirm";return s.name="n",qe(ae,f,c),qe(ae,s,d),qe(pe,f,function(e){return l=e.TE.key,l("arrowright")?s.focus():l("enter")?c(e):l("escape")&&vn(e,a+".y"),Re(e)}),qe(pe,s,function(e){return l=e.TE.key,l("arrowleft")?f.focus():l("enter")?d(e):l("escape")&&vn(e,a+".n"),Re(e)}),Lt.modal(a,En(e,t,[f,s]),r,o),s.focus(),u},Lt.prompt=function(e,t,n,i,r,o,f){function y(){l.focus(),"placeholder"in l&&l.select()}function g(e){return p=l.value,T(n)&&!n(p)?y():!n||x(p)&&p!==t?(vn(e,c+".y"),i(e,u,p!==t?p:"",t)):y(),Re(e)}function v(e){return vn(e,c+".n")}var p,b,h,s=ft("button",Ot.okay,$n),a=ft("button",Ot.cancel,$n),l=ft("input",!1,{type:"text",value:t,placeholder:t,spellcheck:"false","class":_t+"-input block"}),c="prompt",d=[];if(r=r||0,1===r)l=ft("textarea",t,{placeholder:t.split("\n")[0],"class":_t+"-textarea block",spellcheck:"false"});else if(2===r){for(P in t)d.push(ft("option",t[P],{value:P,selected:P===n||null}));l=ft("select",d,{"class":_t+"-select block"})}return i=i||m,l.name="data",a.name="n",qe(pe,l,function(e){return b=e.TE.key,h=e.TE.control,b("enter")&&0===r||h("enter")?g(e):b("escape")||b("backspace")&&!this.value?v(e):b("arrowdown")&&0===r||b("enter")&&2===r||h("arrowdown")?(s.focus(),Re(e)):void 0}),qe(pe,s,function(e){return b=e.TE.key,b("enter")?g(e):b("escape")?v(e):b("arrowup")?l.focus():b("arrowright")&&a.focus(),Re(e)}),qe(pe,a,function(e){return b=e.TE.key,b(/^(enter|escape)$/)?v(e):b("arrowup")?l.focus():b("arrowleft")&&s.focus(),Re(e)}),qe(ae,s,g),qe(ae,a,v),Lt.modal(c,En(e,l,[s,a]),o,f),y(),u},Lt.drop=function(){Lt.exit(0,0,0);var e=arguments,t=e[0],n=e[1],i=e[2];return 1===Ne(e)&&(t="default",n=e[0],i=e[1]),K=Je(t),lt(qt,0),Et(D,ft(qt,!1,{"class":_t+"-drop "+K})),T(n)?n(qt):ft(qt,n),Lt.drop.fit(),i===!1||qe(ae,a,Tn),qe(ve,s,Tn),F=[u,qt],Be("enter.drop."+t,F),Be("enter.drop",F),u},Lt.drop.fit=function(e){return F=et(M),j=et(qt),B=Lt.drop.target,K=F.w/2-j.w/2,ee=F.h/2-j.h/2,!C(e)&&B&&(t=Ve(B),K=t.l,ee=t.t+et(B).h),z(e)?(C(e[0])&&(K=e[0]),C(e[1])&&(ee=e[1])):(K=d(K,0,F.w-j.w),ee=d(ee,0,Math.max(F.h,et(s).h)-j.h)),c(qt,{left:K+_e,top:ee+_e,visibility:"visible"}),F=[u,qt],Be("fit.drop",F),Be("fit",F),u},Lt.menu=function(e,n,i,r){var s,o=Lt.tools,f=0;if(n===!1)return Lt.tool(e,n);for(r in i)ie="%"===r[0],s=i[r],s=_(s)&&!ie?o[s]:s,s&&(s=tn(s,r,o),i[r]=s);return Lt.tool(e,{i:z(n)?n[0]:0,text:z(n)?n[1]||0:n&&i[n]&&i[n].text||n,click:function(a){var l=Lt.drop.target=o[e].target;return Lt.drop("menu menu-"+Je(e),function(a){function c(f){return ee=this,t=Xe(ee,"tool-id"),U=i[t],U=_(U)?o[U]:U||{},Z=ut(ee),!en(U)&&T(r=U.click)&&(r=r(f,u),U.i&&(o[e].i=U.i),Lt.menu.set(e,z(U.text)?[U.text[0],t]:z(n)?[n[0],t]:t),r===!1)?(u.select(),Re(f)):(u.select(),Re(f))}function d(e){if(ee=this,(q=e.TE.key)("escape"))Lt.exit(1);else if(q("enter"))Ue(ae,ee,[e]);else if(q("f10")&&l)l.focus();else if(q("arrowdown")&&(K=pt(ee))){for(;!yt(K,"a")&&K;)K=pt(K);K&&K.focus()}else if(q("arrowup")&&(K=bt(ee))){for(;!yt(K,"a")&&K;)K=bt(K);!K&&l?(Lt.exit(),l.focus()):K&&K.focus()}else q("arrowup")&&l&&(Lt.exit(),l.focus());return Re(e)}for(r in i)if(s=i[r],ie="%"===r[0],s){var p={href:ie?null:Ce,"class":_t+"-"+(ie?"label":"button")};ie?R=Dt[e]&&Dt[e][+r.slice(1)-1]||r:(p.data={},p.data["tool-id"]=r,R=Mt[r]||r),Q=s.text,Q=z(Q)?Q[1]||"":Q,R=z(R)?R[0]:R,V=ft(ie?"span":"a","<span>"+(ie?R||"%"+f:Q||R)+"</span>",b(p,s.attributes||{})),nt(V,"menu-"+Je(r).replace(/[\/\s]/g,"-")),!p.title&&(ee=s.title)&&(V.title=z(ee)?ee[0]+(ee[1]?" ("+ee[1]+")":""):ee),ie?Ye(V,{id:_t+"-label:"+f}):(en(s)?nt(V,"x"):rt(V,"x"),s.on?nt(V,"on"):rt(V,"on"),qe(ae,V,c),qe(pe,V,d)),Et(a,V),++f}g(function(){(gt('[data-tool-id="'+Xe(l,on)+'"]',a)[0]||gt("a",a)[0]).focus()},1)}),!1}},r),We(o[e].target,{"ui-drop":e}),o[e].data=i,Lt.menu.set(e,n)},Lt.menu.set=function(e,t){var o,f,n=Lt.tools[e]||{},i=n.target,r=n.data;return i?(z(t)?We(i,on,t[1]||""):(We(i,on,t),t=r[t]&&r[t].text||t),z(t)?(f=t[0],f=De(f,"<")?f:Lt.i(f,n.i),t=C(t[1])?t[1]:0,t=t&&r[t]&&r[t].text||t,t=f+(0!==t?"<span>"+(z(t)?t[1]||t:t)+"</span>":"")):f=Lt.i(e,n.i),(o=gt("."+_t+"-text",i)[0])?(nt(i,"text"),at(o,t)):(rt(i,"text"),at(i,f)),u):u},Lt.bubble=function(){Lt.exit(0,0,0);var e=arguments,t=e[0],n=e[1];return 1===Ne(e)&&(t="default",n=e[0]),K=Je(t),lt(Kt,0),Et(D,ft(Kt,!1,{"class":_t+"-bubble "+K})),T(n)?n(Kt):ft(Kt,n),Lt.bubble.fit(),F=[u,Kt],Be("enter.bubble."+t,F),Be("enter.bubble",F),u},Lt.bubble.fit=function(e){V=u.$(1),t=Ve(It),X=c(It,"line-height");var n="border-",i="-width";K=V.caret[0].x+t.l-It.scrollLeft,ee=V.caret[1].y+t.t+X-It.scrollTop,j=c(Bt,[n+"top"+i,n+"bottom"+i,n+"left"+i,n+"right"+i]);var r=et(Bt),o=et(Kt),f=j[0]+j[1],s=j[2]+j[3];return z(e)?(C(e[0])&&(K=e[0]),C(e[1])&&(ee=e[1])):(K=d(K,t.l,t.l+r.w-o.w-s),ee=d(ee,t.t,t.t+r.h-o.h-f)),c(Kt,{left:K+_e,top:ee+_e,visibility:"visible"}),F=[u,Kt],Be("fit.bubble",F),Be("fit",F),u},Lt.panel.exit=function(e){return Lt.exit(e,"panel")},Lt.overlay.exit=function(e){return Lt.exit(e,"overlay")},Lt.modal.exit=function(e){return Lt.exit(e,"modal")},Lt.drop.exit=function(e){return Lt.exit(e,"drop")},Lt.bubble.exit=function(e){return Lt.exit(e,"bubble")},Lt.tool=function(e,t,n){var i=Lt.tools;return R="",q=C(i[e])?"update":"create","|"!==e&&(S.tools=Me(S.tools).filter(function(t,n){return t===e?(R=n,!1):!0})),t===!1?(delete i[e],q="destroy"):("|"===e?(n=t,t={}):(T(t)&&(t={click:t}),i[e]=b(i[e]||{},t),C(n)||""===R||(n=R)),$(n)?S.tools.splice(n,0,e):S.tools.push(e)),Be(q+".tool."+e,[u,i[e]]),fn(),u},Lt.separator=function(e,t){return Lt.tool("|",e!==!1?{attributes:e||{}}:!1,t)},Lt.key=function(e,t){var n=Lt.keys;return q=C(n[e])?"update":"create",t===!1?(delete n[e],q="destroy"):n[e]=t,Be(q+".key."+e,[u,n[e]]),sn(),u},Lt.key.set=function(e){H[e]=1},Lt.key.reset=function(e){e?delete H[e]:H={}},Lt.tools={"|":{},undo:{i:"undo",click:function(e,t){return t.undo(),!1}},redo:{i:"repeat",click:function(e,t){return t.redo(),!1}},indent:function(e,t){return t.indent(Ee),!1},outdent:function(e,t){return t.outdent(Ee),!1}},Lt.keys={"control+y":"redo","control+z":"undo",escape:function(e,t){return Q=":not([tabindex]):not([disabled])",(V=gt("input"+Q+",button"+Q+",select"+Q+",textarea"+Q+",a[href]"+Q+",[contenteditable]"+Q+',[tabindex]:not([tabindex="-1"])',a,0))&&-1!==(ee=V.indexOf(It))?((V[ee+1]||a).focus(),!1):void 0},f10:function(e,t){return gt("a",At)[0].focus(),!1},tab:ke?"indent":0,"shift+tab":ke?"outdent":0},Lt.el={container:Ft,header:jt,body:Bt,footer:Yt,panel:Xt,overlay:Pt,modal:Rt,drop:qt,bubble:Kt},u.config=S,b(TE._,{time:function(e){var t=new Date(C(e)?e:Date.now()),n=t.getFullYear(),i=t.getMonth()+1,r=t.getDate(),o=t.getHours(),f=t.getMinutes(),s=t.getSeconds(),a=t.getMilliseconds();return 10>i&&(i="0"+i),10>r&&(r="0"+r),10>o&&(o="0"+o),10>f&&(f="0"+f),10>s&&(s="0"+s),10>a&&(a="0"+a),[""+n,""+i,""+r,""+o,""+f,""+s,""+a]},replace:Ze,format:Ge,dom:{set:Et,reset:Tt,get:gt,id:st,copy:function(e,t){return e.cloneNode(C(t)?t:!0)},classes:{set:nt,reset:rt,toggle:ot,get:it},attributes:{set:Ye,reset:Ie,get:Ae},data:{set:We,reset:Pe,get:Xe},is:yt,offset:Ve,pointer:Qe,size:et,content:{set:at,reset:lt,get:ut},closest:tt,parent:ct,children:dt,next:pt,previous:bt,index:ht,before:vt,after:mt,prepend:kt,append:wt},el:ft,event:{set:qe,reset:Ke,fire:Ue,x:Re}}),b(u._,TE._),b(u._,{hooks:v,hook:{set:Fe,reset:je,fire:Be}}),u.create()};