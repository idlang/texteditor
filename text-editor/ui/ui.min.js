/*!
 * ==========================================================
 *  USER INTERFACE MODULE FOR TEXT EDITOR PLUGIN 1.4.9
 * ==========================================================
 * Author: Taufik Nurrohman <https://github.com/tovic>
 * License: MIT
 * ----------------------------------------------------------
 */
TE.prototype.ui=function(e){function me(e){return S(e)?d(e).split(/\s+/):e}function Ge(e){return N(e)?e.join(" "):e}function ve(e,t,n){return F(e)?F(t)?(F(v[e])||(v[e]={}),F(n)||(n=Object.keys(v[e]).length),v[e][n]=t,a):v[e]:v}function He(e,t){return F(e)?F(t)&&F(v[e])?(delete v[e][t],a):(v[e]={},a):(v={},a)}function De(e,t,n){if(!F(v[e]))return v[e]={},a;if(F(n))F(v[e][n])&&v[e][n].apply(a,t);else for($ in v[e])v[e][$].apply(a,t);return a}function Me(e,t,n){if(N(t))for($ in t)Me(e,$,t[$]);else e.setAttribute(t,n)}function ye(t,n,r){if(S(n))return ye(t,[n],F(r)?r:"")[0];e=[];for($ in n)$=n[$],($=t.getAttribute($))&&e.push($);return e.length?e:F(r)?r:[]}function Ue(e,t){if(N(t))for($ in t)Ue(e,t[$]);else if(F(t))e.removeAttribute(t);else for(Ue(e,"class"),$=0,x=e.attributes,K=x.length;K>$;++$)x[$]&&Ue(e,x[$].name)}function ke(e,t,n){if(N(t))for($ in t)ke(e,$,t[$]);else Me(e,"data-"+t,n)}function we(t,n,r){if(S(n))return we(t,[n],F(r)?r:"")[0];e=[];for($ in n)$=n[$],($=ye(t,"data-"+$))&&e.push($);return e.length?e:F(r)?r:[]}function Be(e,t){if(N(t))for($ in t)Ue(e,"data-"+t[$]);else if(F(t))Ue(e,"data-"+t);else for($=0,x=e.attributes,K=x.length;K>$;++$)x[$]&&"data-"===x[$].name.slice(0,5)&&Ue(e,x[$].name)}function Pe(e){return e&&e.preventDefault(),!1}function We(e,t,n){if(t){for(e=me(e),$=0,x=e.length;x>$;++$)t.addEventListener(e[$],n,!1),ve("on:"+e[$],n,et(t));return a}}function $e(e,t,n){if(t){for(e=me(e),$=0,x=e.length;x>$;++$)t.removeEventListener(e[$],n,!1),He("on:"+e[$],et(t));return L(t)&&t.id.split(":")[0]===Nt+"-dom"&&Ue(t,"id"),a}}function xe(e,t,n){e=me(e);var i,r="createEvent"in f;for($=0,x=e.length;x>$;++$)r?(i=f.createEvent("HTMLEvents"),i.data=n,i.initEvent(e[$],!0,!1),t.dispatchEvent(i)):De("on:"+e[$],n,et(t));return a}function Ke(e,t,n){for($=0,x=t.length,K;x>$;++$)K=t[$],e=e.replace(b(K)?K:O(u(K),"g"),n&&n[$]||"");return e}function Ye(e,t){return e.replace(/%(\d+)/g,function(e,n){return--n,F(t[n])?t[n]:e})}function _e(e){return d(Ke(e,[/[^ \/a-z\d-]/g,/([ -])+/g,/^-|-$/g],["-","$1",""]))}function Ve(e,t){var n=t.touches?t.touches[0].pageX:t.pageX,r=t.touches?t.touches[0].pageY:t.pageY,i=qe(e);return{x:n-i.l,y:r-i.t}}function qe(e){for(Y=e.offsetLeft,X=e.offsetTop;e=e.offsetParent;)Y+=e.offsetLeft,X+=e.offsetTop;return{l:Y,t:X}}function ze(e){return{w:e.offsetWidth,h:e.offsetHeight}}function Qe(e,t){for(;(e=it(e))&&e!==t;);return e}function je(e,t){t=me(t);for($ in t)e.classList.add(t[$])}function Xe(t,n,r){if(S(n))return Xe(t,[n],F(r)?r:"")[0];e=[];for($ in n)$=n[$],t.classList.contains($)&&e.push($);return e.length?e:F(r)?r:!1}function Je(e,t){if(F(t)){t=me(t);for($ in t)e.classList.remove(t[$])}else Ue(e,"class")}function Ze(e,t,n){if(e=S(e)?f.createElement(e):e,N(n))for($ in n)if(Z=n[$],"classes"===$)je(e,Z);else if("data"===$)for(x in Z)Z=Z[x],null===Z?Be(e,x):ke(e,x,Z);else"css"===$?S(Z)?Me(e,"style",Z):null===Z?Ue(e,"style"):A(e,Z):T(Z)?e[$]=Z:null===Z?Ue(e,$):Me(e,$,N(Z)?Z.join(" "):""+Z);if(L(t))dt(e,t);else if(N(t))for($ in t)Z=t[$],L(Z)?dt(e,Z):Z!==!1&&tt(e,Z);else F(t)&&t!==!1&&tt(e,t);return e}function et(e){var t=e.id;return t||(t=Nt+"-dom:"+Date.now(),e.id=t),t}function tt(e,t){e.innerHTML=t}function nt(e,t){return e.innerHTML||(F(t)?t:"")}function rt(e,t){if(t!==!1&&(U=ot(e)))for($=0,x=U.length;x>$;++$)rt(U[$]);tt(e,"")}function it(e){return e&&e.parentNode}function ot(e){return e&&e.children||[]}function lt(e){return e&&e.nextSibling}function ft(e){return e&&e.previousSibling}function at(e,t){return e&&S(t)?e.nodeName.toLowerCase()===t.toLowerCase():e&&T(t)?e===t(e):e===t}function st(t,n){if(n=n||f,e=[],S(t)){if(/^([#.]?[\w-]+|\*)$/.test(t)){if("#"===t[0]&&(t=n.getElementById(t.slice(1))))return[t];if("."===t[0]&&(t=n.getElementsByClassName(t.slice(1)))||(t=n.getElementsByTagName(t))){for($=0,x=t.length;x>$;++$)e.push(t[$]);return e}return[]}for(t=n.querySelectorAll(t),$=0,x=t.length;x>$;++$)e.push(t[$]);return e}return ut(t)?[t]:[]}function ut(e,t){var n=it(e);return 1===arguments.length?n||!1:e&&n===e?n:!1}function ct(e,t){q=it(e),q&&q.insertBefore(t,e)}function At(e,t){q=it(e),q&&q.insertBefore(t,lt(e))}function Et(e,t){U=ot(e)[0],U?ct(U,t):dt(e,t)}function Ot(e,t){dt(e,t)}function dt(e,t){e.appendChild(t)}function pt(e,t){var n=ut(e);if(n){if(t!==!1)for(U=ot(e)[0];U;)pt(U);n.removeChild(e)}}function Rt(e){rt(Ze(e,!1,{style:""})),pt(e)}function It(e,t,n){return Ze(t||"div",n,{"class":e})}function Vt(e){return!e||F(e.active)&&!j.active}function qt(){Ct._word&&Ct._words&&(Z=(Mt.value||"").replace(O(be[0]+"[^"+be[0]+be[1]+"]+?"+be[1],"g"),""),$=(Z.match(/(\w+)/g)||[]).length,tt($t,Ye(Ct["_word"+(1===$?"":"s")],[$])))}function zt(e,t,n){return T(e)&&(e={click:e}),S(e.click)&&(e.click=(n[e.click]||{}).click),F(e.title)||(e.title=bt[t]||""),n[t]=e,e}function Qt(e){Lt.exit(0,0,0);var t=we(this,Fe),n=Lt.tools,r=n[t];return Lt.drop.target=e.currentTarget||e.target,!Vt(r)&&T(x=r.click)&&(x=x(e,a,t),De("on:change",[e,a,t]),x===!1)?Pe(e):(a.select(),Pe(e))}function jt(e){if(X=this,(K=e.TE.key)(/^(escape|f10)$/))Lt.exit(1);else if(K("enter"))Lt.drop.target=X,xe(Ae,X,[e]);else if(K("arrowright")&&(Y=lt(X))){for(;!at(Y,"a")&&Y;)Y=lt(Y);Y&&Y.focus()}else if(K("arrowleft")&&(Y=ft(X))){for(;!at(Y,"a")&&Y;)Y=ft(Y);Y&&Y.focus()}return Pe(e)}function Xt(){rt(Dt,!1);var r,i,o,l,f,s,u,e=me(D.tools),t=Nt+"-button",n=Nt+"-separator";D.tools=e;for(s in e)u=e[s],i=Lt.tools[u],(i||i==={})&&(i=zt(i,u,Lt.tools),o=i.i||u,"|"!==o&&"<"!==o[0]&&(o=_e(o)),l="|"!==o,f=_e(o).replace(/\s/g,""),Yt=It(l?t+" "+t+"-"+f:n+" "+n+"-"+s,l?"a":"span"),l?(r=t+":"+f,Me(Yt,{href:Ce,id:r,tabindex:-1}),ke(Yt,Fe,u),o="<"===o[0]?o:'<i class="'+Ye(ht,[o])+'"></i>',Vt(i)&&je(Yt,"x"),i.text&&(o=Ye('<span class="'+Nt+'-text">'+i.text+"</span>",[o]),je(Yt,"text")),tt(Yt,o),Ze(Yt,!1,i.attributes||{}),!Yt.title&&(x=i.title)&&(Yt.title=N(x)?x[0]+(x[1]?" ("+x[1]+")":""):x),We(Ae,Yt,Qt),We(ie,Yt,jt)):Yt.id=n+":"+s,Lt.tools[u].target=Yt,dt(Dt,Yt));De("update.tools",[a])}function Jt(){Lt.keys=function(){var n,e=Object.keys(Lt.keys).sort().reverse(),t={};for($=0,x=e.length;x>$;++$)n=e[$],t[n]=Lt.keys[n];return t}(),rn(1),De("update.keys",[a])}function Zt(e){qt(),De("on:change",[e,a])}function nn(t){function E(e){return e.replace(/\+/g,"\n").replace(/\n\n/g,"\n+").split("\n")}var n=a.$(),r=n.before,i=n.after,o=r.slice(-1),l=i[0],f=n.length,s=Lt.keys,c=TE.keys_alias,A=(r.match(/(?:^|\n)([\t ]*).*$/)||[""]).pop();V=t.TE.key(),en[V]=1,e=Object.keys(en).length,p(function(){a.record()},1);for($ in s){K=E($),U=0;for(x in K)x=K[x],en[c[x]||x]&&++U;if(K=K.length,U===K&&e===K&&(S(s[$])&&(s[$]=Lt.tools[s[$]].click),Y=s[$]&&s[$](t,a),Y===!1))return Pe(t)}if(Te)for($ in Te)if(_=Te[$],_!==!1){if(V===_&&l===_)return"\\"===o?(a.insert(V,0),Pe(t)):(a.select(n.end+1),Pe(t));if($===V)return a.wrap($,_),Pe(t);if(o===$&&l===_){if("backspace"===V&&r.slice(-2)!=="\\"+$)return a.unwrap($,_),Pe(t);if(Le&&"enter"===V&&$!==_)return a.tidy("\n"+A+Ie,"\n"+A),Pe(t)}}if(Le&&!f){if("backspace"===V&&O(u(Ie)+"$").test(r))return a.outdent(Ie),Pe(t);if("enter"===V&&O("(^|\\n)("+u(Ie)+")+.*$").test(r))return a.insert("\n"+A,0,1),Pe(t)}}function rn(e){N(e)?delete en[e.TE.key()]:en={}}function on(e){/^(focus|blur)$/.test(e.type)&&rn(1),R(tn),tn=p(function(){Zt(e)},D.debounce||0)}function un(e){return ln=yt,j=ze(Ht),Pe(e)}function cn(e){ln===yt&&A(Mt,{height:Ve(vt,e).y-j.h+ge})}function An(){ln=0}function En(){Lt.exit(1)}function On(){e=ze(wt),ee=e.w,W=e.h,e=ze(kt),fn=e.w,an=e.h}function dn(e,t){t&&De("exit.modal."+t,[a]),xe(Ae,kt,[e])}function pn(t){ln=t.target,e=Ve(wt,t),te=e.x,ne=e.y,On()}function Rn(t){var n=sn.header,r=sn.resize;ln===n||Qe(ln,n)===n?(e=Ve(vt,t),Y=e.x-te,X=e.y-ne,A(wt,{left:(ee>fn?Y:E(Y,0,fn-ee))+ge,top:(W>an?X:E(X,0,an-W))+ge})):ln===r&&(e=Ve(wt,t),j=ze(r),A(wt,{width:e.x+j.w/4+ge,height:e.y+j.h/4+ge}))}function In(){ln=0}function Ln(e,t,n){return{header:e,body:t,footer:n}}function Tn(e){M=Lt.drop.target,y=Bt,U=e&&e.target||0,(!U||U!==M&&Qe(U,M)!==M)&&(Lt.drop.target=0,Rt(Bt),$e(Ae,f,Tn),$e(de,l,Tn),Lt.exit(e.target===G))}function Nn(t){function i(){e&&(q=ze(e),A(Q,{width:q.w+ge,height:q.h+ge}))}var n=a.get(),r="";return-1===n.indexOf("</html>")&&(r='<!DOCTYPE html><html dir="'+D.dir+'"><head><meta charset="utf-8"><style>'+D.css+"</style></head><body>"+n+"</body></html>"),Q=Ze("iframe",!1,{"class":Nt+"-portal",src:"data:text/html,"+encodeURIComponent(r)}),!ut(kt)&&n?Lt.overlay(Q,1,function(){e=ot(kt)[0],i(),We(de,l,i),De("enter.overlay.preview",[t,a,[n,r],e])}):($e(de,l,i),En()),Pe(t)}var M,y,U,w,B,W,$,x,K,Y,_,V,e,q,Q,j,X,Z,ee,te,ne,t="⌘",n="…",i="⇥",o="⇧",l=window,f=document,a=this,s=a._,u=s.x,c=s.extend,A=s.css,E=s.edge,O=s.pattern,d=s.trim,p=s.timer.set,R=s.timer.reset,I=a.is,L=I.e,T=I.f,h=I.i,N=I.o,b=I.r,S=I.s,F=function(e){return!I.x(e)},C=f.documentElement,m=(f.head,f.body),G=a.target,v={},H=function(){},D=c({tab:"  ",dir:"ltr",keys:1,tools:"indent outdent | undo redo",attributes:{spellcheck:"false"},css:"html,body{background:#fff;color:#000}",unit:[[["<",">","/"],["=",'"','"'," "]],[["\\u003C","\\u003E","\\u002F"],["\\u003D","\\u0022","\\u0022","\\u0020"]]],suffix:0,auto_tab:1,auto_close:{'"':'"',"'":"'","(":")","{":"}","[":"]","<":">"},languages:{tools:{undo:["Undo",t+"+Z"],redo:["Redo",t+"+Y"],indent:["Indent",i],outdent:["Outdent",o+"+"+i],preview:["Preview","F5"]},buttons:{okay:"OK",cancel:"Cancel",yes:"Yes",no:"No",enter:"Enter",exit:"Exit",open:"Open",close:"Close",ignore:"Ignore"},placeholders:{"":"text here"+n},labels:{},others:{preview:"Preview",_word:"%1 Word",_words:"%1 Words"}},classes:{"":"text-editor",i:"icon icon-%1 fa fa-%1"},debounce:500},e),ie="keydown",oe="keyup",le="copy",fe="cut",ae="paste",se="touchstart mousedown",ue="touchend mouseup",ce="touchmove mousemove",Ae="click",Ee="focus",Oe="blur",de="orientationchange resize",pe=Oe+" "+le+" "+fe+" "+Ee+" input "+ie+" "+ae,Re=D.languages,Ie=D.tab,Le=D.auto_tab,Te=D.auto_close,he=D.unit[0][0],be=(D.unit[0][1],D.unit[1][0]),Se=D.unit[1][1],Fe="tool-id",Ce="javascript:;",ge="px",Lt=a.ui={};a.tidy=function(e,t){var n=a.$(),r=d(n.before)?e:"",i=d(n.after)?F(t)?t:e:"";return a.trim(r,i)},a.i=function(){return d(a.replace(/\s+/g," "))},a.format=function(e,t,n,r){N(e)||(e=[e]),F(n)||(n=" "),F(r)||(r="");var i=a.h,o=a[0]().$(),l=(e[0]?he[0]+e[0]+he[1]:"")+r,f=r+(e[0]?he[0]+he[2]+(e[1]||e[0].split(O("("+Se[3]+")+"))[0])+he[1]:""),s=u(l),c=u(f),A=O("^"+s+"([\\s\\S]*?)"+c+"$"),E=O(s+"$"),d=O("^"+c),p=o.before,R=o.after;return o.length?n=!1:a.insert(Re.placeholders[""]),a.toggle(t?!A.test(o.value):!E.test(p)&&!d.test(R),[function(e){e.unwrap(l,f,1).tidy(O(be[0]+"[^"+be[0]+be[1]+be[2]+"]+?"+be[1]+"$").test(p)?"":n,O("^"+be[0]+be[2]+"[^"+be[0]+be[1]+"]+?"+be[1]).test(R)?"":n).wrap(l,f,t)},function(e){e.unwrap(l,f,t)}])[i]()};var Yt,Tt=D.classes,ht=Tt.i,Nt=Tt[""],bt=Re.tools,St=Re.buttons,Ft=Re.labels,Ct=Re.others,gt=Nt+"-textarea "+Nt+"-content block",mt=It(Nt),Gt=It(Nt+"-header"),vt=It(Nt+"-body"),Ht=It(Nt+"-footer"),Dt=It(Nt+"-tool"),Mt=Ze(G,!1,D.attributes),yt=It(Nt+"-resize s"),Ut=It(Nt+"-description"),kt=It(Nt+"-overlay"),wt=Ze("div"),Bt=Ze("div"),Pt=Ze("div"),Wt=It("left","span"),$t=It("right","span"),xt=It(Nt+"-preview","a"),Kt=0;D.suffix||(D.suffix=he[1]);var en={},tn=null;a.create=function(e,t){N(e)&&(D=c(D,e));var n=ut(Mt);return je(Mt,gt),n&&at(n,"p")?(ct(n,mt),Kt=n,pt(n,!1)):ct(Mt,mt),mt.dir=D.dir,dt(mt,Gt),dt(mt,vt),dt(mt,Ht),dt(mt,yt),dt(vt,Mt),D.tools&&(dt(Gt,Dt),dt(Ht,Ut),dt(Ut,Wt),dt(Ut,$t)),We(ie,Mt,nn),We(oe,Mt,rn),We(pe,Mt,on),We(se,yt,un),We(ce,f,cn),We(ue,m,An),Ct.preview&&(j=bt.preview,Me(xt,{href:Ce,title:N(j)?j[0]+(j[1]?" ("+j[1]+")":""):j}),dt(Wt,xt),tt(xt,Ct.preview)),Zt(null),Xt(),Jt(),0!==t?De("create",[a]):a},a.update=function(e,t){return Xe(Mt,me(gt),0)&&a.destroy(0),(0!==t?De("update",[a]):a).create(e,0)},a.destroy=function(e){return Xe(Mt,me(gt),0)?(Lt.exit(0,0,0),Je(Mt,gt),D.tools=Ge(D.tools),D.keys&&($e(ie,Mt,nn),$e(oe,Mt,rn)),$e(se,yt,un),$e(ce,f,cn),$e(ue,f,An),$e(pe,Mt,on),Kt?(ct(mt,Kt),dt(Kt,Mt),Kt=0):ct(mt,Mt),Rt(mt),0!==e?De("destroy",[a]):a):a};var ln=0,te=0,ne=0,ee=0,W=0,fn=0,an=0,sn={};Lt.exit=function(e,t,n){if(B={overlay:function(){$e(Ae,kt,En),Rt(kt)},modal:function(){$e(se,vt,pn),$e(ce,vt,Rn),$e(ue,f,In),$e(Ae,sn.x,dn),Rt(wt)},drop:function(){Rt(Bt)},bubble:function(){Rt(Pt)}},t)if(N(t))for($ in t)$=t[$],B[$]&&B[$](),0!==n&&De("exit."+$,[a]);else B[t]&&B[t](),0!==n&&De("exit."+$,[a]);else for($ in B)B[$]();return e&&a.select(),0!==n&&De("exit",[a]),a},Lt.overlay=function(e,t,n){return Lt.exit(0,0,0),rn(1),dt(vt,Ze(kt,e.length||L(e)?It(Nt+"-overlay-content","div",e):"")),t&&We(Ae,kt,En),T(n)?n(kt):Ze(kt,n),De("enter.overlay",[a]),De("enter",[a]),a},Lt.overlay.fit=function(){},Lt.modal=function(){Lt.overlay("",1).blur();var e=arguments,t=e[0],n=e[1],r=e[2],i=Nt+"-modal";N(t)&&(t="default",n=e[0],r=e[1]),Y=_e(t),Ze(wt,!1,{"class":i+" "+Y}),F(n.body)&&(n.body=Ze("div",n.body,{"class":i+"-content "+Y}));for($ in n)i[1]=$,sn[$]=It(i+"-"+Ye($,i)+" "+Y,0,n[$]);return sn.x=It(Nt+"-x "+Y),sn.resize=It(Nt+"-resize se "+Y),rt(wt),dt(vt,Ze(wt,sn,{style:""})),Lt.modal.fit(),At(wt,kt),We(Ae,sn.x,dn),We(se,sn.header,Pe),We(se,sn.resize,Pe),We(se,vt,pn),We(ce,vt,Rn),We(ue,f,In),T(r)&&(sn.overlay=kt,sn.modal=wt,r(sn)),De("enter.modal."+t,[a]),De("enter.modal",[a]),De("enter",[a]),a},Lt.modal.fit=function(e){return On(),Y=fn/2-ee/2,X=an/2-W/2,N(e)?(F(e[0])&&(Y=e[0]),F(e[1])&&(X=e[1])):(Y=E(Y,0),X=E(X,0)),A(wt,{left:Y+ge,top:X+ge,"min-width":ee+ge,"min-height":W+ge,visibility:"visible"}),De("fit.modal",[a]),De("fit",[a]),a};var hn={"class":Nt+"-button",name:"y"};return Lt.alert=function(e,t,n,r){var i=Ze("button",St.okay,hn),o="alert";return n=n||H,N(e)&&(o+=":"+e[0],e=e[1]||e[0]),We(Ae,i,function(e){return n(e,a),dn(e,o+".y"),Pe(e)}),We(ie,i,function(e){var t=e.TE.key;return t(/^(escape|enter)$/)?(xe(Ae,i,[e]),Pe(e)):void 0}),Lt.modal(o,Ln(e,t,i),r),i.focus(),a},Lt.confirm=function(e,t,n,r,i){function u(e){return T(n)&&n(e,a),dn(e,f+".y"),Pe(e)}function c(e){return T(r)&&r(e,a),dn(e,f+".n"),Pe(e)}var s,o=Ze("button",St.okay,hn),l=Ze("button",St.cancel,hn),f="confirm";return l.name="n",N(e)&&(f+=":"+e[0],e=e[1]||e[0]),We(Ae,o,u),We(Ae,l,c),We(ie,o,function(e){return s=e.TE.key,s("arrowright")?(l.focus(),Pe(e)):s("arrowleft")?Pe(e):s("enter")?(u(e),Pe(e)):s("escape")?(dn(e,f+".y"),Pe(e)):void 0}),We(ie,l,function(e){return s=e.TE.key,s("arrowright")?Pe(e):s("arrowleft")?(o.focus(),Pe(e)):s("enter")?(c(e),Pe(e)):s("escape")?(dn(e,f+".n"),Pe(e)):void 0}),Lt.modal(f,Ln(e,t,[o,l]),i),l.focus(),a},Lt.prompt=function(e,t,n,r,i,o){function O(){s.focus(),"placeholder"in s&&s.select()}function p(e){return Pe(e)}function R(e){return A=s.value,!n||d(A)&&A!==t?(dn(e,u+".y"),Pe(e),r(e,a,A!==t?A:"",t)):(O(),p(e))}function I(e){return dn(e,u+".n"),Pe(e)}var A,E,l=Ze("button",St.okay,hn),f=Ze("button",St.cancel,hn),s=Ze("input",!1,{type:"text",value:t,placeholder:t,spellcheck:"false","class":Nt+"-input block"}),u="prompt",c=[];if(N(e)&&(u+=":"+e[0],e=e[1]||e[0]),T(i)&&(o=i,i=0),1===i)s=Ze("textarea",t,{placeholder:t.split("\n")[0],"class":Nt+"-textarea block"});else if(2===i){for($ in t)c.push(Ze("option",t[$],{value:$,selected:$===n||null}));s=Ze("select",c,{"class":Nt+"-select block"})}return r=r||H,s.name="data",f.name="n",We(ie,s,function(e){return E=e.TE.key,E("enter")?R(e):E("escape")||E("backspace")&&!this.value?I(e):E("arrowup")?p(e):E("arrowdown")?(l.focus(),Pe(e)):void 0}),We(ie,l,function(e){return E=e.TE.key,E("enter")?R(e):E("escape")?I(e):E("arrowup")?(s.focus(),Pe(e)):E("arrowright")?(f.focus(),Pe(e)):E(/^arrow(down|left)$/)?p(e):void 0}),We(ie,f,function(e){return E=e.TE.key,E(/^(enter|escape)$/)?I(e):E("arrowup")?(s.focus(),Pe(e)):E(/^arrow(right|down)$/)?p(e):E("arrowleft")?(l.focus(),Pe(e)):void 0}),We(Ae,l,R),We(Ae,f,I),Lt.modal(u,Ln(e,s,[l,f]),o),O(),a},Lt.drop=function(){Lt.exit(0,0,0);var e=arguments,t=e[0],n=e[1];return 1===e.length&&(t="default",n=e[0]),Y=_e(t),rt(Bt),dt(m,Ze(Bt,!1,{"class":Nt+"-drop "+Y})),T(n)?n(Bt):Ze(Bt,n),Lt.drop.fit(),We(Ae,f,Tn),We(de,l,Tn),De("enter.drop."+t,[a]),De("enter.drop",[a]),a},Lt.drop.fit=function(t){return M=ze(C),y=ze(Bt),U=Lt.drop.target,Y=M.w/2-y.w/2,X=M.h/2-y.h/2,!F(t)&&U&&(e=qe(U),Y=e.l,X=e.t+ze(U).h),N(t)?(F(t[0])&&(Y=t[0]),F(t[1])&&(X=t[1])):(Y=E(Y,0,Math.max(M.w,l.innerWidth)-y.w),X=E(X,0,Math.max(M.h,l.innerHeight)-y.h)),A(Bt,{left:Y+ge,top:X+ge,visibility:"visible"}),De("fit.drop",[a]),De("fit",[a]),a},Lt.menu=function(e,t,n,r){t=!N(t)&&n[t]&&n[t].text||t;var s,i=Lt.tools,o='<span class="'+Nt+'-current menu">%1</span>',l="",f=0;return t===!1?Lt.tool(e,t):(N(t)&&(l=t[0],l="<"===l[0]?l:'<i class="'+Ye(ht,[l])+'"></i>',t=F(t[1])?t[1]:0,t=t&&n[t]&&n[t].text||t,o=l+(0!==t?" "+o:"")),Lt.tool(e,{i:l,text:t?Ye(o,[t,l]):0,click:function(u){return Lt.drop("menu menu-"+_e(e),function(u){function A(e){return X=this,_=n[we(X,Fe)],_=S(_)?i[_]:_||{},V=nt(X),!Vt(_)&&T(r=_.click)&&(r=r(e,a),t!==!1&&M&&(U=ot(M)[0]||M,at(U,"i")||tt(U,Ye(o,[V,l])),N(_.text)&&(U=ot(U)[0])&&at(U,"i")&&(Je(U),je(U,Ye(ht,[_.text[0]])))),r===!1)?Pe(e):(a.select(),Pe(e))}function E(e){if(X=this,(K=e.TE.key)("escape"))Lt.exit(1);else if(K("enter"))xe(Ae,X,[e]);else if(K("f10")&&M)M.focus();else if(K("arrowdown")&&(Y=lt(X))){for(;!at(Y,"a")&&Y;)Y=lt(Y);Y&&Y.focus()}else if(K("arrowup")&&(Y=ft(X))){for(;!at(Y,"a")&&Y;)Y=ft(Y);!Y&&M?(Lt.exit(),M.focus()):Y&&Y.focus()}else K("arrowup")&&M&&(Lt.exit(),M.focus());return Pe(e)}M=Lt.drop.target;for(r in n)if(s=n[r],ee="%"===r[0],s=S(s)&&!ee?i[s]:s){s=zt(s,r,i);var O={href:ee?null:Ce,"class":Nt+"-"+(ee?"label":"button")};ee?x=Ft[e]&&Ft[e][+r.slice(1)-1]||r:(O.data={},O.data[Fe]=r,x=bt[r]||r),Q=s.text,Q=N(Q)?Q[1]||"":Q,x=N(x)?x[0]:x,j=Ze(ee?"span":"a",ee?"<span>"+(x||"%"+f)+"</span>":s.text||x,c(O,s.attributes||{})),!j.title&&(X=s.title)&&(j.title=N(X)?X[0]+(X[1]?" ("+X[1]+")":""):X),ee?Me(j,{id:Nt+"-label:"+f}):(Vt(s)&&je(j,"x"),We(Ae,j,A),We(ie,j,E)),n[r]=s,dt(u,j),++f}p(function(){st("a",u)[0].focus()},1)}),!1}},r),We(ie,i[e].target,function(t){return t.TE.key("arrowdown")?(Lt.drop.target=this,i[e].click(w,a),Pe(t)):void 0}),i[e].data=n,a)},Lt.bubble=function(){Lt.exit(0,0,0);var e=arguments,t=e[0],n=e[1];return 1===e.length&&(t="default",n=e[0]),Y=_e(t),rt(Pt),dt(m,Ze(Pt,!1,{"class":Nt+"-bubble "+Y})),T(n)?n(Pt):Ze(Pt,n),Lt.bubble.fit(),De("enter.bubble."+t,[a]),De("enter.bubble",[a]),a},Lt.bubble.fit=function(t){j=a.$(1),e=qe(Mt),W=A(Mt,"line-height");var n="border-",r="-width";Y=j.caret[0].x+e.l-Mt.scrollLeft,X=j.caret[1].y+e.t+W-Mt.scrollTop,y=A(vt,[n+"top"+r,n+"bottom"+r,n+"left"+r,n+"right"+r]);var i=ze(vt),o=ze(Pt),l=y[0]+y[1],f=y[2]+y[3];return N(t)?(F(t[0])&&(Y=t[0]),F(t[1])&&(X=t[1])):(Y=E(Y,e.l,e.l+i.w-o.w-f),X=E(X,e.t,e.t+i.h-o.h-l)),A(Pt,{left:Y+ge,top:X+ge,visibility:"visible"}),De("fit.bubble",[a]),De("fit",[a]),a},Lt.overlay.exit=function(e){return Lt.exit(e,"overlay")},Lt.modal.exit=function(e){return Lt.exit(e,"modal")},Lt.drop.exit=function(e){return Lt.exit(e,"drop")},Lt.bubble.exit=function(e){return Lt.exit(e,"bubble")},Lt.tool=function(e,t,n){return x="","|"!==e&&(D.tools=D.tools.filter(function(t,n){return t===e?(x=n,!1):!0})),t===!1?delete Lt.tools[e]:("|"===e?(n=t,t={}):(T(t)&&(t={click:t}),Lt.tools[e]=c(Lt.tools[e]||{},t),F(n)||""===x||(n=x)),h(n)?D.tools.splice(n,0,e):D.tools.push(e)),Xt(),a},Lt.key=function(e,t){return D.keys?(t===!1?delete Lt.keys[e]:Lt.keys[e]=t,Jt(),a):a},Lt.tools={"|":{},undo:{i:"undo",click:function(e,t){return t.undo(),!1}},redo:{i:"repeat",click:function(e,t){return t.redo(),!1}},indent:function(e,t){return t.indent(Ie),!1},outdent:function(e,t){return t.outdent(Ie),!1}},We(Ae,xt,Nn),Lt.keys={"control+y":"redo","control+z":"undo",f5:function(e,t){return Nn(e)},f10:function(e,t){return st("a",Dt)[0].focus(),!1},"shift+tab":Le?"outdent":0,tab:Le?"indent":0,escape:function(e,t){return xt.focus(),!1}},Lt.el={container:mt,header:Gt,body:vt,footer:Ht,overlay:kt,modal:wt,drop:Bt,bubble:Pt},a.config=D,c(a._,{time:function(){var e=new Date,t=e.getFullYear(),n=e.getMonth()+1,r=e.getDate(),i=e.getHours(),o=e.getMinutes(),l=e.getSeconds(),f=e.getMilliseconds();return 10>n&&(n="0"+n),10>r&&(r="0"+r),10>i&&(i="0"+i),10>o&&(o="0"+o),10>l&&(l="0"+l),10>f&&(f="0"+f),[""+t,""+n,""+r,""+i,""+o,""+l,""+f]},replace:Ke,format:Ye,dom:{set:dt,reset:pt,get:st,id:et,copy:function(e,t){return e.cloneNode(F(t)?t:!0)},classes:{set:je,reset:Je,get:Xe},attributes:{set:Me,reset:Ue,get:ye},data:{set:ke,reset:Be,get:we},is:at,offset:qe,point:Ve,size:ze,content:{set:tt,reset:rt,get:nt},closest:Qe,parent:it,children:ot,next:lt,previous:ft,before:ct,after:At,prepend:Et,append:Ot},el:Ze,event:{set:We,reset:$e,fire:xe,x:Pe},hooks:v,hook:{set:ve,reset:He,fire:De}}),Lt};