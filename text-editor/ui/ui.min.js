/*!
 * ==========================================================
 *  USER INTERFACE MODULE FOR TEXT EDITOR PLUGIN 1.9.0
 * ==========================================================
 * Author: Taufik Nurrohman <https://github.com/tovic>
 * License: MIT
 * ----------------------------------------------------------
 */
TE.ui=function(e,t){function Ce(e){return e.toLowerCase()}function xe(e){return C(e)?g(e).split(/\s+/):e}function Ue(e){return N(e)?e.join(" "):e}function ke(e,t){return-1!==e.indexOf(t)}function Fe(e){return Object.keys(e)}function Ge(e){return e.length}function we(e){return Ge(Fe(e))}function De(e,t,n){return S(e)?S(t)?(S(I[e])||(I[e]={}),S(n)||(n=we(I[e])),I[e][n]=t,f):I[e]:I}function Me(e,t){return S(e)?S(t)&&S(I[e])?(delete I[e][t],f):(I[e]={},f):(I={},f)}function He(e,t,n){if(!S(I[e]))return I[e]={},f;if(S(n))S(I[e][n])&&I[e][n].apply(f,t);else for(z in I[e])I[e][z].apply(f,t);return f}function Ye(e,t,n){if(N(t))for(z in t)Ye(e,z,t[z]);else e[(null===n?"remove":"set")+"Attribute"](t,n)}function Be(e,n,i){if(!n){for(t={},z=0,K=e.attributes,j=Ge(K);j>z;++z)Z=K[z],t[Z.name]=Z.value;return we(t)?t:S(i)?i:{}}if(C(n))return Be(e,[n],[S(i)?i:""])[0];t=[];for(z in n)z=n[z],z=e.getAttribute(z)||"",t.push(z);return Ge(t)?t:S(i)?i:[]}function Pe(e,t){if(N(t))for(z in t)Pe(e,t[z]);else if(S(t))e.removeAttribute(t);else for(Pe(e,"class"),z=0,K=e.attributes,j=Ge(K);j>z;++z)K[z]&&Pe(e,K[z].name)}function We(e,t,n){if(N(t))for(z in t)We(e,z,t[z]);else Ye(e,"data-"+t,n)}function ze(e,n,i){if(!n){for(t={},z=0,K=e.attributes,j=Ge(K);j>z;++z)Z=K[z],"data-"===Z.name.slice(0,5)&&(t[Z.name]=Z.value);return we(t)?t:S(i)?i:{}}if(C(n))return ze(e,[n],[S(i)?i:""])[0];t=[];for(z in n)z=n[z],z=Be(e,"data-"+z),t.push(z);return Ge(t)?t:S(i)?i:[]}function Ke(e,t){if(N(t))for(z in t)Pe(e,"data-"+t[z]);else if(S(t))Pe(e,"data-"+t);else for(z=0,K=e.attributes,j=Ge(K);j>z;++z)K[z]&&"data-"===K[z].name.slice(0,5)&&Pe(e,K[z].name)}function je(e){return e&&e.preventDefault(),!1}function Ze(e,t,n){if(t){for(e=xe(e),z=0,K=Ge(e);K>z;++z)t.addEventListener(e[z],n,!1),De("on:"+e[z],n,st(t));return f}}function $e(e,t,n){if(t){for(e=xe(e),z=0,K=Ge(e);K>z;++z)t.removeEventListener(e[z],n,!1),Me("on:"+e[z],st(t));return T(t)&&t.id.split(":")[0]===Ft+"-dom"&&Pe(t,"id"),f}}function Je(e,t,n){e=xe(e);var r,i="createEvent"in u;for(z=0,K=Ge(e);K>z;++z)i?(r=u.createEvent("HTMLEvents"),r.data=n,r.initEvent(e[z],!0,!1),t.dispatchEvent(r)):He("on:"+e[z],n,st(t));return f}function Ve(e,t,n){for(z=0,K=Ge(t),j;K>z;++z)j=t[z],e=e.replace(m(j)?j:p(h(j),"g"),n&&n[z]||"");return e}function _e(e,t){return e.replace(/%(\d+)/g,function(e,n){return--n,S(t[n])?t[n]:e})}function Xe(e){return g(Ve(Ce(e),[/[^ \/a-z\d-]/g,/([ -])+/g,/^-|-$/g],["-","$1",""]))}function Qe(e,t){var n=t.touches?t.touches[0].pageX:t.pageX,i=t.touches?t.touches[0].pageY:t.pageY,r=qe(e);return{x:n-r.l,y:i-r.t}}function qe(e){for(Z=e.offsetLeft,q=e.offsetTop;e=e.offsetParent;)Z+=e.offsetLeft,q+=e.offsetTop;return{l:Z,t:q}}function et(e){return e===s?{w:e.innerWidth,h:e.innerHeight}:{w:e.offsetWidth,h:e.offsetHeight}}function tt(e,t){for(;(e=dt(e))&&e!==t;);return e}function nt(e,t){t=xe(t);for(z in t)e.classList.add(t[z])}function it(e,n,i){if(!n)return t=xe(e.className),Ge(t)?t:S(i)?i:[];if(C(n))return it(e,[n],[S(i)?i:""])[0];t=[];for(z in n)z=n[z],e.classList.contains(z)&&t.push(z);return Ge(t)?t:S(i)?i:[]}function rt(e,t){if(S(t)){t=xe(t);for(z in t)e.classList.remove(t[z])}else Pe(e,"class")}function at(e,t){t=xe(t);for(z in t)e.classList.toggle(t[z])}function ot(e,t,n){if(e=e||"div",e=C(e)?u.createElement(e):e,N(n))for(z in n)if(te=n[z],"classes"===z)nt(e,te);else if("data"===z)for(K in te)te=te[K],null===te?Ke(e,K):We(e,K,te);else"css"===z?C(te)?Ye(e,"style",te):null===te?Pe(e,"style"):l(e,te):L(te)?e[z]=te:null===te?Pe(e,z):Ye(e,z,v(te)?te.join(" "):""+te);if(T(t))yt(e,t);else if(N(t))for(z in t)te=t[z],T(te)?yt(e,te):te!==!1&&ut(e,te);else S(t)&&t!==!1&&ut(e,t);return e}function st(e){var t=e.id;return t||(t=Ft+"-dom:"+Math.floor(Date.now()*Math.random()),e.id=t),t}function ut(e,t){e.innerHTML=t}function ft(e,t){return e.innerHTML||(S(t)?t:"")}function ct(e,t){if((!S(t)||t)&&(M=ht(e)))for(z=0,K=Ge(M);K>z;++z)ct(M[z]);ut(e,"")}function lt(e){return Array.prototype.slice.call(e)}function dt(e){return e&&e.parentNode}function ht(e){return e&&lt(e.children||[])}function Et(e,t){return S(t)?C(t)?e.closest(t):tt(e,t):dt(e)}function pt(e){return e&&e.nextElementSibling}function At(e){return e&&e.previousElementSibling}function Ot(e){for(z=0;e=At(e);)++z;return z}function gt(e,t){return e&&C(t)?Ce(e.nodeName)===Ce(t):e&&L(t)?e===t(e):e===t}function It(e,t){return(t=S(t)?t:u)?C(e)?/^[#.]?(?:\\.|[\w-]|[^\x00-\xa0])+$/.test(e)?"#"===e[0]&&(e=t.getElementById(e.slice(1)))?[e]:"."===e[0]&&(e=t.getElementsByClassName(e.slice(1)))||(e=t.getElementsByTagName(e))?lt(e):[]:lt(t.querySelectorAll(e)):bt(e)?[e]:[]:[]}function bt(e,t){var n=dt(e);return 1===Ge(arguments)?n||!1:e&&n===e?n:!1}function Rt(e,t){V=dt(e),V&&V.insertBefore(t,e)}function Tt(e,t){V=dt(e),V&&V.insertBefore(t,pt(e))}function vt(e,t){M=e.firstChild,M?Rt(M,t):yt(e,t)}function Lt(e,t){yt(e,t)}function yt(e,t){e.appendChild(t)}function Nt(e,t){var n=dt(e);if(n){if(!S(t)||t)for(M=e.firstChild;M;)Nt(M);n.removeChild(e)}}function mt(e,t){return e.cloneNode(S(t)?!!t:!0)}function St(e,t){return dt(e).replaceChild(t,e),t}function Ct(e){ct(ot(e,!1,{style:""})),Nt(e)}function xt(e,t,n){return ot(t,n,{"class":e})}function an(e){return!e||S(e.active)&&!e.active}function on(e,t,n){return L(e)&&(e={click:e}),C(e.click)&&(e.click=(n[e.click]||{}).click),e.title=Gt[t]||"",S(e.attributes)||(e.attributes={}),n[t]&&(n[t]=e),e}function sn(e){Ut.exit(0,0,0);var t=ze(this,"tool-id"),n=Ut.tools,i=n[t];return Ut.drop.target=e.currentTarget||e.target,!an(i)&&L(K=i.click)&&(K=K(e,f,t),He("on:change",[e,f,t]),K===!1)?je(e):(f.select(),je(e))}function un(e){if(q=this,(j=e.TE.key)(/^(escape|f10)$/))Ut.exit(1);else if(j("enter")||j("arrowdown")&&ze(q,"ui-drop"))Ut.drop.target=q,Je(se,q,[e]);else if(j("arrowright")&&(Z=pt(q))){for(;!gt(Z,"a")&&Z;)Z=pt(Z);Z&&Z.focus()}else if(j("arrowleft")&&(Z=At(q))){for(;!gt(Z,"a")&&Z;)Z=At(Z);Z&&Z.focus()}return je(e)}function cn(){ct(Kt,0);var r,a,o,s,u,c,l,e=Ut.tools,t=xe(F.tools),n=Ft+"-button",i=Ft+"-separator";F.tools=t;for(c in t)l=t[c],a=e[l],(a||a==={})&&(a=on(a,l,e),o=a.i||l,"|"===o||ke(o,"<")||(o=Xe(o)),s="|"!==o,u=Xe(l).replace(/[\/\s]/g,"-"),nn=xt(s?n+" "+n+"-"+u:i+" "+i+"-"+c,s?"a":"span"),s?(nn=a.target||nn,r=n+":"+u,Ye(nn,{href:me,id:r,tabindex:-1}),We(nn,"tool-id",l),o=ke(o,"<")?o:Ut.i(u,o),an(a)?nt(nn,"x"):rt(nn,"x"),a.on?nt(nn,"on"):rt(nn,"on"),a.text&&(o=_e('<span class="'+Ft+'-text">'+a.text+"</span>",[o]),nt(nn,"text")),ut(nn,o),ot(nn,!1,a.attributes),!a.attributes.title&&(K=a.title)&&(nn.title=N(K)?K[0]+(K[1]?" ("+K[1]+")":""):K),Ze(se,nn,sn),Ze(de,nn,un)):nn.id=i+":"+c,a.target=nn,(u=ze(nn,fn))&&Ut.menu.set(l,u),yt(Kt,nn));He("update.tools",[f])}function ln(){Ut.keys=function(){var n,e=Fe(Ut.keys).sort().reverse(),t={};for(z=0,K=Ge(e);K>z;++z)n=e[z],t[n]=Ut.keys[n];return t}(),hn(),He("update.keys",[f])}function dn(e){function E(e){return e.replace(/\+/g,"\n").replace(/\n\n/g,"\n+").split("\n")}var n=f.$(),i=n.before,r=n.after,a=i.slice(-1),o=r[0],s=n.length,u=Ut.keys,c=TE.keys_alias,l={control:0,shift:0,option:"alt",meta:0},d=(i.match(/(?:^|\n)([\t ]*).*$/)||[""]).pop();for(z in l)e.TE[z]()&&(G[l[z]||z]=1);J=e.TE.key(),G[J]=1,t=we(G),O(function(){f.record()});for(z in u){j=E(z),M=0;for(K in j)K=j[K],G[c[K]||K]&&++M;if(j=Ge(j),M===j&&t===j&&(C(u[z])&&(u[z]=Ut.tools[u[z]].click),Z=L(u[z])&&u[z](e,f),Z===!1))return je(e)}if(Ie)for(z in Ie)if($=Ie[z],$!==!1){if(J===$&&o===$)return"\\"===a?(f.insert(J,0),je(e)):(f.select(n.end+1),je(e));if(z===J)return f.wrap(z,$),je(e);if(a===z&&o===$){if("backspace"===J&&i.slice(-2)!=="\\"+z)return f.unwrap(z,$),je(e);if(be&&"enter"===J&&z!==$&&!s)return f.tidy("\n"+d+Te,"\n"+d).scroll(1),je(e)}}if(be&&!s){if("backspace"===J&&p(h(Te)+"$").test(i))return f.outdent(Te),je(e);if("enter"===J&&p("(^|\\n)("+h(Te)+")+.*$").test(i))return f.insert("\n"+d,0,1).scroll(1),je(e)}}function hn(e){e&&e.TE&&e.TE.key?delete G[e.TE.key()]:G={}}function gn(e){return En=Ht,Q=et(zt),je(e)}function In(e){En===Ht&&l(jt,{height:Qe(Wt,e).y-Q.h+Se})}function bn(){En=0}function Rn(){Ut.exit(1)}function Tn(){t=et(Vt),ne=t.w,W=t.h,t=et(Jt),pn=t.w,An=t.h}function vn(e,t){return t&&He("exit.modal."+t,[f]),Je(se,Jt,[e]),je(e)}function Ln(e){En=e.target,t=Qe(Vt,e),ie=t.x,re=t.y,Tn()}function yn(e){var n=On.header,i=On.sizer;En===n||tt(En,n)===n?(t=Qe(Wt,e),Z=t.x-ie,q=t.y-re,l(Vt,{left:(ne>pn?Z:d(Z,0,pn-ne))+Se,top:(W>An?q:d(q,0,An-W))+Se})):En===i&&(t=Qe(Vt,e),Q=et(i),l(Vt,{width:t.x+Q.w/4+Se,height:t.y+Q.h/4+Se}))}function Nn(){En=0}function mn(e,t,n){return{header:e,body:t,footer:n}}function Sn(e){w=Ut.drop.target,D=_t,M=e&&e.target||0,(!M||M!==w&&tt(M,w)!==w)&&(Ut.drop.target=0,Ut.exit(M===jt))}var w,D,M,B,W,z,K,j,Z,$,J,t,V,X,Q,q,ee,te,ne,ie,re,n="⌘",i="…",a="⇥",o="⇧",s=window,u=document,f=new TE(e),c=f._,l=c.css,d=c.edge,h=c.x,E=c.extend,p=c.pattern,A=c.timer.reset,O=c.timer.set,g=c.trim,I={},b=function(){},R=TE.is,T=R.e,v=R.a,L=R.f,y=R.i,N=R.o,m=R.r,S=function(e){return!R.x(e)},C=R.s,x=u.documentElement,k=(u.head,u.body),F=E({tab:"  ",direction:"ltr",path:TE.path,resize:1,keys:1,tools:"indent outdent | undo redo",attributes:{spellcheck:"false"},union:[[["\\u003C","\\u003E","\\u002F"],["\\u003D","\\u0022","\\u0022","\\u0020"]],[["<",">","/"],["=",'"','"'," "]]],auto_tab:1,auto_close:{'"':'"',"'":"'","(":")","{":"}","[":"]","<":">"},languages:{tools:{tools:["Focus Tools","F10"],undo:["Undo",n+"+Z"],redo:["Redo",n+"+Y"],indent:["Indent",a],outdent:["Outdent",o+"+"+a]},buttons:{okay:"OK",cancel:"Cancel",yes:"Yes",no:"No",enter:"Enter",exit:"Exit",open:"Open",close:"Close",ignore:"Ignore"},placeholders:{"":"text here"+i},labels:{},others:{}},classes:{"":"text-editor",i:"text-editor-i text-editor-i-%1 text-editor-i-%1--%2 fa fa-%2"}},t),G={},oe="blur",se="click",de="keydown",he="keyup",Ee="touchstart mousedown",pe="touchmove mousemove",Ae="touchend mouseup",ge="orientationchange resize",Ie=F.auto_close,be=F.auto_tab,Re=F.languages,Te=F.tab,Le=(F.union[1][1],F.union[1][0]),ye=F.union[0][1],Ne=F.union[0][0],me="javascript:;",Se="px",Ut=f.ui={};f.tidy=function(e,t){var n=f.$(),i=g(n.before)?e:"",r=g(n.after)?S(t)?t:e:"";return f.trim(i,r)},f.i=function(){return g(f.replace(/\s+/g," "))},f.format=function(e,t,n,i){N(e)||(e=[e]),S(n)||(n=" "),S(i)||(i="");var r=f.h,a=f[0]().$(),o=e[0].split(p("("+ye[3]+")+"))[0],s=(e[0]?Le[0]+e[0]+Le[1]:"")+i,u=i+(e[0]?Le[0]+Le[2]+(e[1]||o)+Le[1]:""),c=h(e[0]?Le[0]+o+Le[1]:""),l=h(u),d=p("^"+c+"([\\s\\S]*?)"+l+"$"),E=p(c+"$"),A=p("^"+l),O=a.before,g=a.after;return a.length?n=!1:f.insert(Re.placeholders[""]),f.toggle(t?!d.test(a.value):!E.test(O)&&!A.test(g),[function(e){e.unwrap(s,u,1).tidy(p(Ne[0]+"[^"+Ne[0]+Ne[1]+Ne[2]+"]+?"+Ne[1]+"$").test(O)?"":n,p("^"+Ne[0]+Ne[2]+"[^"+Ne[0]+Ne[1]+"]+?"+Ne[1]).test(g)?"":n).wrap(s,u,t)},function(e){e.unwrap(s,u,t)}])[r]()};var nn,kt=F.classes,Ft=kt[""],Gt=Re.tools,wt=Re.buttons,Dt=Re.labels,Mt=Ft+"-textarea "+Ft+"-content block",Ht=xt(Ft+"-sizer s"),Yt=xt(Ft+"-sizer se"),Bt=xt(Ft),Pt=xt(Ft+"-header"),Wt=xt(Ft+"-body"),zt=xt(Ft+"-footer"),Kt=xt(Ft+"-tool"),jt=ot(e,!1,F.attributes),Zt=xt(Ft+"-description"),$t=ot(),Jt=ot(),Vt=ot(),_t=ot(),Xt=ot(),Qt=ot(),qt=xt("left","span"),en=xt("right","span"),tn=0;Ut.i=function(e,t,n){return e=Xe(e).replace(/[\/\s]/g,"-"),Q=_e(kt.i,[e,t||e]),n?(rt(n),nt(n,Q),n):'<i class="'+Q+'"></i>'},S(F.suffix)||(F.suffix=Le[1]);var fn="ui-drop-data",En=0,ie=0,re=0,ne=0,W=0,pn=0,An=0,On={};f.create=function(e,t){if(f.is.create)return f;f.is.create=!0,N(e)&&(F=E(F,e));var n=bt(jt);return nt(Bt,Ft+"-is-can-update"),nt(Bt,Ft+"-is-can-copy"),nt(jt,Mt),n&&gt(n,"p")?(Rt(n,Bt),tn=n,Nt(n,!1)):Rt(jt,Bt),Bt.dir=F.direction,yt(Bt,Pt),yt(Bt,Wt),yt(Bt,zt),yt(Wt,jt),F.tools&&(yt(Pt,Kt),yt(zt,Zt),yt(Zt,qt),yt(Zt,en)),Ze(de,jt,dn),Ze(he+" "+oe,jt,hn),F.resize&&(yt(Bt,Ht),nt(Bt,Ft+"-is-can-resize"),Ze(Ee,Ht,gn),Ze(pe,u,In),Ze(Ae,k,bn)),cn(),ln(),0!==t?He("create",[f]):f},f.update=function(e,t){return f.is.create&&f.destroy(0),(0!==t?He("update",[f]):f).create(e,0)},f.destroy=function(e){return f.is.create?(f.is.create=!1,Ut.exit(0,0,0),rt(jt,Mt),F.tools=Ue(F.tools),F.keys&&($e(de,jt,dn),$e(he,jt,hn)),F.resize&&($e(Ee,Ht,gn),$e(pe,u,In),$e(Ae,u,bn)),tn?(Rt(Bt,tn),yt(tn,jt),tn=0):Rt(Bt,jt),Ct(Bt),0!==e?He("destroy",[f]):f):f},f.enable=function(e){return jt.disabled=jt.readOnly=!1,nt(Bt,Ft+"-is-can-update"),nt(Bt,Ft+"-is-can-copy"),0!==e?He("enable",[f]):f},f.disable=function(e){return jt.disabled=!0,rt(Bt,Ft+"-is-can-update"),rt(Bt,Ft+"-is-can-copy"),0!==e?He("disable",[f]):f},f.freeze=function(e){return jt.disabled=!1,jt.readOnly=!0,rt(Bt,Ft+"-is-can-update"),nt(Bt,Ft+"-is-can-copy"),0!==e?He("freeze",[f]):f},Ut.exit=function(e,t,n){if(B={panel:function(){Ct($t)},overlay:function(){$e(se,Jt,Rn),Ct(Jt)},modal:function(){$e(se+" "+de,On.x,vn),$e(Ee,Wt,Ln),$e(pe,Wt,yn),$e(Ae,u,Nn),Ct(Vt)},drop:function(){$e(se,u,Sn),$e(ge,s,Sn),Ct(_t)},bubble:function(){Ct(Xt)}},hn(),t)if(N(t))for(z in t)z=t[z],B[z]&&B[z](),0!==n&&He("exit."+z,[f]);else B[t]&&B[t](),0!==n&&He("exit."+z,[f]);else for(z in B)B[z]();return e&&f.select(),0!==n&&He("exit",[f]),f},Ut.panel=function(e,t,n,i){function r(e){return $e(se+" "+de,ie,r),Ut.panel.exit(1),je(e)}return Ut.exit(0,0,0),Z=Xe(e),q=0,i&&(Z+=" "+Z+"--"+Xe(i)),N(t)&&!T(t)&&(q=xt(Ft+"-panel-header "+Z,0,t.header),t=t.body),ee=xt(Ft+"-panel-body "+Z,0,xt(Ft+"-panel-content "+Z,0,L(t)?"":t)),L(t)&&t(ee),ie=ot("a",!1,{href:me,"class":Ft+"-a "+Ft+"-x "+Z}),ie.title=wt.close,ot($t,!1,{"class":Ft+"-panel "+Z}),Ze(se+" "+de,ie,r),ct($t,0),q&&yt($t,q),yt(Wt,ot($t,[ee,ie])),L(n)?n($t):C(n)&&ot($t,n),w=[f,$t],i&&He("enter.panel."+e+":"+i,w),He("enter.panel."+e,w),He("enter.panel",w),He("enter",w),ie.focus(),f},Ut.panel.fit=function(){},Ut.overlay=function(e,t,n,i){return Ut.exit(0,0,0),Z=Xe(e),i&&(Z+=" "+Z+"--"+Xe(i)),yt(Wt,ot(Jt,!1,{"class":Ft+"-overlay "+Z})),t&&Ze(se,Jt,Rn),L(n)?n(Jt):C(n)&&ot(Jt,n),w=[f,Jt],i&&He("enter.overlay."+e+":"+i,w),He("enter.overlay."+e,w),He("enter.overlay",w),He("enter",w),f},Ut.overlay.fit=function(){},Ut.message=function(e,t,n,i,r){function o(e){return $e(se+" "+de,ie,o),A(a),Ut.overlay.exit(1),je(e)}var a;return Z=Xe(e),r&&(Z+=" "+Z+"--"+Xe(r)),ie=ot("a",!1,{href:me,"class":Ft+"-a "+Ft+"-x "+Z}),ie.title=wt.close,ot(Qt,L(t)?t(Qt):t,{"class":Ft+"-message "+Z}),Ze(se+" "+de,ie,o),Ut.overlay("message message-"+Z,0,function(e){yt(Qt,ie),n&&(a=O(function(){o()},n)),yt(e,Qt)},r),L(i)?i(Qt):C(i)&&ot(Qt,i),f},Ut.modal=function(){var s,c,e=arguments,t=e[0],n=e[1],i=e[2],r=e[3],a=Ft+"-modal",o=n.footer;if(N(t)&&(t="default",n=e[0],i=e[1],r=e[2]),Ut.overlay(t,1,0,r).blur(),Z=Xe(t),r&&(Z+=" "+Z+"--"+Xe(r)),ot(Vt,!1,{"class":a+" "+Z}),S(n.body)&&(n.body=ot("div",n.body,{"class":a+"-content "+Z})),S(o)&&N(o)&&!T(o)){c=[];for(z in o)K=o[z],T(K)?c.push(K):(K=on(K,z,o),j=z.text||wt[z]||z,s=ot("button",j,E({name:"y["+z+"]",type:"button","class":Ft+"-button",data:{"button-id":z}},K.attributes)),Ze(se,s,function(e){return j=o[ze(this,"button-id")].click(e,f),j===!1?je(e):void 0}),c.push(s));n.footer=c}for(z in n)a[1]=z,On[z]=xt(a+"-"+_e(z,a)+" "+Z,0,n[z]);return On.x=ot("a",!1,{href:me,"class":Ft+"-a "+Ft+"-x "+Z}),On.sizer=Yt,ct(Vt,0),On.x.title=wt.close,yt(Wt,ot(Vt,On,{style:""})),Ut.modal.fit(),Tt(Vt,Jt),Ze(se+" "+de,On.x,vn),Ze(Ee,On.header,je),Ze(Ee,On.sizer,je),Ze(Ee,Wt,Ln),Ze(pe,Wt,yn),Ze(Ae,u,Nn),L(i)&&i(On),w=[f,Vt,On],r&&He("enter.modal."+t+":"+r,w),He("enter.modal."+t,w),He("enter.modal",w),He("enter",w),On.x.focus(),f},Ut.modal.fit=function(e){return Tn(),Z=pn/2-ne/2,q=An/2-W/2,N(e)?(S(e[0])&&(Z=e[0]),S(e[1])&&(q=e[1])):(Z=d(Z,0),q=d(q,0)),l(Vt,{left:Z+Se,top:q+Se,"min-width":ne+Se,"min-height":W+Se,visibility:"visible"}),w=[f,Vt,On],He("fit.modal",w),He("fit",w),f};var Cn={"class":Ft+"-button",name:"y"};return Ut.alert=function(e,t,n,i,r){var a=ot("button",wt.okay,Cn),o="alert";return n=n||b,N(e)&&(o+=":"+e[0],e=e[1]||e[0]),Ze(se,a,function(e){return n(e,f),vn(e,o+".y")}),Ze(de,a,function(e){var t=e.TE.key;return t(/^(escape|enter)$/)&&Je(se,a,[e]),je(e)}),Ut.modal(o,mn(e,t,a),i,r),a.focus(),f},Ut.confirm=function(e,t,n,i,r,a){function l(e){return L(n)&&n(e,f),vn(e,u+".y")}function d(e){return L(i)&&i(e,f),vn(e,u+".n")}var c,o=ot("button",wt.okay,Cn),s=ot("button",wt.cancel,Cn),u="confirm";return s.name="n",Ze(se,o,l),Ze(se,s,d),Ze(de,o,function(e){return c=e.TE.key,c("arrowright")?s.focus():c("enter")?l(e):c("escape")&&vn(e,u+".y"),je(e)}),Ze(de,s,function(e){return c=e.TE.key,c("arrowleft")?o.focus():c("enter")?d(e):c("escape")&&vn(e,u+".n"),je(e)}),Ut.modal(u,mn(e,t,[o,s]),r,a),s.focus(),f},Ut.prompt=function(e,t,n,i,r,a,o){function A(){c.focus(),"placeholder"in c&&c.select()}function O(e){return h=c.value,L(n)&&!n(h)?A():!n||g(h)&&h!==t?(vn(e,l+".y"),i(e,f,h!==t?h:"",t)):A(),je(e)}function I(e){return vn(e,l+".n")}var h,E,p,s=ot("button",wt.okay,Cn),u=ot("button",wt.cancel,Cn),c=ot("input",!1,{type:"text",value:t,placeholder:t,spellcheck:"false","class":Ft+"-input block"}),l="prompt",d=[];if(r=r||0,1===r)c=ot("textarea",t,{placeholder:t.split("\n")[0],"class":Ft+"-textarea block",spellcheck:"false"});else if(2===r){for(z in t)d.push(ot("option",t[z],{value:z,selected:z===n||null}));c=ot("select",d,{"class":Ft+"-select block"})}return i=i||b,c.name="data",u.name="n",Ze(de,c,function(e){return E=e.TE.key,p=e.TE.control,E("enter")&&0===r||p("enter")?O(e):E("escape")||E("backspace")&&!this.value?I(e):E("arrowdown")&&0===r||E("enter")&&2===r||p("arrowdown")?(s.focus(),je(e)):void 0}),Ze(de,s,function(e){return E=e.TE.key,E("enter")?O(e):E("escape")?I(e):E("arrowup")?c.focus():E("arrowright")&&u.focus(),je(e)}),Ze(de,u,function(e){return E=e.TE.key,E(/^(enter|escape)$/)?I(e):E("arrowup")?c.focus():E("arrowleft")&&s.focus(),je(e)}),Ze(se,s,O),Ze(se,u,I),Ut.modal(l,mn(e,c,[s,u]),a,o),A(),f},Ut.drop=function(){Ut.exit(0,0,0);var e=arguments,t=e[0],n=e[1],i=e[2];return 1===Ge(e)&&(t="default",n=e[0],i=e[1]),Z=Xe(t),ct(_t,0),yt(k,ot(_t,!1,{"class":Ft+"-drop "+Z})),L(n)?n(_t):ot(_t,n),Ut.drop.fit(),i===!1||(Ze(se,u,Sn),Ze(ge,s,Sn)),w=[f,_t],He("enter.drop."+t,w),He("enter.drop",w),f},Ut.drop.fit=function(e){return w=et(x),D=et(_t),M=Ut.drop.target,Z=w.w/2-D.w/2,q=w.h/2-D.h/2,!S(e)&&M&&(t=qe(M),Z=t.l,q=t.t+et(M).h),N(e)?(S(e[0])&&(Z=e[0]),S(e[1])&&(q=e[1])):(Z=d(Z,0,w.w-D.w),q=d(q,0,Math.max(w.h,et(s).h)-D.h)),l(_t,{left:Z+Se,top:q+Se,visibility:"visible"}),w=[f,_t],He("fit.drop",w),He("fit",w),f},Ut.menu=function(e,n,i,r){var s,a=Ut.tools,o=0;if(n===!1)return Ut.tool(e,n);for(r in i)ne="%"===r[0],s=i[r],s=C(s)&&!ne?a[s]:s,s&&(s=on(s,r,a),i[r]=s);return Ut.tool(e,{i:N(n)?n[0]:0,text:N(n)?n[1]||0:n&&i[n]&&i[n].text||n,click:function(u){var c=Ut.drop.target=a[e].target;return Ut.drop("menu menu-"+Xe(e),function(u){function l(o){return q=this,t=ze(q,"tool-id"),$=i[t],$=C($)?a[$]:$||{},J=ft(q),!an($)&&L(r=$.click)&&(r=r(o,f),$.i&&(a[e].i=$.i),Ut.menu.set(e,N($.text)?[$.text[0],t]:N(n)?[n[0],t]:t),r===!1)?(f.select(),je(o)):(f.select(),je(o))}function d(e){if(q=this,(j=e.TE.key)("escape"))Ut.exit(1);else if(j("enter"))Je(se,q,[e]);else if(j("f10")&&c)c.focus();else if(j("arrowdown")&&(Z=pt(q))){for(;!gt(Z,"a")&&Z;)Z=pt(Z);Z&&Z.focus()}else if(j("arrowup")&&(Z=At(q))){for(;!gt(Z,"a")&&Z;)Z=At(Z);!Z&&c?(Ut.exit(),c.focus()):Z&&Z.focus()}else j("arrowup")&&c&&(Ut.exit(),c.focus());return je(e)}for(r in i)if(s=i[r],ne="%"===r[0],s){var h={href:ne?null:me,"class":Ft+"-"+(ne?"label":"button")};ne?K=Dt[e]&&Dt[e][+r.slice(1)-1]||r:(h.data={},h.data["tool-id"]=r,K=Gt[r]||r),X=s.text,X=N(X)?X[1]||"":X,K=N(K)?K[0]:K,Q=ot(ne?"span":"a","<span>"+(ne?K||"%"+o:X||K)+"</span>",E(h,s.attributes||{})),nt(Q,"menu-"+Xe(r).replace(/[\/\s]/g,"-")),!h.title&&(q=s.title)&&(Q.title=N(q)?q[0]+(q[1]?" ("+q[1]+")":""):q),ne?Ye(Q,{id:Ft+"-label:"+o}):(an(s)?nt(Q,"x"):rt(Q,"x"),s.on?nt(Q,"on"):rt(Q,"on"),Ze(se,Q,l),Ze(de,Q,d)),yt(u,Q),++o}O(function(){(It('[data-tool-id="'+ze(c,fn)+'"]',u)[0]||It("a",u)[0]).focus()},1)}),!1}},r),We(a[e].target,{"ui-drop":e}),a[e].data=i,Ut.menu.set(e,n)},Ut.menu.set=function(e,t){var a,o,n=Ut.tools[e]||{},i=n.target,r=n.data;return i?(N(t)?We(i,fn,t[1]||""):(We(i,fn,t),t=r[t]&&r[t].text||t),N(t)?(o=t[0],o=ke(o,"<")?o:Ut.i(o,n.i),t=S(t[1])?t[1]:0,t=t&&r[t]&&r[t].text||t,t=o+(0!==t?"<span>"+(N(t)?t[1]||t:t)+"</span>":"")):o=Ut.i(e,n.i),(a=It("."+Ft+"-text",i)[0])?(nt(i,"text"),ut(a,t)):(rt(i,"text"),ut(i,o)),f):f},Ut.bubble=function(){Ut.exit(0,0,0);var e=arguments,t=e[0],n=e[1];return 1===Ge(e)&&(t="default",n=e[0]),Z=Xe(t),ct(Xt,0),yt(k,ot(Xt,!1,{"class":Ft+"-bubble "+Z})),L(n)?n(Xt):ot(Xt,n),Ut.bubble.fit(),w=[f,Xt],He("enter.bubble."+t,w),He("enter.bubble",w),f},Ut.bubble.fit=function(e){Q=f.$(1),t=qe(jt),W=l(jt,"line-height");var n="border-",i="-width";Z=Q.caret[0].x+t.l-jt.scrollLeft,q=Q.caret[1].y+t.t+W-jt.scrollTop,D=l(Wt,[n+"top"+i,n+"bottom"+i,n+"left"+i,n+"right"+i]);var r=et(Wt),a=et(Xt),o=D[0]+D[1],s=D[2]+D[3];return N(e)?(S(e[0])&&(Z=e[0]),S(e[1])&&(q=e[1])):(Z=d(Z,t.l,t.l+r.w-a.w-s),q=d(q,t.t,t.t+r.h-a.h-o)),l(Xt,{left:Z+Se,top:q+Se,visibility:"visible"}),w=[f,Xt],He("fit.bubble",w),He("fit",w),f},Ut.panel.exit=function(e){return Ut.exit(e,"panel")},Ut.overlay.exit=function(e){return Ut.exit(e,"overlay")},Ut.modal.exit=function(e){return Ut.exit(e,"modal")},Ut.drop.exit=function(e){return Ut.exit(e,"drop")},Ut.bubble.exit=function(e){return Ut.exit(e,"bubble")},Ut.tool=function(e,t,n){var i=Ut.tools;return K="",j=S(i[e])?"update":"create","|"!==e&&(F.tools=xe(F.tools).filter(function(t,n){return t===e?(K=n,!1):!0})),t===!1?(delete i[e],j="destroy"):("|"===e?(n=t,t={}):(L(t)&&(t={click:t}),i[e]=E(i[e]||{},t),S(n)||""===K||(n=K)),y(n)?F.tools.splice(n,0,e):F.tools.push(e)),He(j+".tool."+e,[f,i[e]]),cn(),f},Ut.separator=function(e,t){return Ut.tool("|",e!==!1?{attributes:e||{}}:!1,t)},Ut.key=function(e,t){var n=Ut.keys;return j=S(n[e])?"update":"create",t===!1?(delete n[e],j="destroy"):n[e]=t,He(j+".key."+e,[f,n[e]]),ln(),f},Ut.key.set=function(e){G[e]=1},Ut.key.reset=function(e){e?delete G[e]:G={}},Ut.tools={"|":{},undo:{i:"undo",click:function(e,t){return t.undo(),!1}},redo:{i:"repeat",click:function(e,t){return t.redo(),!1}},indent:function(e,t){return t.indent(Te),!1},outdent:function(e,t){return t.outdent(Te),!1}},Ut.keys={"control+y":"redo","control+z":"undo",escape:function(e,t){return X=":not([tabindex]):not([disabled])",(Q=It("input"+X+",button"+X+",select"+X+",textarea"+X+",a[href]"+X+",[contenteditable]"+X+',[tabindex]:not([tabindex="-1"])',u,0))&&-1!==(q=Q.indexOf(jt))?((Q[q+1]||u).focus(),!1):void 0},f10:function(e,t){return It("a",Kt)[0].focus(),!1},tab:be?"indent":0,"shift+tab":be?"outdent":0},Ut.el={container:Bt,header:Pt,body:Wt,footer:zt,panel:$t,overlay:Jt,modal:Vt,drop:_t,bubble:Xt},f.config=F,E(TE._,{time:function(e){var t=new Date(S(e)?e:Date.now()),n=t.getFullYear(),i=t.getMonth()+1,r=t.getDate(),a=t.getHours(),o=t.getMinutes(),s=t.getSeconds(),u=t.getMilliseconds();return 10>i&&(i="0"+i),10>r&&(r="0"+r),10>a&&(a="0"+a),10>o&&(o="0"+o),10>s&&(s="0"+s),10>u&&(u="0"+u),[""+n,""+i,""+r,""+a,""+o,""+s,""+u]},replace:Ve,format:_e,dom:{set:yt,reset:Nt,get:It,id:st,copy:mt,replace:St,classes:{set:nt,reset:rt,toggle:at,get:it},attributes:{set:Ye,reset:Pe,get:Be},data:{set:We,reset:Ke,get:ze},is:gt,offset:qe,pointer:Qe,size:et,content:{set:ut,reset:ct,get:ft},closest:tt,parent:dt,children:ht,closest:Et,next:pt,previous:At,index:Ot,before:Rt,after:Tt,prepend:vt,append:Lt},el:ot,events:{set:Ze,reset:$e,fire:Je,x:je}}),E(f._,TE._),E(f._,{hooks:{set:De,reset:Me,fire:He}}),f.create()};