/*!
 * ==========================================================
 *  USER INTERFACE MODULE FOR TEXT EDITOR PLUGIN 1.8.2
 * ==========================================================
 * Author: Taufik Nurrohman <https://github.com/tovic>
 * License: MIT
 * ----------------------------------------------------------
 */
TE.ui=function(n,e){function Dn(n){return S(n)?x(n).split(/\s+/):n}function Hn(n){return M(n)?n.join(" "):n}function jn(n,e){return-1!==n.indexOf(e)}function Nn(n){return Object.keys(n)}function On(n){return n.length}function kn(n){return On(Nn(n))}function Bn(n,e,t){return C(n)?C(e)?(C(y[n])||(y[n]={}),C(t)||(t=kn(y[n])),y[n][t]=e,s):y[n]:y}function _n(n,e){return C(n)?C(e)&&C(y[n])?(delete y[n][e],s):(y[n]={},s):(y={},s)}function In(n,e,t){if(!C(y[n]))return y[n]={},s;if(C(t))C(y[n][t])&&y[n][t].apply(s,e);else for(Z in y[n])y[n][Z].apply(s,e);return s}function Rn(n,e,t){if(M(e))for(Z in e)Rn(n,Z,e[Z]);else n[(null===t?"remove":"set")+"Attribute"](e,t)}function zn(n,t,r){if(!t){for(e={},Z=0,q=n.attributes,V=On(q);V>Z;++Z)Y=q[Z],e[Y.name]=Y.value;return kn(e)?e:C(r)?r:{}}if(S(t))return zn(n,[t],[C(r)?r:""])[0];e=[];for(Z in t)Z=t[Z],(Z=n.getAttribute(Z))&&e.push(Z);return On(e)?e:C(r)?r:[]}function Pn(n,e){if(M(e))for(Z in e)Pn(n,e[Z]);else if(C(e))n.removeAttribute(e);else for(Pn(n,"class"),Z=0,q=n.attributes,V=On(q);V>Z;++Z)q[Z]&&Pn(n,q[Z].name)}function Un(n,e,t){if(M(e))for(Z in e)Un(n,Z,e[Z]);else Rn(n,"data-"+e,t)}function Zn(n,t,r){if(!t){for(e={},Z=0,q=n.attributes,V=On(q);V>Z;++Z)Y=q[Z],"data-"===Y.name.slice(0,5)&&(e[Y.name]=Y.value);return kn(e)?e:C(r)?r:{}}if(S(t))return Zn(n,[t],[C(r)?r:""])[0];e=[];for(Z in t)Z=t[Z],(Z=zn(n,"data-"+Z))&&e.push(Z);return On(e)?e:C(r)?r:[]}function qn(n,e){if(M(e))for(Z in e)Pn(n,"data-"+e[Z]);else if(C(e))Pn(n,"data-"+e);else for(Z=0,q=n.attributes,V=On(q);V>Z;++Z)q[Z]&&"data-"===q[Z].name.slice(0,5)&&Pn(n,q[Z].name)}function Vn(n){return n&&n.preventDefault(),!1}function Yn(n,e,t){if(e){for(n=Dn(n),Z=0,q=On(n);q>Z;++Z)e.addEventListener(n[Z],t,!1),Bn("on:"+n[Z],t,ce(e));return s}}function Wn(n,e,t){if(e){for(n=Dn(n),Z=0,q=On(n);q>Z;++Z)e.removeEventListener(n[Z],t,!1),_n("on:"+n[Z],ce(e));return w(e)&&e.id.split(":")[0]===je+"-dom"&&Pn(e,"id"),s}}function Xn(n,e,t){n=Dn(n);var i,r="createEvent"in c;for(Z=0,q=On(n);q>Z;++Z)r?(i=c.createEvent("HTMLEvents"),i.data=t,i.initEvent(n[Z],!0,!1),e.dispatchEvent(i)):In("on:"+n[Z],t,ce(e));return s}function Kn(n,e,t){for(Z=0,q=On(e),V;q>Z;++Z)V=e[Z],n=n.replace(T(V)?V:g(p(V),"g"),t&&t[Z]||"");return n}function Gn(n,e){return n.replace(/%(\d+)/g,function(n,t){return--t,C(e[t])?e[t]:n})}function Jn(n){return x(Kn(n.toLowerCase(),[/[^ \/a-z\d-]/g,/([ -])+/g,/^-|-$/g],["-","$1",""]))}function Qn(n,e){var t=e.touches?e.touches[0].pageX:e.pageX,r=e.touches?e.touches[0].pageY:e.pageY,i=ne(n);return{x:t-i.l,y:r-i.t}}function ne(n){for(Y=n.offsetLeft,nn=n.offsetTop;n=n.offsetParent;)Y+=n.offsetLeft,nn+=n.offsetTop;return{l:Y,t:nn}}function ee(n){return n===o?{w:n.innerWidth,h:n.innerHeight}:{w:n.offsetWidth,h:n.offsetHeight}}function te(n,e){for(;(n=de(n))&&n!==e;);return n}function re(n,e){e=Dn(e);for(Z in e)n.classList.add(e[Z])}function ie(n,t,r){if(!t)return e=Dn(n.className),On(e)?e:C(r)?r:[];if(S(t))return ie(n,[t],[C(r)?r:""])[0];e=[];for(Z in t)Z=t[Z],n.classList.contains(Z)&&e.push(Z);return On(e)?e:C(r)?r:[]}function ue(n,e){if(C(e)){e=Dn(e);for(Z in e)n.classList.remove(e[Z])}else Pn(n,"class")}function fe(n,e){e=Dn(e);for(Z in e)n.classList.toggle(e[Z])}function oe(n,e,t){if(n=n||"div",n=S(n)?c.createElement(n):n,M(t))for(Z in t)if(tn=t[Z],"classes"===Z)re(n,tn);else if("data"===Z)for(q in tn)tn=tn[q],null===tn?qn(n,q):Un(n,q,tn);else"css"===Z?S(tn)?Rn(n,"style",tn):null===tn?Pn(n,"style"):a(n,tn):L(tn)?n[Z]=tn:null===tn?Pn(n,Z):Rn(n,Z,F(tn)?tn.join(" "):""+tn);if(w(e))Ae(n,e);else if(M(e))for(Z in e)tn=e[Z],w(tn)?Ae(n,tn):tn!==!1&&se(n,tn);else C(e)&&e!==!1&&se(n,e);return n}function ce(n){var e=n.id;return e||(e=je+"-dom:"+Math.floor(Date.now()*Math.random()),n.id=e),e}function se(n,e){n.innerHTML=e}function le(n,e){return n.innerHTML||(C(e)?e:"")}function ae(n,e){if((!C(e)||e)&&(_=pe(n)))for(Z=0,q=On(_);q>Z;++Z)ae(_[Z]);se(n,"")}function de(n){return n&&n.parentNode}function pe(n){return n&&n.children||[]}function me(n,e){return C(e)?S(e)?n.closest(e):te(n,e):de(n)}function ge(n){return n&&n.nextSibling}function he(n){return n&&n.previousSibling}function ve(n){for(Z=0;n=he(n);)++Z;return Z}function xe(n,e){return n&&S(e)?n.nodeName.toLowerCase()===e.toLowerCase():n&&L(e)?n===e(n):n===e}function ye(n,t){if(!(t=C(t)?t:c))return[];if(e=[],S(n)){if(/^[#.]?(?:\\.|[\w-]|[^\x00-\xa0])+$/.test(n)){if("#"===n[0]&&(n=t.getElementById(n.slice(1))))return[n];if("."===n[0]&&(n=t.getElementsByClassName(n.slice(1)))||(n=t.getElementsByTagName(n))){for(Z=0,q=On(n);q>Z;++Z)e.push(n[Z]);return e}return[]}for(n=t.querySelectorAll(n),Z=0,q=On(n);q>Z;++Z)e.push(n[Z]);return e}return Ee(n)?[n]:[]}function Ee(n,e){var t=de(n);return 1===On(arguments)?t||!1:n&&t===n?t:!1}function be(n,e){K=de(n),K&&K.insertBefore(e,n)}function we(n,e){K=de(n),K&&K.insertBefore(e,ge(n))}function Fe(n,e){_=pe(n)[0],_?be(_,e):Ae(n,e)}function Le(n,e){Ae(n,e)}function Ae(n,e){n.appendChild(e)}function Me(n,e){var t=Ee(n);if(t){if(!C(e)||e)for(_=pe(n)[0];_;)Me(_);t.removeChild(n)}}function Te(n,e){return n.cloneNode(C(e)?!!e:!0)}function Ce(n,e){return de(n).replaceChild(e,n),e}function Se(n){ae(oe(n,!1,{style:""})),Me(n)}function $e(n,e,t){return oe(e,t,{"class":n})}function it(n){return!n||C(n.active)&&!n.active}function ut(n,e,t){return L(n)&&(n={click:n}),S(n.click)&&(n.click=(t[n.click]||{}).click),n.title=Ne[e]||"",C(n.attributes)||(n.attributes={}),t[e]&&(t[e]=n),n}function ft(n){De.exit(0,0,0);var e=Zn(this,"tool-id"),t=De.tools,r=t[e];return De.drop.target=n.currentTarget||n.target,!it(r)&&L(q=r.click)&&(q=q(n,s,e),In("on:change",[n,s,e]),q===!1)?Vn(n):(s.select(),Vn(n))}function ot(n){if(nn=this,(V=n.TE.key)(/^(escape|f10)$/))De.exit(1);else if(V("enter")||V("arrowdown")&&Zn(nn,"ui-drop"))De.drop.target=nn,Xn(sn,nn,[n]);else if(V("arrowright")&&(Y=ge(nn))){for(;!xe(Y,"a")&&Y;)Y=ge(Y);Y&&Y.focus()}else if(V("arrowleft")&&(Y=he(nn))){for(;!xe(Y,"a")&&Y;)Y=he(Y);Y&&Y.focus()}return Vn(n)}function st(){ae(Ze,0);var i,u,f,o,c,l,a,n=De.tools,e=Dn(N.tools),t=je+"-button",r=je+"-separator";N.tools=e;for(l in e)a=e[l],u=n[a],(u||u==={})&&(u=ut(u,a,n),f=u.i||a,"|"===f||jn(f,"<")||(f=Jn(f)),o="|"!==f,c=Jn(a).replace(/[\/\s]/g,"-"),tt=$e(o?t+" "+t+"-"+c:r+" "+r+"-"+l,o?"a":"span"),o?(tt=u.target||tt,i=t+":"+c,Rn(tt,{href:Sn,id:i,tabindex:-1}),Un(tt,"tool-id",a),f=jn(f,"<")?f:De.i(c,f),it(u)?re(tt,"x"):ue(tt,"x"),u.on?re(tt,"on"):ue(tt,"on"),u.text&&(f=Gn('<span class="'+je+'-text">'+u.text+"</span>",[f]),re(tt,"text")),se(tt,f),oe(tt,!1,u.attributes),!u.attributes.title&&(q=u.title)&&(tt.title=M(q)?q[0]+(q[1]?" ("+q[1]+")":""):q),Yn(sn,tt,ft),Yn(mn,tt,ot)):tt.id=r+":"+l,u.target=tt,(c=Zn(tt,ct))&&De.menu.set(a,c),Ae(Ze,tt));In("update.tools",[s])}function lt(){De.keys=function(){var t,n=Nn(De.keys).sort().reverse(),e={};for(Z=0,q=On(n);q>Z;++Z)t=n[Z],e[t]=De.keys[t];return e}(),dt(),In("update.keys",[s])}function at(n){function m(n){return n.replace(/\+/g,"\n").replace(/\n\n/g,"\n+").split("\n")}var t=s.$(),r=t.before,i=t.after,u=r.slice(-1),f=i[0],o=t.length,c=De.keys,l=TE.keys_alias,a={control:0,shift:0,option:"alt",meta:0},d=(r.match(/(?:^|\n)([\t ]*).*$/)||[""]).pop();for(Z in a)n.TE[Z]()&&(O[a[Z]||Z]=1);X=n.TE.key(),O[X]=1,e=kn(O),v(function(){s.record()});for(Z in c){V=m(Z),_=0;for(q in V)q=V[q],O[l[q]||q]&&++_;if(V=On(V),_===V&&e===V&&(S(c[Z])&&(c[Z]=De.tools[c[Z]].click),Y=L(c[Z])&&c[Z](n,s),Y===!1))return Vn(n)}if(bn)for(Z in bn)if(W=bn[Z],W!==!1){if(X===W&&f===W)return"\\"===u?(s.insert(X,0),Vn(n)):(s.select(t.end+1),Vn(n));if(Z===X)return s.wrap(Z,W),Vn(n);if(u===Z&&f===W){if("backspace"===X&&r.slice(-2)!=="\\"+Z)return s.unwrap(Z,W),Vn(n);if(wn&&"enter"===X&&Z!==W&&!o)return s.tidy("\n"+d+Ln,"\n"+d).scroll(1),Vn(n)}}if(wn&&!o){if("backspace"===X&&g(p(Ln)+"$").test(r))return s.outdent(Ln),Vn(n);if("enter"===X&&g("(^|\\n)("+p(Ln)+")+.*$").test(r))return s.insert("\n"+d,0,1).scroll(1),Vn(n)}}function dt(n){n&&n.TE&&n.TE.key?delete O[n.TE.key()]:O={}}function vt(n){return pt=_e,Q=ee(Ue),Vn(n)}function xt(n){pt===_e&&a(qe,{height:Qn(Pe,n).y-Q.h+$n})}function yt(){pt=0}function Et(){De.exit(1)}function bt(){e=ee(Xe),rn=e.w,U=e.h,e=ee(We),mt=e.w,gt=e.h}function wt(n,e){return e&&In("exit.modal."+e,[s]),Xn(sn,We,[n]),Vn(n)}function Ft(n){pt=n.target,e=Qn(Xe,n),un=e.x,fn=e.y,bt()}function Lt(n){var t=ht.header,r=ht.sizer;pt===t||te(pt,t)===t?(e=Qn(Pe,n),Y=e.x-un,nn=e.y-fn,a(Xe,{left:(rn>mt?Y:d(Y,0,mt-rn))+$n,top:(U>gt?nn:d(nn,0,gt-U))+$n})):pt===r&&(e=Qn(Xe,n),Q=ee(r),a(Xe,{width:e.x+Q.w/4+$n,height:e.y+Q.h/4+$n}))}function At(){pt=0}function Mt(n,e,t){return{header:n,body:e,footer:t}}function Tt(n){k=De.drop.target,B=Ke,_=n&&n.target||0,(!_||_!==k&&te(_,k)!==k)&&(De.drop.target=0,De.exit(_===qe))}var k,B,_,z,U,Z,q,V,Y,W,X,e,K,J,Q,nn,en,tn,rn,un,fn,t="⌘",r="…",u="⇥",f="⇧",o=window,c=document,s=new TE(n),l=s._,a=l.css,d=l.edge,p=l.x,m=l.extend,g=l.pattern,h=l.timer.reset,v=l.timer.set,x=l.trim,y={},E=function(){},b=TE.is,w=b.e,F=b.a,L=b.f,A=b.i,M=b.o,T=b.r,C=function(n){return!b.x(n)},S=b.s,$=c.documentElement,H=(c.head,c.body),N=(c.currentScript,m({tab:"  ",direction:"ltr",path:TE.path,resize:1,keys:1,tools:"indent outdent | undo redo",attributes:{spellcheck:"false"},union:[[["\\u003C","\\u003E","\\u002F"],["\\u003D","\\u0022","\\u0022","\\u0020"]],[["<",">","/"],["=",'"','"'," "]]],auto_tab:1,auto_close:{'"':'"',"'":"'","(":")","{":"}","[":"]","<":">"},languages:{tools:{tools:["Focus Tools","F10"],undo:["Undo",t+"+Z"],redo:["Redo",t+"+Y"],indent:["Indent",u],outdent:["Outdent",f+"+"+u]},buttons:{okay:"OK",cancel:"Cancel",yes:"Yes",no:"No",enter:"Enter",exit:"Exit",open:"Open",close:"Close",ignore:"Ignore"},placeholders:{"":"text here"+r},labels:{},others:{}},classes:{"":"text-editor",i:"text-editor-i text-editor-i-%1 text-editor-i-%1--%2 fa fa-%2"}},e)),O={},cn="blur",sn="click",mn="keydown",gn="keyup",hn="touchstart mousedown",vn="touchmove mousemove",xn="touchend mouseup",En="orientationchange resize",bn=N.auto_close,wn=N.auto_tab,Fn=N.languages,Ln=N.tab,Mn=(N.union[1][1],N.union[1][0]),Tn=N.union[0][1],Cn=N.union[0][0],Sn="javascript:;",$n="px",De=s.ui={};s.tidy=function(n,e){var t=s.$(),r=x(t.before)?n:"",i=x(t.after)?C(e)?e:n:"";return s.trim(r,i)},s.i=function(){return x(s.replace(/\s+/g," "))},s.format=function(n,e,t,r){M(n)||(n=[n]),C(t)||(t=" "),C(r)||(r="");var i=s.h,u=s[0]().$(),f=n[0].split(g("("+Tn[3]+")+"))[0],o=(n[0]?Mn[0]+n[0]+Mn[1]:"")+r,c=r+(n[0]?Mn[0]+Mn[2]+(n[1]||f)+Mn[1]:""),l=p(n[0]?Mn[0]+f+Mn[1]:""),a=p(c),d=g("^"+l+"([\\s\\S]*?)"+a+"$"),m=g(l+"$"),h=g("^"+a),v=u.before,x=u.after;return u.length?t=!1:s.insert(Fn.placeholders[""]),s.toggle(e?!d.test(u.value):!m.test(v)&&!h.test(x),[function(n){n.unwrap(o,c,1).tidy(g(Cn[0]+"[^"+Cn[0]+Cn[1]+Cn[2]+"]+?"+Cn[1]+"$").test(v)?"":t,g("^"+Cn[0]+Cn[2]+"[^"+Cn[0]+Cn[1]+"]+?"+Cn[1]).test(x)?"":t).wrap(o,c,e)},function(n){n.unwrap(o,c,e)}])[i]()};var tt,He=N.classes,je=He[""],Ne=Fn.tools,Oe=Fn.buttons,ke=Fn.labels,Be=je+"-textarea "+je+"-content block",_e=$e(je+"-sizer s"),Ie=$e(je+"-sizer se"),Re=$e(je),ze=$e(je+"-header"),Pe=$e(je+"-body"),Ue=$e(je+"-footer"),Ze=$e(je+"-tool"),qe=oe(n,!1,N.attributes),Ve=$e(je+"-description"),Ye=oe(),We=oe(),Xe=oe(),Ke=oe(),Ge=oe(),Je=oe(),Qe=$e("left","span"),nt=$e("right","span"),et=0;De.i=function(n,e,t){return n=Jn(n).replace(/[\/\s]/g,"-"),Q=Gn(He.i,[n,e||n]),t?(ue(t),re(t,Q),t):'<i class="'+Q+'"></i>'},C(N.suffix)||(N.suffix=Mn[1]);var ct="ui-drop-data",pt=0,un=0,fn=0,rn=0,U=0,mt=0,gt=0,ht={};s.create=function(n,e){if(s.is.create)return s;s.is.create=!0,M(n)&&(N=m(N,n));var t=Ee(qe);return re(Re,je+"-is-can-update"),re(Re,je+"-is-can-copy"),re(qe,Be),t&&xe(t,"p")?(be(t,Re),et=t,Me(t,!1)):be(qe,Re),Re.dir=N.direction,Ae(Re,ze),Ae(Re,Pe),Ae(Re,Ue),Ae(Pe,qe),N.tools&&(Ae(ze,Ze),Ae(Ue,Ve),Ae(Ve,Qe),Ae(Ve,nt)),Yn(mn,qe,at),Yn(gn+" "+cn,qe,dt),N.resize&&(Ae(Re,_e),re(Re,je+"-is-can-resize"),Yn(hn,_e,vt),Yn(vn,c,xt),Yn(xn,H,yt)),st(),lt(),0!==e?In("create",[s]):s},s.update=function(n,e){return s.is.create&&s.destroy(0),(0!==e?In("update",[s]):s).create(n,0)},s.destroy=function(n){return s.is.create?(s.is.create=!1,De.exit(0,0,0),ue(qe,Be),N.tools=Hn(N.tools),N.keys&&(Wn(mn,qe,at),Wn(gn,qe,dt)),N.resize&&(Wn(hn,_e,vt),Wn(vn,c,xt),Wn(xn,c,yt)),et?(be(Re,et),Ae(et,qe),et=0):be(Re,qe),Se(Re),0!==n?In("destroy",[s]):s):s},s.enable=function(n){return qe.disabled=qe.readOnly=!1,re(Re,je+"-is-can-update"),re(Re,je+"-is-can-copy"),0!==n?In("enable",[s]):s},s.disable=function(n){return qe.disabled=!0,ue(Re,je+"-is-can-update"),ue(Re,je+"-is-can-copy"),0!==n?In("disable",[s]):s},s.freeze=function(n){return qe.disabled=!1,qe.readOnly=!0,ue(Re,je+"-is-can-update"),re(Re,je+"-is-can-copy"),0!==n?In("freeze",[s]):s},De.exit=function(n,e,t){if(z={panel:function(){Se(Ye)},overlay:function(){Wn(sn,We,Et),Se(We)},modal:function(){Wn(sn+" "+mn,ht.x,wt),Wn(hn,Pe,Ft),Wn(vn,Pe,Lt),Wn(xn,c,At),Se(Xe)},drop:function(){Wn(sn,c,Tt),Wn(En,o,Tt),Se(Ke)},bubble:function(){Se(Ge)}},dt(),e)if(M(e))for(Z in e)Z=e[Z],z[Z]&&z[Z](),0!==t&&In("exit."+Z,[s]);else z[e]&&z[e](),0!==t&&In("exit."+Z,[s]);else for(Z in z)z[Z]();return n&&s.select(),0!==t&&In("exit",[s]),s},De.panel=function(n,e,t,r){function i(n){return Wn(sn+" "+mn,un,i),De.panel.exit(1),Vn(n)}return De.exit(0,0,0),Y=Jn(n),nn=0,r&&(Y+=" "+Y+"--"+Jn(r)),M(e)&&!w(e)&&(nn=$e(je+"-panel-header "+Y,0,e.header),e=e.body),en=$e(je+"-panel-body "+Y,0,$e(je+"-panel-content "+Y,0,L(e)?"":e)),L(e)&&e(en),un=oe("a",!1,{href:Sn,"class":je+"-a "+je+"-x "+Y}),un.title=Oe.close,oe(Ye,!1,{"class":je+"-panel "+Y}),Yn(sn+" "+mn,un,i),ae(Ye,0),nn&&Ae(Ye,nn),Ae(Pe,oe(Ye,[en,un])),L(t)?t(Ye):S(t)&&oe(Ye,t),k=[s,Ye],r&&In("enter.panel."+n+":"+r,k),In("enter.panel."+n,k),In("enter.panel",k),In("enter",k),un.focus(),s},De.panel.fit=function(){},De.overlay=function(n,e,t,r){return De.exit(0,0,0),Y=Jn(n),r&&(Y+=" "+Y+"--"+Jn(r)),Ae(Pe,oe(We,!1,{"class":je+"-overlay "+Y})),e&&Yn(sn,We,Et),L(t)?t(We):S(t)&&oe(We,t),k=[s,We],r&&In("enter.overlay."+n+":"+r,k),In("enter.overlay."+n,k),In("enter.overlay",k),In("enter",k),s},De.overlay.fit=function(){},De.message=function(n,e,t,r,i){function f(n){return Wn(sn+" "+mn,un,f),h(u),De.overlay.exit(1),Vn(n)}var u;return Y=Jn(n),i&&(Y+=" "+Y+"--"+Jn(i)),un=oe("a",!1,{href:Sn,"class":je+"-a "+je+"-x "+Y}),un.title=Oe.close,oe(Je,L(e)?e(Je):e,{"class":je+"-message "+Y}),Yn(sn+" "+mn,un,f),De.overlay("message message-"+Y,0,function(n){Ae(Je,un),t&&(u=v(function(){f()},t)),Ae(n,Je)},i),L(r)?r(Je):S(r)&&oe(Je,r),s},De.modal=function(){var o,l,n=arguments,e=n[0],t=n[1],r=n[2],i=n[3],u=je+"-modal",f=t.footer;if(M(e)&&(e="default",t=n[0],r=n[1],i=n[2]),De.overlay(e,1,0,i).blur(),Y=Jn(e),i&&(Y+=" "+Y+"--"+Jn(i)),oe(Xe,!1,{"class":u+" "+Y}),C(t.body)&&(t.body=oe("div",t.body,{"class":u+"-content "+Y})),C(f)&&M(f)&&!w(f)){l=[];for(Z in f)q=f[Z],w(q)?l.push(q):(q=ut(q,Z,f),V=Z.text||Oe[Z]||Z,o=oe("button",V,m({name:"y["+Z+"]",type:"button","class":je+"-button",data:{"button-id":Z}},q.attributes)),Yn(sn,o,function(n){return V=f[Zn(this,"button-id")].click(n,s),V===!1?Vn(n):void 0}),l.push(o));t.footer=l}for(Z in t)u[1]=Z,ht[Z]=$e(u+"-"+Gn(Z,u)+" "+Y,0,t[Z]);return ht.x=oe("a",!1,{href:Sn,"class":je+"-a "+je+"-x "+Y}),ht.sizer=Ie,ae(Xe,0),ht.x.title=Oe.close,Ae(Pe,oe(Xe,ht,{style:""})),De.modal.fit(),we(Xe,We),Yn(sn+" "+mn,ht.x,wt),Yn(hn,ht.header,Vn),Yn(hn,ht.sizer,Vn),Yn(hn,Pe,Ft),Yn(vn,Pe,Lt),Yn(xn,c,At),L(r)&&r(ht),k=[s,Xe,ht],i&&In("enter.modal."+e+":"+i,k),In("enter.modal."+e,k),In("enter.modal",k),In("enter",k),ht.x.focus(),s},De.modal.fit=function(n){return bt(),Y=mt/2-rn/2,nn=gt/2-U/2,M(n)?(C(n[0])&&(Y=n[0]),C(n[1])&&(nn=n[1])):(Y=d(Y,0),nn=d(nn,0)),a(Xe,{left:Y+$n,top:nn+$n,"min-width":rn+$n,"min-height":U+$n,visibility:"visible"}),k=[s,Xe,ht],In("fit.modal",k),In("fit",k),s};var Ct={"class":je+"-button",name:"y"};return De.alert=function(n,e,t,r,i){var u=oe("button",Oe.okay,Ct),f="alert";return t=t||E,M(n)&&(f+=":"+n[0],n=n[1]||n[0]),Yn(sn,u,function(n){return t(n,s),wt(n,f+".y")}),Yn(mn,u,function(n){var e=n.TE.key;return e(/^(escape|enter)$/)&&Xn(sn,u,[n]),Vn(n)}),De.modal(f,Mt(n,e,u),r,i),u.focus(),s},De.confirm=function(n,e,t,r,i,u){function a(n){return L(t)&&t(n,s),wt(n,c+".y")}function d(n){return L(r)&&r(n,s),wt(n,c+".n")}var l,f=oe("button",Oe.okay,Ct),o=oe("button",Oe.cancel,Ct),c="confirm";return o.name="n",Yn(sn,f,a),Yn(sn,o,d),Yn(mn,f,function(n){return l=n.TE.key,l("arrowright")?o.focus():l("enter")?a(n):l("escape")&&wt(n,c+".y"),Vn(n)}),Yn(mn,o,function(n){return l=n.TE.key,l("arrowleft")?f.focus():l("enter")?d(n):l("escape")&&wt(n,c+".n"),Vn(n)}),De.modal(c,Mt(n,e,[f,o]),i,u),o.focus(),s},De.prompt=function(n,e,t,r,i,u,f){function h(){l.focus(),"placeholder"in l&&l.select()}function v(n){return p=l.value,L(t)&&!t(p)?h():!t||x(p)&&p!==e?(wt(n,a+".y"),r(n,s,p!==e?p:"",e)):h(),Vn(n)}function y(n){return wt(n,a+".n")}var p,m,g,o=oe("button",Oe.okay,Ct),c=oe("button",Oe.cancel,Ct),l=oe("input",!1,{type:"text",value:e,placeholder:e,spellcheck:"false","class":je+"-input block"}),a="prompt",d=[];if(i=i||0,1===i)l=oe("textarea",e,{placeholder:e.split("\n")[0],"class":je+"-textarea block",spellcheck:"false"});else if(2===i){for(Z in e)d.push(oe("option",e[Z],{value:Z,selected:Z===t||null}));l=oe("select",d,{"class":je+"-select block"})}return r=r||E,l.name="data",c.name="n",Yn(mn,l,function(n){return m=n.TE.key,g=n.TE.control,m("enter")&&0===i||g("enter")?v(n):m("escape")||m("backspace")&&!this.value?y(n):m("arrowdown")&&0===i||m("enter")&&2===i||g("arrowdown")?(o.focus(),Vn(n)):void 0}),Yn(mn,o,function(n){return m=n.TE.key,m("enter")?v(n):m("escape")?y(n):m("arrowup")?l.focus():m("arrowright")&&c.focus(),Vn(n)}),Yn(mn,c,function(n){return m=n.TE.key,m(/^(enter|escape)$/)?y(n):m("arrowup")?l.focus():m("arrowleft")&&o.focus(),Vn(n)}),Yn(sn,o,v),Yn(sn,c,y),De.modal(a,Mt(n,l,[o,c]),u,f),h(),s},De.drop=function(){De.exit(0,0,0);var n=arguments,e=n[0],t=n[1],r=n[2];return 1===On(n)&&(e="default",t=n[0],r=n[1]),Y=Jn(e),ae(Ke,0),Ae(H,oe(Ke,!1,{"class":je+"-drop "+Y})),L(t)?t(Ke):oe(Ke,t),De.drop.fit(),r===!1||(Yn(sn,c,Tt),Yn(En,o,Tt)),k=[s,Ke],In("enter.drop."+e,k),In("enter.drop",k),s},De.drop.fit=function(n){return k=ee($),B=ee(Ke),_=De.drop.target,Y=k.w/2-B.w/2,nn=k.h/2-B.h/2,!C(n)&&_&&(e=ne(_),Y=e.l,nn=e.t+ee(_).h),M(n)?(C(n[0])&&(Y=n[0]),C(n[1])&&(nn=n[1])):(Y=d(Y,0,k.w-B.w),nn=d(nn,0,Math.max(k.h,ee(o).h)-B.h)),a(Ke,{left:Y+$n,top:nn+$n,visibility:"visible"}),k=[s,Ke],In("fit.drop",k),In("fit",k),s},De.menu=function(n,t,r,i){var o,u=De.tools,f=0;if(t===!1)return De.tool(n,t);for(i in r)rn="%"===i[0],o=r[i],o=S(o)&&!rn?u[o]:o,o&&(o=ut(o,i,u),r[i]=o);return De.tool(n,{i:M(t)?t[0]:0,text:M(t)?t[1]||0:t&&r[t]&&r[t].text||t,click:function(c){var l=De.drop.target=u[n].target;return De.drop("menu menu-"+Jn(n),function(c){function a(f){return nn=this,e=Zn(nn,"tool-id"),W=r[e],W=S(W)?u[W]:W||{},X=le(nn),!it(W)&&L(i=W.click)&&(i=i(f,s),W.i&&(u[n].i=W.i),De.menu.set(n,M(W.text)?[W.text[0],e]:M(t)?[t[0],e]:e),i===!1)?(s.select(),Vn(f)):(s.select(),Vn(f))}function d(n){if(nn=this,(V=n.TE.key)("escape"))De.exit(1);else if(V("enter"))Xn(sn,nn,[n]);else if(V("f10")&&l)l.focus();else if(V("arrowdown")&&(Y=ge(nn))){for(;!xe(Y,"a")&&Y;)Y=ge(Y);Y&&Y.focus()}else if(V("arrowup")&&(Y=he(nn))){for(;!xe(Y,"a")&&Y;)Y=he(Y);!Y&&l?(De.exit(),l.focus()):Y&&Y.focus()}else V("arrowup")&&l&&(De.exit(),l.focus());return Vn(n)}for(i in r)if(o=r[i],rn="%"===i[0],o){var p={href:rn?null:Sn,"class":je+"-"+(rn?"label":"button")};rn?q=ke[n]&&ke[n][+i.slice(1)-1]||i:(p.data={},p.data["tool-id"]=i,q=Ne[i]||i),J=o.text,J=M(J)?J[1]||"":J,q=M(q)?q[0]:q,Q=oe(rn?"span":"a","<span>"+(rn?q||"%"+f:J||q)+"</span>",m(p,o.attributes||{})),re(Q,"menu-"+Jn(i).replace(/[\/\s]/g,"-")),!p.title&&(nn=o.title)&&(Q.title=M(nn)?nn[0]+(nn[1]?" ("+nn[1]+")":""):nn),rn?Rn(Q,{id:je+"-label:"+f}):(it(o)?re(Q,"x"):ue(Q,"x"),o.on?re(Q,"on"):ue(Q,"on"),Yn(sn,Q,a),Yn(mn,Q,d)),Ae(c,Q),++f}v(function(){(ye('[data-tool-id="'+Zn(l,ct)+'"]',c)[0]||ye("a",c)[0]).focus()},1)}),!1}},i),Un(u[n].target,{"ui-drop":n}),u[n].data=r,De.menu.set(n,t)},De.menu.set=function(n,e){var u,f,t=De.tools[n]||{},r=t.target,i=t.data;return r?(M(e)?Un(r,ct,e[1]||""):(Un(r,ct,e),e=i[e]&&i[e].text||e),M(e)?(f=e[0],f=jn(f,"<")?f:De.i(f,t.i),e=C(e[1])?e[1]:0,e=e&&i[e]&&i[e].text||e,e=f+(0!==e?"<span>"+(M(e)?e[1]||e:e)+"</span>":"")):f=De.i(n,t.i),(u=ye("."+je+"-text",r)[0])?(re(r,"text"),se(u,e)):(ue(r,"text"),se(r,f)),s):s},De.bubble=function(){De.exit(0,0,0);var n=arguments,e=n[0],t=n[1];return 1===On(n)&&(e="default",t=n[0]),Y=Jn(e),ae(Ge,0),Ae(H,oe(Ge,!1,{"class":je+"-bubble "+Y})),L(t)?t(Ge):oe(Ge,t),De.bubble.fit(),k=[s,Ge],In("enter.bubble."+e,k),In("enter.bubble",k),s},De.bubble.fit=function(n){Q=s.$(1),e=ne(qe),U=a(qe,"line-height");var t="border-",r="-width";Y=Q.caret[0].x+e.l-qe.scrollLeft,nn=Q.caret[1].y+e.t+U-qe.scrollTop,B=a(Pe,[t+"top"+r,t+"bottom"+r,t+"left"+r,t+"right"+r]);var i=ee(Pe),u=ee(Ge),f=B[0]+B[1],o=B[2]+B[3];return M(n)?(C(n[0])&&(Y=n[0]),C(n[1])&&(nn=n[1])):(Y=d(Y,e.l,e.l+i.w-u.w-o),nn=d(nn,e.t,e.t+i.h-u.h-f)),a(Ge,{left:Y+$n,top:nn+$n,visibility:"visible"}),k=[s,Ge],In("fit.bubble",k),In("fit",k),s},De.panel.exit=function(n){return De.exit(n,"panel")},De.overlay.exit=function(n){return De.exit(n,"overlay")},De.modal.exit=function(n){return De.exit(n,"modal")},De.drop.exit=function(n){return De.exit(n,"drop")},De.bubble.exit=function(n){return De.exit(n,"bubble")},De.tool=function(n,e,t){var r=De.tools;return q="",V=C(r[n])?"update":"create","|"!==n&&(N.tools=Dn(N.tools).filter(function(e,t){return e===n?(q=t,!1):!0})),e===!1?(delete r[n],V="destroy"):("|"===n?(t=e,e={}):(L(e)&&(e={click:e}),r[n]=m(r[n]||{},e),C(t)||""===q||(t=q)),A(t)?N.tools.splice(t,0,n):N.tools.push(n)),In(V+".tool."+n,[s,r[n]]),st(),s},De.separator=function(n,e){return De.tool("|",n!==!1?{attributes:n||{}}:!1,e)},De.key=function(n,e){var t=De.keys;return V=C(t[n])?"update":"create",e===!1?(delete t[n],V="destroy"):t[n]=e,In(V+".key."+n,[s,t[n]]),lt(),s},De.key.set=function(n){O[n]=1},De.key.reset=function(n){n?delete O[n]:O={}},De.tools={"|":{},undo:{i:"undo",click:function(n,e){return e.undo(),!1}},redo:{i:"repeat",click:function(n,e){return e.redo(),!1}},indent:function(n,e){return e.indent(Ln),!1},outdent:function(n,e){return e.outdent(Ln),!1}},De.keys={"control+y":"redo","control+z":"undo",escape:function(n,e){return J=":not([tabindex]):not([disabled])",(Q=ye("input"+J+",button"+J+",select"+J+",textarea"+J+",a[href]"+J+",[contenteditable]"+J+',[tabindex]:not([tabindex="-1"])',c,0))&&-1!==(nn=Q.indexOf(qe))?((Q[nn+1]||c).focus(),!1):void 0},f10:function(n,e){return ye("a",Ze)[0].focus(),!1},tab:wn?"indent":0,"shift+tab":wn?"outdent":0},De.el={container:Re,header:ze,body:Pe,footer:Ue,panel:Ye,overlay:We,modal:Xe,drop:Ke,bubble:Ge},s.config=N,m(TE._,{time:function(n){var e=new Date(C(n)?n:Date.now()),t=e.getFullYear(),r=e.getMonth()+1,i=e.getDate(),u=e.getHours(),f=e.getMinutes(),o=e.getSeconds(),c=e.getMilliseconds();return 10>r&&(r="0"+r),10>i&&(i="0"+i),10>u&&(u="0"+u),10>f&&(f="0"+f),10>o&&(o="0"+o),10>c&&(c="0"+c),[""+t,""+r,""+i,""+u,""+f,""+o,""+c]},replace:Kn,format:Gn,dom:{set:Ae,reset:Me,get:ye,id:ce,copy:Te,replace:Ce,classes:{set:re,reset:ue,toggle:fe,get:ie},attributes:{set:Rn,reset:Pn,get:zn},data:{set:Un,reset:qn,get:Zn},is:xe,offset:ne,pointer:Qn,size:ee,content:{set:se,reset:ae,get:le},closest:te,parent:de,children:pe,closest:me,next:ge,previous:he,index:ve,before:be,after:we,prepend:Fe,append:Le},el:oe,event:{set:Yn,reset:Wn,fire:Xn,x:Vn}}),m(s._,TE._),m(s._,{hooks:y,hook:{set:Bn,reset:_n,fire:In}}),s.create()};