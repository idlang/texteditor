/*!
 * ==========================================================
 *  USER INTERFACE MODULE FOR TEXT EDITOR PLUGIN 1.5.3
 * ==========================================================
 * Author: Taufik Nurrohman <https://github.com/tovic>
 * License: MIT
 * ----------------------------------------------------------
 */
TE.ui=function(e,t){function Le(e){return O(e)?v(e).split(/\s+/):e}function Oe(e){return $(e)?e.join(" "):e}function _e(e,t,n){return L(e)?L(t)?(L(x[e])||(x[e]={}),L(n)||(n=Object.keys(x[e]).length),x[e][n]=t,l):x[e]:x}function Ce(e,t){return L(e)?L(t)&&L(x[e])?(delete x[e][t],l):(x[e]={},l):(x={},l)}function Me(e,t,n){if(!L(x[e]))return x[e]={},l;if(L(n))L(x[e][n])&&x[e][n].apply(l,t);else for(I in x[e])x[e][I].apply(l,t);return l}function je(e,t,n){if($(t))for(I in t)je(e,I,t[I]);else e.setAttribute(t,n)}function He(e,n,i){if(O(n))return He(e,[n],L(i)?i:"")[0];t=[];for(I in n)I=n[I],(I=e.getAttribute(I))&&t.push(I);return t.length?t:L(i)?i:[]}function Ne(e,t){if($(t))for(I in t)Ne(e,t[I]);else if(L(t))e.removeAttribute(t);else for(Ne(e,"class"),I=0,X=e.attributes,q=X.length;q>I;++I)X[I]&&Ne(e,X[I].name)}function Be(e,t,n){if($(t))for(I in t)Be(e,I,t[I]);else je(e,"data-"+t,n)}function De(e,n,i){if(O(n))return De(e,[n],L(i)?i:"")[0];t=[];for(I in n)I=n[I],(I=He(e,"data-"+I))&&t.push(I);return t.length?t:L(i)?i:[]}function Se(e,t){if($(t))for(I in t)Ne(e,"data-"+t[I]);else if(L(t))Ne(e,"data-"+t);else for(I=0,X=e.attributes,q=X.length;q>I;++I)X[I]&&"data-"===X[I].name.slice(0,5)&&Ne(e,X[I].name)}function Ye(e){return e&&e.preventDefault(),!1}function Ae(e,t,n){if(t){for(e=Le(e),I=0,X=e.length;X>I;++I)t.addEventListener(e[I],n,!1),_e("on:"+e[I],n,Ve(t));return l}}function Fe(e,t,n){if(t){for(e=Le(e),I=0,X=e.length;X>I;++I)t.removeEventListener(e[I],n,!1),Ce("on:"+e[I],Ve(t));return w(t)&&t.id.split(":")[0]===wt+"-dom"&&Ne(t,"id"),l}}function Ie(e,t,n){e=Le(e);var r,i="createEvent"in s;for(I=0,X=e.length;X>I;++I)i?(r=s.createEvent("HTMLEvents"),r.data=n,r.initEvent(e[I],!0,!1),t.dispatchEvent(r)):Me("on:"+e[I],n,Ve(t));return l}function Xe(e,t,n){for(I=0,X=t.length,q;X>I;++I)q=t[I],e=e.replace(z(q)?q:h(p(q),"g"),n&&n[I]||"");return e}function qe(e,t){return e.replace(/%(\d+)/g,function(e,n){return--n,L(t[n])?t[n]:e})}function Ke(e){return v(Xe(e.toLowerCase(),[/[^ \/a-z\d-]/g,/([ -])+/g,/^-|-$/g],["-","$1",""]))}function Pe(e,t){var n=t.touches?t.touches[0].pageX:t.pageX,i=t.touches?t.touches[0].pageY:t.pageY,r=Re(e);return{x:n-r.l,y:i-r.t}}function Re(e){for(K=e.offsetLeft,J=e.offsetTop;e=e.offsetParent;)K+=e.offsetLeft,J+=e.offsetTop;return{l:K,t:J}}function Ue(e){return{w:e.offsetWidth,h:e.offsetHeight}}function We(e,t){for(;(e=it(e))&&e!==t;);return e}function Ze(e,t){t=Le(t);for(I in t)e.classList.add(t[I])}function Ge(e,n,i){if(O(n))return Ge(e,[n],L(i)?i:"")[0];t=[];for(I in n)I=n[I],e.classList.contains(I)&&t.push(I);return t.length?t:L(i)?i:!1}function Je(e,t){if(L(t)){t=Le(t);for(I in t)e.classList.remove(t[I])}else Ne(e,"class")}function Qe(e,t,n){if(e=O(e)?s.createElement(e):e,$(n))for(I in n)if(V=n[I],"classes"===I)Ze(e,V);else if("data"===I)for(X in V)V=V[X],null===V?Se(e,X):Be(e,X,V);else"css"===I?O(V)?je(e,"style",V):null===V?Ne(e,"style"):c(e,V):E(V)?e[I]=V:null===V?Ne(e,I):je(e,I,$(V)?V.join(" "):""+V);if(w(t))ht(e,t);else if($(t))for(I in t)V=t[I],w(V)?ht(e,V):V!==!1&&et(e,V);else L(t)&&t!==!1&&et(e,t);return e}function Ve(e){var t=e.id;return t||(t=wt+"-dom:"+Date.now(),e.id=t),t}function et(e,t){e.innerHTML=t}function tt(e,t){return e.innerHTML||(L(t)?t:"")}function nt(e,t){if(t!==!1&&(B=rt(e)))for(I=0,X=B.length;X>I;++I)nt(B[I]);et(e,"")}function it(e){return e&&e.parentNode}function rt(e){return e&&e.children||[]}function ot(e){return e&&e.nextSibling}function ft(e){return e&&e.previousSibling}function ut(e){for(I=0;e=ft(e);)++I;return I}function st(e,t){return e&&O(t)?e.nodeName.toLowerCase()===t.toLowerCase():e&&E(t)?e===t(e):e===t}function lt(e,n){if(!(n=L(n)?n:s))return[];if(t=[],O(e)){if(/^([#.]?[\w-]+|\*)$/.test(e)){if("#"===e[0]&&(e=n.getElementById(e.slice(1))))return[e];if("."===e[0]&&(e=n.getElementsByClassName(e.slice(1)))||(e=n.getElementsByTagName(e))){for(I=0,X=e.length;X>I;++I)t.push(e[I]);return t}return[]}for(e=n.querySelectorAll(e),I=0,X=e.length;X>I;++I)t.push(e[I]);return t}return at(e)?[e]:[]}function at(e,t){var n=it(e);return 1===arguments.length?n||!1:e&&n===e?n:!1}function ct(e,t){U=it(e),U&&U.insertBefore(t,e)}function dt(e,t){U=it(e),U&&U.insertBefore(t,ot(e))}function pt(e,t){B=rt(e)[0],B?ct(B,t):ht(e,t)}function bt(e,t){ht(e,t)}function ht(e,t){e.appendChild(t)}function gt(e,t){var n=at(e);if(n){if(t!==!1)for(B=rt(e)[0];B;)gt(B);n.removeChild(e)}}function yt(e){nt(Qe(e,!1,{style:""})),gt(e)}function vt(e,t,n){return Qe(t||"div",n,{"class":e})}function Pt(e){return!e||L(e.active)&&!e.active}function Rt(e,t,n){return E(e)&&(e={click:e}),O(e.click)&&(e.click=(n[e.click]||{}).click),L(e.title)||(e.title=Et[t]||""),L(e.attributes)||(e.attributes={}),n[t]=e,e}function Ut(e){if(jt.disabled||jt.readOnly)return jt.focus(),Ye(e);xt.exit(0,0,0);var t=De(this,"tool-id"),n=xt.tools,i=n[t];return xt.drop.target=e.currentTarget||e.target,!Pt(i)&&E(X=i.click)&&(X=X(e,l,t),Me("on:change",[e,l,t]),X===!1)?Ye(e):(l.select(),Ye(e))}function Wt(e){if(J=this,(q=e.TE.key)(/^(escape|f10)$/))xt.exit(1);else if(q("enter")||q("arrowdown")&&De(J,"ui-drop"))xt.drop.target=J,Ie(oe,J,[e]);else if(q("arrowright")&&(K=ot(J))){for(;!st(K,"a")&&K;)K=ot(K);K&&K.focus()}else if(q("arrowleft")&&(K=ft(J))){for(;!st(K,"a")&&K;)K=ft(K);K&&K.focus()}return Ye(e)}function Zt(){nt(Mt,!1);var i,r,o,f,u,s,a,e=Le(j.tools),t=wt+"-button",n=wt+"-separator";j.tools=e;for(s in e)a=e[s],r=xt.tools[a],(r||r==={})&&(r=Rt(r,a,xt.tools),o=r.i||a,"|"!==o&&"<"!==o[0]&&(o=Ke(o)),f="|"!==o,u=Ke(a).replace(/[\/\s]/g,"-"),qt=vt(f?t+" "+t+"-"+u:n+" "+n+"-"+s,f?"a":"span"),f?(qt=r.target||qt,i=t+":"+u,je(qt,{href:$e,id:i,tabindex:-1}),Be(qt,"tool-id",a),o="<"===o[0]?o:'<i class="'+qe(kt,[u,o])+'"></i>',Pt(r)?Ze(qt,"x"):Je(qt,"x"),r.text&&(o=qe('<span class="'+wt+'-text">'+r.text+"</span>",[o]),Ze(qt,"text")),et(qt,o),Qe(qt,!1,r.attributes),!r.attributes.title&&(X=r.title)&&(qt.title=$(X)?X[0]+(X[1]?" ("+X[1]+")":""):X),Ae(oe,qt,Ut),Ae(ae,qt,Wt)):qt.id=n+":"+s,r.target=qt,ht(Mt,qt));Me("update.tools",[l])}function Gt(){xt.keys=function(){var n,e=Object.keys(xt.keys).sort().reverse(),t={};for(I=0,X=e.length;X>I;++I)n=e[I],t[n]=xt.keys[n];return t}(),en(),Me("update.keys",[l])}function Vt(e){function d(e){return e.replace(/\+/g,"\n").replace(/\n\n/g,"\n+").split("\n")}var n=l.$(),i=n.before,r=n.after,o=i.slice(-1),f=r[0],u=n.length,s=xt.keys,a=TE.keys_alias,c=(i.match(/(?:^|\n)([\t ]*).*$/)||[""]).pop();R=e.TE.key(),Jt[R]=1,t=Object.keys(Jt).length,y(function(){l.record()});for(I in s){q=d(I),B=0;for(X in q)X=q[X],Jt[a[X]||X]&&++B;if(q=q.length,B===q&&t===q&&(O(s[I])&&(s[I]=xt.tools[s[I]].click),K=s[I]&&s[I](e,l),K===!1))return Ye(e)}if(ye)for(I in ye)if(P=ye[I],P!==!1){if(R===P&&f===P)return"\\"===o?(l.insert(R,0),Ye(e)):(l.select(n.end+1),Ye(e));if(I===R)return l.wrap(I,P),Ye(e);if(o===I&&f===P){if("backspace"===R&&i.slice(-2)!=="\\"+I)return l.unwrap(I,P),Ye(e);if(ve&&"enter"===R&&I!==P)return l.tidy("\n"+c+me,"\n"+c),Ye(e)}}if(ve&&!u){if("backspace"===R&&h(p(me)+"$").test(i))return l.outdent(me),Ye(e);if("enter"===R&&h("(^|\\n)("+p(me)+")+.*$").test(i))return l.insert("\n"+c,0,1),Ye(e)}}function en(e){e&&e.TE&&e.TE.key?delete Jt[e.TE.key()]:Jt={}}function fn(e){return tn=Ht,G=Ue(Ct),Ye(e)}function un(e){tn===Ht&&c(jt,{height:Pe(_t,e).y-G.h+ze})}function sn(){tn=0}function ln(){xt.exit(1)}function an(){t=Ue(St),ee=t.w,F=t.h,t=Ue(Dt),nn=t.w,rn=t.h}function cn(e,t){t&&Me("exit.modal."+t,[l]),Ie(oe,Dt,[e])}function dn(e){tn=e.target,t=Pe(St,e),te=t.x,ne=t.y,an()}function pn(e){var n=on.header,i=on.resize;tn===n||We(tn,n)===n?(t=Pe(_t,e),K=t.x-te,J=t.y-ne,c(St,{left:(ee>nn?K:d(K,0,nn-ee))+ze,top:(F>rn?J:d(J,0,rn-F))+ze})):tn===i&&(t=Pe(St,e),G=Ue(i),c(St,{width:t.x+G.w/4+ze,height:t.y+G.h/4+ze}))}function bn(){tn=0}function hn(e,t,n){return{header:e,body:t,footer:n}}function gn(e){H=xt.drop.target,N=Yt,B=e&&e.target||0,(!B||B!==H&&We(B,H)!==H)&&(xt.drop.target=0,yt(Yt),Fe(oe,s,gn),Fe(ge,u,gn),xt.exit(e.target===jt))}var H,N,B,Y,F,I,X,q,K,P,R,t,U,Z,G,J,V,ee,te,ne,n="⌘",i="…",o="⇥",f="⇧",u=window,s=document,l=new TE(e),a=l._,c=a.css,d=a.edge,p=a.x,b=a.extend,h=a.pattern,y=(a.timer.reset,a.timer.set),v=a.trim,x={},m=function(){},k=TE.is,w=k.e,E=k.f,T=k.i,$=k.o,z=k.r,L=function(e){return!k.x(e)},O=k.s,_=s.documentElement,M=(s.head,s.body),j=b({tab:"  ",dir:"ltr",resize:1,keys:1,tools:"indent outdent | undo redo",attributes:{spellcheck:"false"},unit:[[["<",">","/"],["=",'"','"'," "]],[["\\u003C","\\u003E","\\u002F"],["\\u003D","\\u0022","\\u0022","\\u0020"]]],auto_tab:1,auto_close:{'"':'"',"'":"'","(":")","{":"}","[":"]","<":">"},languages:{tools:{tools:["Focus Tools","F10"],undo:["Undo",n+"+Z"],redo:["Redo",n+"+Y"],indent:["Indent",o],outdent:["Outdent",f+"+"+o]},buttons:{okay:"OK",cancel:"Cancel",yes:"Yes",no:"No",enter:"Enter",exit:"Exit",open:"Open",close:"Close",ignore:"Ignore"},placeholders:{"":"text here"+i},labels:{},others:{}},classes:{"":"text-editor",i:"icon icon-%1 icon-%1--%2 fa fa-%2"}},t),re="blur",oe="click",ae="keydown",ce="keyup",de="touchstart mousedown",pe="touchmove mousemove",be="touchend mouseup",ge="orientationchange resize",ye=j.auto_close,ve=j.auto_tab,xe=j.languages,me=j.tab,we=(j.unit[0][1],j.unit[0][0]),Ee=j.unit[1][1],Te=j.unit[1][0],$e="javascript:;",ze="px",xt=l.ui={};l.tidy=function(e,t){var n=l.$(),i=v(n.before)?e:"",r=v(n.after)?L(t)?t:e:"";return l.trim(i,r)},l.i=function(){return v(l.replace(/\s+/g," "))},l.format=function(e,t,n,i){$(e)||(e=[e]),L(n)||(n=" "),L(i)||(i="");var r=l.h,o=l[0]().$(),f=(e[0]?we[0]+e[0]+we[1]:"")+i,u=i+(e[0]?we[0]+we[2]+(e[1]||e[0].split(h("("+Ee[3]+")+"))[0])+we[1]:""),s=p(f),a=p(u),c=h("^"+s+"([\\s\\S]*?)"+a+"$"),d=h(s+"$"),b=h("^"+a),g=o.before,y=o.after;return o.length?n=!1:l.insert(xe.placeholders[""]),l.toggle(t?!c.test(o.value):!d.test(g)&&!b.test(y),[function(e){e.unwrap(f,u,1).tidy(h(Te[0]+"[^"+Te[0]+Te[1]+Te[2]+"]+?"+Te[1]+"$").test(g)?"":n,h("^"+Te[0]+Te[2]+"[^"+Te[0]+Te[1]+"]+?"+Te[1]).test(y)?"":n).wrap(f,u,t)},function(e){e.unwrap(f,u,t)}])[r]()};var qt,mt=j.classes,kt=mt.i,wt=mt[""],Et=xe.tools,Tt=xe.buttons,$t=xe.labels,zt=wt+"-textarea "+wt+"-content block",Lt=vt(wt),Ot=vt(wt+"-header"),_t=vt(wt+"-body"),Ct=vt(wt+"-footer"),Mt=vt(wt+"-tool"),jt=Qe(e,!1,j.attributes),Ht=vt(wt+"-resize s"),Nt=vt(wt+"-description"),Bt=vt(wt+"-panel"),Dt=vt(wt+"-overlay"),St=Qe("div"),Yt=Qe("div"),At=Qe("div"),Ft=vt("left","span"),It=vt("right","span"),Xt=0;L(j.suffix)||(j.suffix=we[1]);var Jt={},tn=0,te=0,ne=0,ee=0,F=0,nn=0,rn=0,on={};l.create=function(e,t){$(e)&&(j=b(j,e));var n=at(jt);return Ze(Lt,wt+"-is-can-update"),Ze(Lt,wt+"-is-can-copy"),Ze(jt,zt),n&&st(n,"p")?(ct(n,Lt),Xt=n,gt(n,!1)):ct(jt,Lt),Lt.dir=j.dir,ht(Lt,Ot),ht(Lt,_t),ht(Lt,Ct),ht(_t,jt),j.tools&&(ht(Ot,Mt),ht(Ct,Nt),ht(Nt,Ft),ht(Nt,It)),Ae(ae,jt,Vt),Ae(ce+" "+re,jt,en),j.resize&&(ht(Lt,Ht),Ze(Lt,wt+"-is-can-resize"),Ae(de,Ht,fn),Ae(pe,s,un),Ae(be,M,sn)),Zt(),Gt(),0!==t?Me("create",[l]):l},l.update=function(e,t){return Ge(jt,Le(zt),0)&&l.destroy(0),(0!==t?Me("update",[l]):l).create(e,0)},l.destroy=function(e){return Ge(jt,Le(zt),0)?(xt.exit(0,0,0),Je(jt,zt),j.tools=Oe(j.tools),j.keys&&(Fe(ae,jt,Vt),Fe(ce,jt,en)),j.resize&&(Fe(de,Ht,fn),Fe(pe,s,un),Fe(be,s,sn)),Xt?(ct(Lt,Xt),ht(Xt,jt),Xt=0):ct(Lt,jt),yt(Lt),0!==e?Me("destroy",[l]):l):l},l.enable=function(e){return jt.disabled=jt.readOnly=!1,Ze(Lt,wt+"-is-can-update"),Ze(Lt,wt+"-is-can-copy"),0!==e?Me("enable",[l]):l},l.disable=function(e){return jt.disabled=!0,Je(Lt,wt+"-is-can-update"),Je(Lt,wt+"-is-can-copy"),0!==e?Me("disable",[l]):l},l.freeze=function(e){return jt.disabled=!1,jt.readOnly=!0,Je(Lt,wt+"-is-can-update"),Ze(Lt,wt+"-is-can-copy"),0!==e?Me("freeze",[l]):l},xt.exit=function(e,t,n){if(Y={panel:function(){yt(Bt)},overlay:function(){Fe(oe,Dt,ln),yt(Dt)},modal:function(){Fe(de,_t,dn),Fe(pe,_t,pn),Fe(be,s,bn),Fe(oe,on.x,cn),yt(St)},drop:function(){yt(Yt)},bubble:function(){yt(At)}},en(),t)if($(t))for(I in t)I=t[I],Y[I]&&Y[I](),0!==n&&Me("exit."+I,[l]);else Y[t]&&Y[t](),0!==n&&Me("exit."+I,[l]);else for(I in Y)Y[I]();return e&&l.select(),0!==n&&Me("exit",[l]),l},xt.panel=function(e,t){function n(){Fe(oe,te,n),xt.panel.exit(1)}return xt.exit(0,0,0),te=vt(wt+"-x"),te.title=Tt.close,Ae(oe,te,n),ht(_t,Qe(Bt,[vt(wt+"-panel-content","div",e),te])),E(t)?t(Bt):Qe(Bt,t),Me("enter.panel",[l]),Me("enter",[l]),l},xt.panel.fit=function(){},xt.overlay=function(e,t){return xt.exit(0,0,0),ht(_t,Dt),e&&Ae(oe,Dt,ln),E(t)?t(Dt):Qe(Dt,t),Me("enter.overlay",[l]),Me("enter",[l]),l},xt.overlay.fit=function(){},xt.modal=function(){xt.overlay(1).blur();var f,u,e=arguments,t=e[0],n=e[1],i=e[2],r=wt+"-modal",o=n.footer;if($(t)&&(t="default",n=e[0],i=e[1]),K=Ke(t),Qe(St,!1,{"class":r+" "+K}),L(n.body)&&(n.body=Qe("div",n.body,{"class":r+"-content "+K})),L(o)&&$(o)&&!w(o)){u=[];for(I in o)X=o[I],w(X)?u.push(X):(X=Rt(X,I,o),t=I.text||Tt[I]||I,f=Qe("button",t,b({name:"y["+I+"]",type:"button","class":wt+"-button",data:{"button-id":I}},X.attributes)),Ae(oe,f,function(e){return t=o[De(this,"button-id")].click(e,l),t===!1?Ye(e):void 0}),u.push(f));n.footer=u}for(I in n)r[1]=I,on[I]=vt(r+"-"+qe(I,r)+" "+K,0,n[I]);return on.x=vt(wt+"-x "+K),on.resize=vt(wt+"-resize se "+K),nt(St),on.x.title=Tt.close,ht(_t,Qe(St,on,{style:""})),xt.modal.fit(),dt(St,Dt),Ae(oe,on.x,cn),Ae(de,on.header,Ye),Ae(de,on.resize,Ye),Ae(de,_t,dn),Ae(pe,_t,pn),Ae(be,s,bn),E(i)&&(on.overlay=Dt,on.modal=St,i(on)),Me("enter.modal."+t,[l]),Me("enter.modal",[l]),Me("enter",[l]),l},xt.modal.fit=function(e){return an(),K=nn/2-ee/2,J=rn/2-F/2,$(e)?(L(e[0])&&(K=e[0]),L(e[1])&&(J=e[1])):(K=d(K,0),J=d(J,0)),c(St,{left:K+ze,top:J+ze,"min-width":ee+ze,"min-height":F+ze,visibility:"visible"}),Me("fit.modal",[l]),Me("fit",[l]),l};var yn={"class":wt+"-button",name:"y"};return xt.alert=function(e,t,n,i){var r=Qe("button",Tt.okay,yn),o="alert";return n=n||m,$(e)&&(o+=":"+e[0],e=e[1]||e[0]),Ae(oe,r,function(e){return n(e,l),cn(e,o+".y"),Ye(e)}),Ae(ae,r,function(e){var t=e.TE.key;return t(/^(escape|enter)$/)&&Ie(oe,r,[e]),Ye(e)}),xt.modal(o,hn(e,t,r),i),r.focus(),l},xt.confirm=function(e,t,n,i,r){function a(e){return E(n)&&n(e,l),cn(e,u+".y"),Ye(e)}function c(e){return E(i)&&i(e,l),cn(e,u+".n"),Ye(e)}var s,o=Qe("button",Tt.okay,yn),f=Qe("button",Tt.cancel,yn),u="confirm";return f.name="n",$(e)&&(u+=":"+e[0],e=e[1]||e[0]),Ae(oe,o,a),Ae(oe,f,c),Ae(ae,o,function(e){return s=e.TE.key,s("arrowright")?f.focus():s("enter")?a(e):s("escape")&&cn(e,u+".y"),Ye(e)}),Ae(ae,f,function(e){return s=e.TE.key,s("arrowleft")?o.focus():s("enter")?c(e):s("escape")&&cn(e,u+".n"),Ye(e)}),xt.modal(u,hn(e,t,[o,f]),r),f.focus(),l},xt.prompt=function(e,t,n,i,r,o){function b(){s.focus(),"placeholder"in s&&s.select()}function h(e){return d=s.value,!n||v(d)&&d!==t?(cn(e,a+".y"),void i(e,l,d!==t?d:"",t)):(b(),freeze(e))}function g(e){cn(e,a+".n")}var d,p,f=Qe("button",Tt.okay,yn),u=Qe("button",Tt.cancel,yn),s=Qe("input",!1,{type:"text",value:t,placeholder:t,spellcheck:"false","class":wt+"-input block"}),a="prompt",c=[];if($(e)&&(a+=":"+e[0],e=e[1]||e[0]),E(r)&&(o=r,r=0),1===r)s=Qe("textarea",t,{placeholder:t.split("\n")[0],"class":wt+"-textarea block"});else if(2===r){for(I in t)c.push(Qe("option",t[I],{value:I,selected:I===n||null}));s=Qe("select",c,{"class":wt+"-select block"})}return i=i||m,s.name="data",u.name="n",Ae(ae,s,function(e){return p=e.TE.key,p("enter")?(h(e),Ye(e)):p("escape")||p("backspace")&&!this.value?(g(e),Ye(e)):p("arrowdown")?(f.focus(),Ye(e)):void 0}),Ae(ae,f,function(e){return p=e.TE.key,p("enter")?h(e):p("escape")?g(e):p("arrowup")?s.focus():p("arrowright")&&u.focus(),Ye(e)}),Ae(ae,u,function(e){return p=e.TE.key,p(/^(enter|escape)$/)?g(e):p("arrowup")?s.focus():p("arrowleft")&&f.focus(),Ye(e)}),Ae(oe,f,h),Ae(oe,u,g),xt.modal(a,hn(e,s,[f,u]),o),b(),l},xt.drop=function(){xt.exit(0,0,0);var e=arguments,t=e[0],n=e[1];return 1===e.length&&(t="default",n=e[0]),K=Ke(t),nt(Yt),ht(M,Qe(Yt,!1,{"class":wt+"-drop "+K})),E(n)?n(Yt):Qe(Yt,n),xt.drop.fit(),Ae(oe,s,gn),Ae(ge,u,gn),Me("enter.drop."+t,[l]),Me("enter.drop",[l]),l},xt.drop.fit=function(e){return H=Ue(_),N=Ue(Yt),B=xt.drop.target,K=H.w/2-N.w/2,J=H.h/2-N.h/2,!L(e)&&B&&(t=Re(B),K=t.l,J=t.t+Ue(B).h),$(e)?(L(e[0])&&(K=e[0]),L(e[1])&&(J=e[1])):(K=d(K,0,H.w-N.w),J=d(J,0,Math.max(H.h,u.innerHeight)-N.h)),c(Yt,{left:K+ze,top:J+ze,visibility:"visible"}),Me("fit.drop",[l]),Me("fit",[l]),l},xt.menu=function(e,t,n,i){t=!$(t)&&n[t]&&n[t].text||t;var s,r=xt.tools,o='<span class="'+wt+'-current menu">%1</span>',f="",u=0;return t===!1?xt.tool(e,t):($(t)&&(f=t[0],f="<"===f[0]?f:'<i class="'+qe(kt,[f])+'"></i>',t=L(t[1])?t[1]:0,t=t&&n[t]&&n[t].text||t,o=f+(0!==t?" "+o:"")),xt.tool(e,{i:f,text:t?qe(o,[t,f]):0,click:function(a){var c=xt.drop.target=r[e].target;return xt.drop("menu menu-"+Ke(e),function(a){function d(e){return J=this,P=n[De(J,"tool-id")],P=O(P)?r[P]:P||{},R=tt(J),!Pt(P)&&E(i=P.click)&&(i=i(e,l),t!==!1&&c&&(B=rt(c)[0]||c,st(B,"i")||et(B,qe(o,[R,f])),$(P.text)&&(B=rt(B)[0])&&st(B,"i")&&(Je(B),Ze(B,qe(kt,[P.text[0]])))),i===!1)?Ye(e):(l.select(),Ye(e))}function p(e){if(J=this,(q=e.TE.key)("escape"))xt.exit(1);else if(q("enter"))Ie(oe,J,[e]);else if(q("f10")&&c)c.focus();else if(q("arrowdown")&&(K=ot(J))){for(;!st(K,"a")&&K;)K=ot(K);K&&K.focus()}else if(q("arrowup")&&(K=ft(J))){for(;!st(K,"a")&&K;)K=ft(K);!K&&c?(xt.exit(),c.focus()):K&&K.focus()}else q("arrowup")&&c&&(xt.exit(),c.focus());return Ye(e)}for(i in n)if(s=n[i],ee="%"===i[0],s=O(s)&&!ee?r[s]:s){s=Rt(s,i,r);var h={href:ee?null:$e,"class":wt+"-"+(ee?"label":"button")};ee?X=$t[e]&&$t[e][+i.slice(1)-1]||i:(h.data={},h.data["tool-id"]=i,X=Et[i]||i),Z=s.text,Z=$(Z)?Z[1]||"":Z,X=$(X)?X[0]:X,G=Qe(ee?"span":"a","<span>"+(ee?X||"%"+u:Z||X)+"</span>",b(h,s.attributes||{})),Ze(G,"menu-"+Ke(i).replace(/[\/\s]/g,"-")),!h.title&&(J=s.title)&&(G.title=$(J)?J[0]+(J[1]?" ("+J[1]+")":""):J),ee?je(G,{id:wt+"-label:"+u}):(Pt(s)?Ze(G,"x"):Je(G,"x"),Ae(oe,G,d),Ae(ae,G,p)),n[i]=s,ht(a,G),++u}y(function(){lt("a",a)[0].focus()},1)}),!1}},i),Be(r[e].target,"ui-drop",e),r[e].data=n,l)},xt.bubble=function(){xt.exit(0,0,0);var e=arguments,t=e[0],n=e[1];return 1===e.length&&(t="default",n=e[0]),K=Ke(t),nt(At),ht(M,Qe(At,!1,{"class":wt+"-bubble "+K})),E(n)?n(At):Qe(At,n),xt.bubble.fit(),Me("enter.bubble."+t,[l]),Me("enter.bubble",[l]),l},xt.bubble.fit=function(e){G=l.$(1),t=Re(jt),F=c(jt,"line-height");var n="border-",i="-width";K=G.caret[0].x+t.l-jt.scrollLeft,J=G.caret[1].y+t.t+F-jt.scrollTop,N=c(_t,[n+"top"+i,n+"bottom"+i,n+"left"+i,n+"right"+i]);var r=Ue(_t),o=Ue(At),f=N[0]+N[1],u=N[2]+N[3];return $(e)?(L(e[0])&&(K=e[0]),L(e[1])&&(J=e[1])):(K=d(K,t.l,t.l+r.w-o.w-u),J=d(J,t.t,t.t+r.h-o.h-f)),c(At,{left:K+ze,top:J+ze,visibility:"visible"}),Me("fit.bubble",[l]),Me("fit",[l]),l},xt.panel.exit=function(e){return xt.exit(e,"panel")},xt.overlay.exit=function(e){return xt.exit(e,"overlay")},xt.modal.exit=function(e){return xt.exit(e,"modal")},xt.drop.exit=function(e){return xt.exit(e,"drop")},xt.bubble.exit=function(e){return xt.exit(e,"bubble")},xt.tool=function(e,t,n){return X="","|"!==e&&(j.tools=Le(j.tools).filter(function(t,n){return t===e?(X=n,!1):!0})),t===!1?delete xt.tools[e]:("|"===e?(n=t,t={}):(E(t)&&(t={click:t}),xt.tools[e]=b(xt.tools[e]||{},t),L(n)||""===X||(n=X)),T(n)?j.tools.splice(n,0,e):j.tools.push(e)),Zt(),l},xt.separator=function(e,t){return xt.tool("|",e,t)},xt.key=function(e,t){return j.keys?(t===!1?delete xt.keys[e]:xt.keys[e]=t,Gt(),l):l},xt.tools={"|":{},undo:{i:"undo",click:function(e,t){return t.undo(),!1}},redo:{i:"repeat",click:function(e,t){return t.redo(),!1}},indent:function(e,t){return t.indent(me),!1},outdent:function(e,t){return t.outdent(me),!1}},xt.keys={"control+y":"redo","control+z":"undo",escape:function(e,t){return Z=":not([tabindex]):not([disabled])",(G=lt("input"+Z+",button"+Z+",select"+Z+",textarea"+Z+",a[href]"+Z+",[contenteditable]"+Z+',[tabindex]:not([tabindex="-1"])',s,0))&&-1!==(J=G.indexOf(jt))?((G[J+1]||s).focus(),!1):void 0},f10:function(e,t){return lt("a",Mt)[0].focus(),!1},"shift+tab":ve?"outdent":0,tab:ve?"indent":0},xt.el={container:Lt,header:Ot,body:_t,footer:Ct,overlay:Dt,modal:St,drop:Yt,bubble:At},l.config=j,b(TE._,{time:function(){var e=new Date,t=e.getFullYear(),n=e.getMonth()+1,i=e.getDate(),r=e.getHours(),o=e.getMinutes(),f=e.getSeconds(),u=e.getMilliseconds();return 10>n&&(n="0"+n),10>i&&(i="0"+i),10>r&&(r="0"+r),10>o&&(o="0"+o),10>f&&(f="0"+f),10>u&&(u="0"+u),[""+t,""+n,""+i,""+r,""+o,""+f,""+u]},replace:Xe,format:qe,dom:{set:ht,reset:gt,get:lt,id:Ve,copy:function(e,t){return e.cloneNode(L(t)?t:!0)},classes:{set:Ze,reset:Je,get:Ge},attributes:{set:je,reset:Ne,get:He},data:{set:Be,reset:Se,get:De},is:st,offset:Re,pointer:Pe,size:Ue,content:{set:et,reset:nt,get:tt},closest:We,parent:it,children:rt,next:ot,previous:ft,index:ut,before:ct,after:dt,prepend:pt,append:bt},el:Qe,event:{set:Ae,reset:Fe,fire:Ie,x:Ye}}),b(l._,TE._),b(l._,{hooks:x,hook:{set:_e,reset:Ce,fire:Me}}),l.create()};