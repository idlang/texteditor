/*!
 * ==========================================================
 *  USER INTERFACE MODULE FOR TEXT EDITOR PLUGIN 1.5.0
 * ==========================================================
 * Author: Taufik Nurrohman <https://github.com/tovic>
 * License: MIT
 * ----------------------------------------------------------
 */
TE.ui=function(e,t){function Le(e){return O(e)?v(e).split(/\s+/):e}function Oe(e){return $(e)?e.join(" "):e}function Ie(e,t,n){return L(e)?L(t)?(L(y[e])||(y[e]={}),L(n)||(n=Object.keys(y[e]).length),y[e][n]=t,s):y[e]:y}function Re(e,t){return L(e)?L(t)&&L(y[e])?(delete y[e][t],s):(y[e]={},s):(y={},s)}function Ce(e,t,n){if(!L(y[e]))return y[e]={},s;if(L(n))L(y[e][n])&&y[e][n].apply(s,t);else for(G in y[e])y[e][G].apply(s,t);return s}function Ne(e,t,n){if($(t))for(G in t)Ne(e,G,t[G]);else e.setAttribute(t,n)}function Se(e,n,r){if(O(n))return Se(e,[n],L(r)?r:"")[0];t=[];for(G in n)G=n[G],(G=e.getAttribute(G))&&t.push(G);return t.length?t:L(r)?r:[]}function Fe(e,t){if($(t))for(G in t)Fe(e,t[G]);else if(L(t))e.removeAttribute(t);else for(Fe(e,"class"),G=0,U=e.attributes,Y=U.length;Y>G;++G)U[G]&&Fe(e,U[G].name)}function He(e,t,n){if($(t))for(G in t)He(e,G,t[G]);else Ne(e,"data-"+t,n)}function Me(e,n,r){if(O(n))return Me(e,[n],L(r)?r:"")[0];t=[];for(G in n)G=n[G],(G=Se(e,"data-"+G))&&t.push(G);return t.length?t:L(r)?r:[]}function ze(e,t){if($(t))for(G in t)Fe(e,"data-"+t[G]);else if(L(t))Fe(e,"data-"+t);else for(G=0,U=e.attributes,Y=U.length;Y>G;++G)U[G]&&"data-"===U[G].name.slice(0,5)&&Fe(e,U[G].name)}function _e(e){return e&&e.preventDefault(),!1}function De(e,t,n){if(t){for(e=Le(e),G=0,U=e.length;U>G;++G)t.addEventListener(e[G],n,!1),Ie("on:"+e[G],n,Je(t));return s}}function Be(e,t,n){if(t){for(e=Le(e),G=0,U=e.length;U>G;++G)t.removeEventListener(e[G],n,!1),Re("on:"+e[G],Je(t));return x(t)&&t.id.split(":")[0]===xt+"-dom"&&Fe(t,"id"),s}}function Ge(e,t,n){e=Le(e);var i,r="createEvent"in l;for(G=0,U=e.length;U>G;++G)r?(i=l.createEvent("HTMLEvents"),i.data=n,i.initEvent(e[G],!0,!1),t.dispatchEvent(i)):Ce("on:"+e[G],n,Je(t));return s}function Ue(e,t,n){for(G=0,U=t.length,Y;U>G;++G)Y=t[G],e=e.replace(A(Y)?Y:b(p(Y),"g"),n&&n[G]||"");return e}function Ye(e,t){return e.replace(/%(\d+)/g,function(e,n){return--n,L(t[n])?t[n]:e})}function We(e){return v(Ue(e,[/[^ \/a-z\d-]/g,/([ -])+/g,/^-|-$/g],["-","$1",""]))}function Pe(e,t){var n=t.touches?t.touches[0].pageX:t.pageX,r=t.touches?t.touches[0].pageY:t.pageY,i=je(e);return{x:n-i.l,y:r-i.t}}function je(e){for(W=e.offsetLeft,Z=e.offsetTop;e=e.offsetParent;)W+=e.offsetLeft,Z+=e.offsetTop;return{l:W,t:Z}}function Ke(e){return{w:e.offsetWidth,h:e.offsetHeight}}function qe(e,t){for(;(e=rt(e))&&e!==t;);return e}function Xe(e,t){t=Le(t);for(G in t)e.classList.add(t[G])}function Ve(e,n,r){if(O(n))return Ve(e,[n],L(r)?r:"")[0];t=[];for(G in n)G=n[G],e.classList.contains(G)&&t.push(G);return t.length?t:L(r)?r:!1}function Ze(e,t){if(L(t)){t=Le(t);for(G in t)e.classList.remove(t[G])}else Fe(e,"class")}function Qe(e,t,n){if(e=O(e)?l.createElement(e):e,$(n))for(G in n)if(J=n[G],"classes"===G)Xe(e,J);else if("data"===G)for(U in J)J=J[U],null===J?ze(e,U):He(e,U,J);else"css"===G?O(J)?Ne(e,"style",J):null===J?Fe(e,"style"):c(e,J):E(J)?e[G]=J:null===J?Fe(e,G):Ne(e,G,$(J)?J.join(" "):""+J);if(x(t))bt(e,t);else if($(t))for(G in t)J=t[G],x(J)?bt(e,J):J!==!1&&et(e,J);else L(t)&&t!==!1&&et(e,t);return e}function Je(e){var t=e.id;return t||(t=xt+"-dom:"+Date.now(),e.id=t),t}function et(e,t){e.innerHTML=t}function tt(e,t){return e.innerHTML||(L(t)?t:"")}function nt(e,t){if(t!==!1&&(H=it(e)))for(G=0,U=H.length;U>G;++G)nt(H[G]);et(e,"")}function rt(e){return e&&e.parentNode}function it(e){return e&&e.children||[]}function ot(e){return e&&e.nextSibling}function ft(e){return e&&e.previousSibling}function ut(e){for(G=0;e=ft(e);)++G;return G}function lt(e,t){return e&&O(t)?e.nodeName.toLowerCase()===t.toLowerCase():e&&E(t)?e===t(e):e===t}function st(e,n){if(!(n=L(n)?n:l))return[];if(t=[],O(e)){if(/^([#.]?[\w-]+|\*)$/.test(e)){if("#"===e[0]&&(e=n.getElementById(e.slice(1))))return[e];if("."===e[0]&&(e=n.getElementsByClassName(e.slice(1)))||(e=n.getElementsByTagName(e))){for(G=0,U=e.length;U>G;++G)t.push(e[G]);return t}return[]}for(e=n.querySelectorAll(e),G=0,U=e.length;U>G;++G)t.push(e[G]);return t}return at(e)?[e]:[]}function at(e,t){var n=rt(e);return 1===arguments.length?n||!1:e&&n===e?n:!1}function ct(e,t){K=rt(e),K&&K.insertBefore(t,e)}function dt(e,t){K=rt(e),K&&K.insertBefore(t,ot(e))}function pt(e,t){H=it(e)[0],H?ct(H,t):bt(e,t)}function ht(e,t){bt(e,t)}function bt(e,t){e.appendChild(t)}function gt(e,t){var n=at(e);if(n){if(t!==!1)for(H=it(e)[0];H;)gt(H);n.removeChild(e)}}function mt(e){nt(Qe(e,!1,{style:""})),gt(e)}function vt(e,t,n){return Qe(t||"div",n,{"class":e})}function Pt(e){return!e||L(e.active)&&!e.active}function jt(e,t,n){return E(e)&&(e={click:e}),O(e.click)&&(e.click=(n[e.click]||{}).click),L(e.title)||(e.title=Et[t]||""),L(e.attributes)||(e.attributes={}),n[t]=e,e}function Kt(e){yt.exit(0,0,0);var t=Me(this,"tool-id"),n=yt.tools,r=n[t];return yt.drop.target=e.currentTarget||e.target,!Pt(r)&&E(U=r.click)&&(U=U(e,s,t),Ce("on:change",[e,s,t]),U===!1)?_e(e):(s.select(),_e(e))}function qt(e){if(Z=this,(Y=e.TE.key)(/^(escape|f10)$/))yt.exit(1);else if(Y("enter")||Y("arrowdown")&&Me(Z,"ui-drop"))yt.drop.target=Z,Ge(oe,Z,[e]);else if(Y("arrowright")&&(W=ot(Z))){for(;!lt(W,"a")&&W;)W=ot(W);W&&W.focus()}else if(Y("arrowleft")&&(W=ft(Z))){for(;!lt(W,"a")&&W;)W=ft(W);W&&W.focus()}return _e(e)}function Xt(){nt(Ct,!1);var r,i,o,f,u,l,a,e=Le(N.tools),t=xt+"-button",n=xt+"-separator";N.tools=e;for(l in e)a=e[l],i=yt.tools[a],(i||i==={})&&(i=jt(i,a,yt.tools),o=i.i||a,"|"!==o&&"<"!==o[0]&&(o=We(o)),f="|"!==o,u=We(o).replace(/\s/g,""),Yt=vt(f?t+" "+t+"-"+u:n+" "+n+"-"+l,f?"a":"span"),f?(Yt=i.target||Yt,r=t+":"+u,Ne(Yt,{href:$e,id:r,tabindex:-1}),He(Yt,"tool-id",a),o="<"===o[0]?o:'<i class="'+Ye(kt,[o])+'"></i>',Pt(i)&&Xe(Yt,"x"),i.text&&(o=Ye('<span class="'+xt+'-text">'+i.text+"</span>",[o]),Xe(Yt,"text")),et(Yt,o),Qe(Yt,!1,i.attributes),!i.attributes.title&&(U=i.title)&&(Yt.title=$(U)?U[0]+(U[1]?" ("+U[1]+")":""):U),De(oe,Yt,Kt),De(ae,Yt,qt)):Yt.id=n+":"+l,i.target=Yt,bt(Ct,Yt));Ce("update.tools",[s])}function Vt(){yt.keys=function(){var n,e=Object.keys(yt.keys).sort().reverse(),t={};for(G=0,U=e.length;U>G;++G)n=e[G],t[n]=yt.keys[n];return t}(),en(),Ce("update.keys",[s])}function Jt(e){function d(e){return e.replace(/\+/g,"\n").replace(/\n\n/g,"\n+").split("\n")}var n=s.$(),r=n.before,i=n.after,o=r.slice(-1),f=i[0],u=n.length,l=yt.keys,a=TE.keys_alias,c=(r.match(/(?:^|\n)([\t ]*).*$/)||[""]).pop();j=e.TE.key(),Zt[j]=1,t=Object.keys(Zt).length,m(function(){s.record()});for(G in l){Y=d(G),H=0;for(U in Y)U=Y[U],Zt[a[U]||U]&&++H;if(Y=Y.length,H===Y&&t===Y&&(O(l[G])&&(l[G]=yt.tools[l[G]].click),W=l[G]&&l[G](e,s),W===!1))return _e(e)}if(me)for(G in me)if(P=me[G],P!==!1){if(j===P&&f===P)return"\\"===o?(s.insert(j,0),_e(e)):(s.select(n.end+1),_e(e));if(G===j)return s.wrap(G,P),_e(e);if(o===G&&f===P){if("backspace"===j&&r.slice(-2)!=="\\"+G)return s.unwrap(G,P),_e(e);if(ve&&"enter"===j&&G!==P)return s.tidy("\n"+c+we,"\n"+c),_e(e)}}if(ve&&!u){if("backspace"===j&&b(p(we)+"$").test(r))return s.outdent(we),_e(e);if("enter"===j&&b("(^|\\n)("+p(we)+")+.*$").test(r))return s.insert("\n"+c,0,1),_e(e)}}function en(e){e&&e.TE&&e.TE.key?delete Zt[e.TE.key()]:Zt={}}function fn(e){return tn=St,V=Ke(Rt),_e(e)}function un(e){tn===St&&c(Nt,{height:Pe(It,e).y-V.h+Ae})}function ln(){tn=0}function sn(){yt.exit(1)}function an(){t=Ke(zt),ee=t.w,B=t.h,t=Ke(Mt),nn=t.w,rn=t.h}function cn(e,t){t&&Ce("exit.modal."+t,[s]),Ge(oe,Mt,[e])}function dn(e){tn=e.target,t=Pe(zt,e),te=t.x,ne=t.y,an()}function pn(e){var n=on.header,r=on.resize;tn===n||qe(tn,n)===n?(t=Pe(It,e),W=t.x-te,Z=t.y-ne,c(zt,{left:(ee>nn?W:d(W,0,nn-ee))+Ae,top:(B>rn?Z:d(Z,0,rn-B))+Ae})):tn===r&&(t=Pe(zt,e),V=Ke(r),c(zt,{width:t.x+V.w/4+Ae,height:t.y+V.h/4+Ae}))}function hn(){tn=0}function bn(e,t,n){return{header:e,body:t,footer:n}}function gn(t){S=yt.drop.target,F=_t,H=t&&t.target||0,(!H||H!==S&&qe(H,S)!==S)&&(yt.drop.target=0,mt(_t),Be(oe,l,gn),Be(ge,u,gn),yt.exit(t.target===e))}var S,F,H,_,B,G,U,Y,W,P,j,t,K,X,V,Z,J,ee,te,ne,n="⌘",r="…",o="⇥",f="⇧",u=window,l=document,s=new TE(e),a=s._,c=a.css,d=a.edge,p=a.x,h=a.extend,b=a.pattern,m=(a.timer.reset,a.timer.set),v=a.trim,y={},w=function(){},k=TE.is,x=k.e,E=k.f,T=k.i,$=k.o,A=k.r,L=function(e){return!k.x(e)},O=k.s,I=l.documentElement,C=(l.head,l.body),N=h({tab:"  ",dir:"ltr",resize:1,keys:1,tools:"indent outdent | undo redo",attributes:{spellcheck:"false"},css:"html,body{background:#fff;color:#000}",unit:[[["<",">","/"],["=",'"','"'," "]],[["\\u003C","\\u003E","\\u002F"],["\\u003D","\\u0022","\\u0022","\\u0020"]]],auto_tab:1,auto_close:{'"':'"',"'":"'","(":")","{":"}","[":"]","<":">"},languages:{tools:{tools:["Focus Tools","F10"],undo:["Undo",n+"+Z"],redo:["Redo",n+"+Y"],indent:["Indent",o],outdent:["Outdent",f+"+"+o]},buttons:{okay:"OK",cancel:"Cancel",yes:"Yes",no:"No",enter:"Enter",exit:"Exit",open:"Open",close:"Close",ignore:"Ignore"},placeholders:{"":"text here"+r},labels:{},others:{}},classes:{"":"text-editor",i:"icon icon-%1 fa fa-%1"},debounce:500},t),ie="blur",oe="click",ae="keydown",ce="keyup",de="touchstart mousedown",pe="touchmove mousemove",he="touchend mouseup",ge="orientationchange resize",me=N.auto_close,ve=N.auto_tab,ye=N.languages,we=N.tab,xe=(N.unit[0][1],N.unit[0][0]),Ee=N.unit[1][1],Te=N.unit[1][0],$e="javascript:;",Ae="px",yt=s.ui={};s.tidy=function(e,t){var n=s.$(),r=v(n.before)?e:"",i=v(n.after)?L(t)?t:e:"";return s.trim(r,i)},s.i=function(){return v(s.replace(/\s+/g," "))},s.format=function(e,t,n,r){$(e)||(e=[e]),L(n)||(n=" "),L(r)||(r="");var i=s.h,o=s[0]().$(),f=(e[0]?xe[0]+e[0]+xe[1]:"")+r,u=r+(e[0]?xe[0]+xe[2]+(e[1]||e[0].split(b("("+Ee[3]+")+"))[0])+xe[1]:""),l=p(f),a=p(u),c=b("^"+l+"([\\s\\S]*?)"+a+"$"),d=b(l+"$"),h=b("^"+a),g=o.before,m=o.after;return o.length?n=!1:s.insert(ye.placeholders[""]),s.toggle(t?!c.test(o.value):!d.test(g)&&!h.test(m),[function(e){e.unwrap(f,u,1).tidy(b(Te[0]+"[^"+Te[0]+Te[1]+Te[2]+"]+?"+Te[1]+"$").test(g)?"":n,b("^"+Te[0]+Te[2]+"[^"+Te[0]+Te[1]+"]+?"+Te[1]).test(m)?"":n).wrap(f,u,t)},function(e){e.unwrap(f,u,t)}])[i]()};var Yt,wt=N.classes,kt=wt.i,xt=wt[""],Et=ye.tools,Tt=ye.buttons,$t=ye.labels,At=xt+"-textarea "+xt+"-content block",Lt=vt(xt),Ot=vt(xt+"-header"),It=vt(xt+"-body"),Rt=vt(xt+"-footer"),Ct=vt(xt+"-tool"),Nt=Qe(e,!1,N.attributes),St=vt(xt+"-resize s"),Ft=vt(xt+"-description"),Ht=vt(xt+"-panel"),Mt=vt(xt+"-overlay"),zt=Qe("div"),_t=Qe("div"),Dt=Qe("div"),Bt=vt("left","span"),Gt=vt("right","span"),Ut=0;L(N.suffix)||(N.suffix=xe[1]);var Zt={},tn=0,te=0,ne=0,ee=0,B=0,nn=0,rn=0,on={};s.create=function(e,t){$(e)&&(N=h(N,e));var n=at(Nt);return Xe(Nt,At),n&&lt(n,"p")?(ct(n,Lt),Ut=n,gt(n,!1)):ct(Nt,Lt),Lt.dir=N.dir,bt(Lt,Ot),bt(Lt,It),bt(Lt,Rt),bt(It,Nt),N.tools&&(bt(Ot,Ct),bt(Rt,Ft),bt(Ft,Bt),bt(Ft,Gt)),De(ae,Nt,Jt),De(ce+" "+ie,Nt,en),N.resize&&(bt(Lt,St),Xe(Lt,xt+"-is-can-resize"),De(de,St,fn),De(pe,l,un),De(he,C,ln)),Xt(),Vt(),0!==t?Ce("create",[s]):s},s.update=function(e,t){return Ve(Nt,Le(At),0)&&s.destroy(0),(0!==t?Ce("update",[s]):s).create(e,0)},s.destroy=function(e){return Ve(Nt,Le(At),0)?(yt.exit(0,0,0),Ze(Nt,At),N.tools=Oe(N.tools),N.keys&&(Be(ae,Nt,Jt),Be(ce,Nt,en)),N.resize&&(Be(de,St,fn),Be(pe,l,un),Be(he,l,ln)),Ut?(ct(Lt,Ut),bt(Ut,Nt),Ut=0):ct(Lt,Nt),mt(Lt),0!==e?Ce("destroy",[s]):s):s},yt.exit=function(e,t,n){if(_={panel:function(){mt(Ht)},overlay:function(){Be(oe,Mt,sn),mt(Mt)},modal:function(){Be(de,It,dn),Be(pe,It,pn),Be(he,l,hn),Be(oe,on.x,cn),mt(zt)},drop:function(){mt(_t)},bubble:function(){mt(Dt)}},t)if($(t))for(G in t)G=t[G],_[G]&&_[G](),0!==n&&Ce("exit."+G,[s]);else _[t]&&_[t](),0!==n&&Ce("exit."+G,[s]);else for(G in _)_[G]();return e&&s.select(),0!==n&&Ce("exit",[s]),s},yt.panel=function(e,t){function n(){Be(oe,te,n),yt.panel.exit(1)}return yt.exit(0,0,0),en(),te=vt(xt+"-x"),te.title=Tt.close,De(oe,te,n),bt(It,Qe(Ht,[vt(xt+"-panel-content","div",e),te])),E(t)?t(Ht):Qe(Ht,t),Ce("enter.panel",[s]),Ce("enter",[s]),s},yt.panel.fit=function(){},yt.overlay=function(e,t){return yt.exit(0,0,0),en(),bt(It,Mt),e&&De(oe,Mt,sn),E(t)?t(Mt):Qe(Mt,t),Ce("enter.overlay",[s]),Ce("enter",[s]),s},yt.overlay.fit=function(){},yt.modal=function(){yt.overlay(1).blur();var f,u,e=arguments,t=e[0],n=e[1],r=e[2],i=xt+"-modal",o=n.footer;if($(t)&&(t="default",n=e[0],r=e[1]),W=We(t),Qe(zt,!1,{"class":i+" "+W}),L(n.body)&&(n.body=Qe("div",n.body,{"class":i+"-content "+W})),L(o)&&$(o)&&!x(o)){u=[];for(G in o)U=o[G],x(U)?u.push(U):(U=jt(U,G,o),t=G.text||Tt[G]||G,f=Qe("button",t,h({name:"y["+G+"]",type:"button","class":xt+"-button",data:{"button-id":G}},U.attributes)),De(oe,f,function(e){return t=o[Me(this,"button-id")].click(e,s),t===!1?_e(e):void 0}),u.push(f));n.footer=u}for(G in n)i[1]=G,on[G]=vt(i+"-"+Ye(G,i)+" "+W,0,n[G]);return on.x=vt(xt+"-x "+W),on.resize=vt(xt+"-resize se "+W),nt(zt),on.x.title=Tt.close,bt(It,Qe(zt,on,{style:""})),yt.modal.fit(),dt(zt,Mt),De(oe,on.x,cn),De(de,on.header,_e),De(de,on.resize,_e),De(de,It,dn),De(pe,It,pn),De(he,l,hn),E(r)&&(on.overlay=Mt,on.modal=zt,r(on)),Ce("enter.modal."+t,[s]),Ce("enter.modal",[s]),Ce("enter",[s]),s},yt.modal.fit=function(e){return an(),W=nn/2-ee/2,Z=rn/2-B/2,$(e)?(L(e[0])&&(W=e[0]),L(e[1])&&(Z=e[1])):(W=d(W,0),Z=d(Z,0)),c(zt,{left:W+Ae,top:Z+Ae,"min-width":ee+Ae,"min-height":B+Ae,visibility:"visible"}),Ce("fit.modal",[s]),Ce("fit",[s]),s};var mn={"class":xt+"-button",name:"y"};return yt.alert=function(e,t,n,r){var i=Qe("button",Tt.okay,mn),o="alert";return n=n||w,$(e)&&(o+=":"+e[0],e=e[1]||e[0]),De(oe,i,function(e){return n(e,s),cn(e,o+".y"),_e(e)}),De(ae,i,function(e){var t=e.TE.key;return t(/^(escape|enter)$/)?(Ge(oe,i,[e]),_e(e)):void 0}),yt.modal(o,bn(e,t,i),r),i.focus(),s},yt.confirm=function(e,t,n,r,i){function a(e){return E(n)&&n(e,s),cn(e,u+".y"),_e(e)}function c(e){return E(r)&&r(e,s),cn(e,u+".n"),_e(e)}var l,o=Qe("button",Tt.okay,mn),f=Qe("button",Tt.cancel,mn),u="confirm";return f.name="n",$(e)&&(u+=":"+e[0],e=e[1]||e[0]),De(oe,o,a),De(oe,f,c),De(ae,o,function(e){return l=e.TE.key,l("arrowright")?(f.focus(),_e(e)):l("arrowleft")?_e(e):l("enter")?(a(e),_e(e)):l("escape")?(cn(e,u+".y"),_e(e)):void 0}),De(ae,f,function(e){return l=e.TE.key,l("arrowright")?_e(e):l("arrowleft")?(o.focus(),_e(e)):l("enter")?(c(e),_e(e)):l("escape")?(cn(e,u+".n"),_e(e)):void 0}),yt.modal(u,bn(e,t,[o,f]),i),f.focus(),s},yt.prompt=function(e,t,n,r,i,o){function h(){l.focus(),"placeholder"in l&&l.select()}function b(e){return _e(e)}function g(e){return d=l.value,!n||v(d)&&d!==t?(cn(e,a+".y"),_e(e),r(e,s,d!==t?d:"",t)):(h(),b(e))}function m(e){return cn(e,a+".n"),_e(e)}var d,p,f=Qe("button",Tt.okay,mn),u=Qe("button",Tt.cancel,mn),l=Qe("input",!1,{type:"text",value:t,placeholder:t,spellcheck:"false","class":xt+"-input block"}),a="prompt",c=[];if($(e)&&(a+=":"+e[0],e=e[1]||e[0]),E(i)&&(o=i,i=0),1===i)l=Qe("textarea",t,{placeholder:t.split("\n")[0],"class":xt+"-textarea block"});else if(2===i){for(G in t)c.push(Qe("option",t[G],{value:G,selected:G===n||null}));l=Qe("select",c,{"class":xt+"-select block"})}return r=r||w,l.name="data",u.name="n",De(ae,l,function(e){return p=e.TE.key,p("enter")?g(e):p("escape")||p("backspace")&&!this.value?m(e):p("arrowup")?b(e):p("arrowdown")?(f.focus(),_e(e)):void 0}),De(ae,f,function(e){return p=e.TE.key,p("enter")?g(e):p("escape")?m(e):p("arrowup")?(l.focus(),_e(e)):p("arrowright")?(u.focus(),_e(e)):p(/^arrow(down|left)$/)?b(e):void 0}),De(ae,u,function(e){return p=e.TE.key,p(/^(enter|escape)$/)?m(e):p("arrowup")?(l.focus(),_e(e)):p(/^arrow(right|down)$/)?b(e):p("arrowleft")?(f.focus(),_e(e)):void 0}),De(oe,f,g),De(oe,u,m),yt.modal(a,bn(e,l,[f,u]),o),h(),s},yt.drop=function(){yt.exit(0,0,0);var e=arguments,t=e[0],n=e[1];return 1===e.length&&(t="default",n=e[0]),W=We(t),nt(_t),bt(C,Qe(_t,!1,{"class":xt+"-drop "+W})),E(n)?n(_t):Qe(_t,n),yt.drop.fit(),De(oe,l,gn),De(ge,u,gn),Ce("enter.drop."+t,[s]),Ce("enter.drop",[s]),s},yt.drop.fit=function(e){return S=Ke(I),F=Ke(_t),H=yt.drop.target,W=S.w/2-F.w/2,Z=S.h/2-F.h/2,!L(e)&&H&&(t=je(H),W=t.l,Z=t.t+Ke(H).h),$(e)?(L(e[0])&&(W=e[0]),L(e[1])&&(Z=e[1])):(W=d(W,0,Math.max(S.w,u.innerWidth)-F.w),Z=d(Z,0,Math.max(S.h,u.innerHeight)-F.h)),c(_t,{left:W+Ae,top:Z+Ae,visibility:"visible"}),Ce("fit.drop",[s]),Ce("fit",[s]),s},yt.menu=function(e,t,n,r){t=!$(t)&&n[t]&&n[t].text||t;var l,i=yt.tools,o='<span class="'+xt+'-current menu">%1</span>',f="",u=0;return t===!1?yt.tool(e,t):($(t)&&(f=t[0],f="<"===f[0]?f:'<i class="'+Ye(kt,[f])+'"></i>',t=L(t[1])?t[1]:0,t=t&&n[t]&&n[t].text||t,o=f+(0!==t?" "+o:"")),yt.tool(e,{i:f,text:t?Ye(o,[t,f]):0,click:function(a){var c=yt.drop.target=i[e].target;return yt.drop("menu menu-"+We(e),function(a){function d(e){return Z=this,P=n[Me(Z,"tool-id")],P=O(P)?i[P]:P||{},j=tt(Z),!Pt(P)&&E(r=P.click)&&(r=r(e,s),t!==!1&&c&&(H=it(c)[0]||c,lt(H,"i")||et(H,Ye(o,[j,f])),$(P.text)&&(H=it(H)[0])&&lt(H,"i")&&(Ze(H),Xe(H,Ye(kt,[P.text[0]])))),r===!1)?_e(e):(s.select(),_e(e))}function p(e){if(Z=this,(Y=e.TE.key)("escape"))yt.exit(1);else if(Y("enter"))Ge(oe,Z,[e]);else if(Y("f10")&&c)c.focus();else if(Y("arrowdown")&&(W=ot(Z))){for(;!lt(W,"a")&&W;)W=ot(W);W&&W.focus()}else if(Y("arrowup")&&(W=ft(Z))){for(;!lt(W,"a")&&W;)W=ft(W);!W&&c?(yt.exit(),c.focus()):W&&W.focus()}else Y("arrowup")&&c&&(yt.exit(),c.focus());return _e(e)}for(r in n)if(l=n[r],ee="%"===r[0],l=O(l)&&!ee?i[l]:l){l=jt(l,r,i);var b={href:ee?null:$e,"class":xt+"-"+(ee?"label":"button")};ee?U=$t[e]&&$t[e][+r.slice(1)-1]||r:(b.data={},b.data["tool-id"]=r,U=Et[r]||r),X=l.text,X=$(X)?X[1]||"":X,U=$(U)?U[0]:U,V=Qe(ee?"span":"a",ee?"<span>"+(U||"%"+u)+"</span>":l.text||U,h(b,l.attributes||{})),!b.title&&(Z=l.title)&&(V.title=$(Z)?Z[0]+(Z[1]?" ("+Z[1]+")":""):Z),ee?Ne(V,{id:xt+"-label:"+u}):(Pt(l)&&Xe(V,"x"),De(oe,V,d),De(ae,V,p)),n[r]=l,bt(a,V),++u}m(function(){st("a",a)[0].focus()},1)}),!1}},r),He(i[e].target,"ui-drop",e),i[e].data=n,s)},yt.bubble=function(){yt.exit(0,0,0);var e=arguments,t=e[0],n=e[1];return 1===e.length&&(t="default",n=e[0]),W=We(t),nt(Dt),bt(C,Qe(Dt,!1,{"class":xt+"-bubble "+W})),E(n)?n(Dt):Qe(Dt,n),yt.bubble.fit(),Ce("enter.bubble."+t,[s]),Ce("enter.bubble",[s]),s},yt.bubble.fit=function(e){V=s.$(1),t=je(Nt),B=c(Nt,"line-height");var n="border-",r="-width";W=V.caret[0].x+t.l-Nt.scrollLeft,Z=V.caret[1].y+t.t+B-Nt.scrollTop,F=c(It,[n+"top"+r,n+"bottom"+r,n+"left"+r,n+"right"+r]);var i=Ke(It),o=Ke(Dt),f=F[0]+F[1],u=F[2]+F[3];return $(e)?(L(e[0])&&(W=e[0]),L(e[1])&&(Z=e[1])):(W=d(W,t.l,t.l+i.w-o.w-u),Z=d(Z,t.t,t.t+i.h-o.h-f)),c(Dt,{left:W+Ae,top:Z+Ae,visibility:"visible"}),Ce("fit.bubble",[s]),Ce("fit",[s]),s},yt.panel.exit=function(e){return yt.exit(e,"panel")},yt.overlay.exit=function(e){return yt.exit(e,"overlay")},yt.modal.exit=function(e){return yt.exit(e,"modal")},yt.drop.exit=function(e){return yt.exit(e,"drop")},yt.bubble.exit=function(e){return yt.exit(e,"bubble")},yt.tool=function(e,t,n){return U="","|"!==e&&(N.tools=Le(N.tools).filter(function(t,n){return t===e?(U=n,!1):!0})),t===!1?delete yt.tools[e]:("|"===e?(n=t,t={}):(E(t)&&(t={click:t}),yt.tools[e]=h(yt.tools[e]||{},t),L(n)||""===U||(n=U)),T(n)?N.tools.splice(n,0,e):N.tools.push(e)),Xt(),s},yt.key=function(e,t){return N.keys?(t===!1?delete yt.keys[e]:yt.keys[e]=t,Vt(),s):s},yt.tools={"|":{},undo:{i:"undo",click:function(e,t){return t.undo(),!1}},redo:{i:"repeat",click:function(e,t){return t.redo(),!1}},indent:function(e,t){return t.indent(we),!1},outdent:function(e,t){return t.outdent(we),!1}},yt.keys={"control+y":"redo","control+z":"undo",f10:function(e,t){return st("a",Ct)[0].focus(),!1},"shift+tab":ve?"outdent":0,tab:ve?"indent":0},yt.el={container:Lt,header:Ot,body:It,footer:Rt,overlay:Mt,modal:zt,drop:_t,bubble:Dt},s.config=N,h(TE._,{time:function(){var e=new Date,t=e.getFullYear(),n=e.getMonth()+1,r=e.getDate(),i=e.getHours(),o=e.getMinutes(),f=e.getSeconds(),u=e.getMilliseconds();return 10>n&&(n="0"+n),10>r&&(r="0"+r),10>i&&(i="0"+i),10>o&&(o="0"+o),10>f&&(f="0"+f),10>u&&(u="0"+u),[""+t,""+n,""+r,""+i,""+o,""+f,""+u]},replace:Ue,format:Ye,dom:{set:bt,reset:gt,get:st,id:Je,copy:function(e,t){return e.cloneNode(L(t)?t:!0)},classes:{set:Xe,reset:Ze,get:Ve},attributes:{set:Ne,reset:Fe,get:Se},data:{set:He,reset:ze,get:Me},is:lt,offset:je,pointer:Pe,size:Ke,content:{set:et,reset:nt,get:tt},closest:qe,parent:rt,children:it,next:ot,previous:ft,index:ut,before:ct,after:dt,prepend:pt,append:ht},el:Qe,event:{set:De,reset:Be,fire:Ge,x:_e}}),h(s._,TE._),h(s._,{hooks:y,hook:{set:Ie,reset:Re,fire:Ce}}),s.create()};