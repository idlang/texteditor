/*!
 * ==========================================================
 *  USER INTERFACE MODULE FOR TEXT EDITOR PLUGIN 1.8.0
 * ==========================================================
 * Author: Taufik Nurrohman <https://github.com/tovic>
 * License: MIT
 * ----------------------------------------------------------
 */
TE.ui=function(e,t){function Fe(e){return $(e)?k(e).split(/\s+/):e}function ze(e){return _(e)?e.join(" "):e}function Ke(e,t){return-1!==e.indexOf(t)}function De(e){return e.length}function Re(e){return Object.keys(e)}function Be(e){return De(Re(e))}function He(e,t,n){return M(e)?M(t)?(M(y[e])||(y[e]={}),M(n)||(n=Be(y[e])),y[e][n]=t,f):y[e]:y}function Oe(e,t){return M(e)?M(t)&&M(y[e])?(delete y[e][t],f):(y[e]={},f):(y={},f)}function Se(e,t,n){if(!M(y[e]))return y[e]={},f;if(M(n))M(y[e][n])&&y[e][n].apply(f,t);else for(U in y[e])y[e][U].apply(f,t);return f}function je(e,t,n){if(_(t))for(U in t)je(e,U,t[U]);else e[(null===n?"remove":"set")+"Attribute"](t,n)}function Ge(e,n,i){if($(n))return Ge(e,[n],M(i)?i:"")[0];t=[];for(U in n)U=n[U],(U=e.getAttribute(U))&&t.push(U);return De(t)?t:M(i)?i:[]}function Pe(e,t){if(_(t))for(U in t)Pe(e,t[U]);else if(M(t))e.removeAttribute(t);else for(Pe(e,"class"),U=0,A=e.attributes,I=De(A);I>U;++U)A[U]&&Pe(e,A[U].name)}function Je(e,t,n){if(_(t))for(U in t)Je(e,U,t[U]);else je(e,"data-"+t,n)}function Ne(e,n,i){if($(n))return Ne(e,[n],M(i)?i:"")[0];t=[];for(U in n)U=n[U],(U=Ge(e,"data-"+U))&&t.push(U);return De(t)?t:M(i)?i:[]}function Ue(e,t){if(_(t))for(U in t)Pe(e,"data-"+t[U]);else if(M(t))Pe(e,"data-"+t);else for(U=0,A=e.attributes,I=De(A);I>U;++U)A[U]&&"data-"===A[U].name.slice(0,5)&&Pe(e,A[U].name)}function Ae(e){return e&&e.preventDefault(),!1}function Ie(e,t,n){if(t){for(e=Fe(e),U=0,A=De(e);A>U;++U)t.addEventListener(e[U],n,!1),He("on:"+e[U],n,lt(t));return f}}function Ye(e,t,n){if(t){for(e=Fe(e),U=0,A=De(e);A>U;++U)t.removeEventListener(e[U],n,!1),Oe("on:"+e[U],lt(t));return w(t)&&t.id.split(":")[0]===$t+"-dom"&&Pe(t,"id"),f}}function Xe(e,t,n){e=Fe(e);var r,i="createEvent"in s;for(U=0,A=De(e);A>U;++U)i?(r=s.createEvent("HTMLEvents"),r.data=n,r.initEvent(e[U],!0,!1),t.dispatchEvent(r)):Se("on:"+e[U],n,lt(t));return f}function qe(e,t,n){for(U=0,A=De(t),I;A>U;++U)I=t[U],e=e.replace(L(I)?I:h(p(I),"g"),n&&n[U]||"");return e}function We(e,t){return e.replace(/%(\d+)/g,function(e,n){return--n,M(t[n])?t[n]:e})}function Ze(e){return k(qe(e.toLowerCase(),[/[^ \/a-z\d-]/g,/([ -])+/g,/^-|-$/g],["-","$1",""]))}function Qe(e,t){var n=t.touches?t.touches[0].pageX:t.pageX,i=t.touches?t.touches[0].pageY:t.pageY,r=Ve(e);return{x:n-r.l,y:i-r.t}}function Ve(e){for(Y=e.offsetLeft,ee=e.offsetTop;e=e.offsetParent;)Y+=e.offsetLeft,ee+=e.offsetTop;return{l:Y,t:ee}}function et(e){return e===l?{w:e.innerWidth,h:e.innerHeight}:{w:e.offsetWidth,h:e.offsetHeight}}function tt(e,t){for(;(e=ct(e))&&e!==t;);return e}function nt(e,t){t=Fe(t);for(U in t)e.classList.add(t[U])}function it(e,n,i){if($(n))return it(e,[n],M(i)?[i]:[""])[0];t=[];for(U in n)U=n[U],e.classList.contains(U)&&t.push(U);return De(t)?t:M(i)?i:!1}function rt(e,t){if(M(t)){t=Fe(t);for(U in t)e.classList.remove(t[U])}else Pe(e,"class")}function at(e,t){t=Fe(t);for(U in t)e.classList.toggle(t[U])}function ot(e,t,n){if(e=e||"div",e=$(e)?s.createElement(e):e,_(n))for(U in n)if(ne=n[U],"classes"===U)nt(e,ne);else if("data"===U)for(A in ne)ne=ne[A],null===ne?Ue(e,A):Je(e,A,ne);else"css"===U?$(ne)?je(e,"style",ne):null===ne?Pe(e,"style"):c(e,ne):E(ne)?e[U]=ne:null===ne?Pe(e,U):je(e,U,T(ne)?ne.join(" "):""+ne);if(w(t))Tt(e,t);else if(_(t))for(U in t)ne=t[U],w(ne)?Tt(e,ne):ne!==!1&&st(e,ne);else M(t)&&t!==!1&&st(e,t);return e}function lt(e){var t=e.id;return t||(t=$t+"-dom:"+Math.floor(Date.now()*Math.random()),e.id=t),t}function st(e,t){e.innerHTML=t}function ft(e,t){return e.innerHTML||(M(t)?t:"")}function ut(e,t){if((!M(t)||t)&&(S=dt(e)))for(U=0,A=De(S);A>U;++U)ut(S[U]);st(e,"")}function ct(e){return e&&e.parentNode}function dt(e){return e&&e.children||[]}function pt(e){return e&&e.nextSibling}function bt(e){return e&&e.previousSibling}function ht(e){for(U=0;e=bt(e);)++U;return U}function gt(e,t){return e&&$(t)?e.nodeName.toLowerCase()===t.toLowerCase():e&&E(t)?e===t(e):e===t}function mt(e,n){if(!(n=M(n)?n:s))return[];if(t=[],$(e)){if(/^([#.]?[\w-]+|\*)$/.test(e)){if("#"===e[0]&&(e=n.getElementById(e.slice(1))))return[e];if("."===e[0]&&(e=n.getElementsByClassName(e.slice(1)))||(e=n.getElementsByTagName(e))){for(U=0,A=De(e);A>U;++U)t.push(e[U]);return t}return[]}for(e=n.querySelectorAll(e),U=0,A=De(e);A>U;++U)t.push(e[U]);return t}return kt(e)?[e]:[]}function kt(e,t){var n=ct(e);return 1===De(arguments)?n||!1:e&&n===e?n:!1}function yt(e,t){W=ct(e),W&&W.insertBefore(t,e)}function vt(e,t){W=ct(e),W&&W.insertBefore(t,pt(e))}function xt(e,t){S=dt(e)[0],S?yt(S,t):Tt(e,t)}function wt(e,t){Tt(e,t)}function Tt(e,t){e.appendChild(t)}function Et(e,t){var n=kt(e);if(n){if(!M(t)||t)for(S=dt(e)[0];S;)Et(S);n.removeChild(e)}}function Ct(e){ut(ot(e,!1,{style:""})),Et(e)}function _t(e,t,n){return ot(t,n,{"class":e})}function en(e){return!e||M(e.active)&&!e.active}function tn(e,t,n){return E(e)&&(e={click:e}),$(e.click)&&(e.click=(n[e.click]||{}).click),e.title=Ft[t]||"",M(e.attributes)||(e.attributes={}),n[t]&&(n[t]=e),e}function nn(e){Lt.exit(0,0,0);var t=Ne(this,"tool-id"),n=Lt.tools,i=n[t];return Lt.drop.target=e.currentTarget||e.target,!en(i)&&E(A=i.click)&&(A=A(e,f,t),Se("on:change",[e,f,t]),A===!1)?Ae(e):(f.select(),Ae(e))}function rn(e){if(ee=this,(I=e.TE.key)(/^(escape|f10)$/))Lt.exit(1);else if(I("enter")||I("arrowdown")&&Ne(ee,"ui-drop"))Lt.drop.target=ee,Xe(se,ee,[e]);else if(I("arrowright")&&(Y=pt(ee))){for(;!gt(Y,"a")&&Y;)Y=pt(Y);Y&&Y.focus()}else if(I("arrowleft")&&(Y=bt(ee))){for(;!gt(Y,"a")&&Y;)Y=bt(Y);Y&&Y.focus()}return Ae(e)}function on(){ut(Gt,0);var r,a,o,l,s,u,c,e=Lt.tools,t=Fe(R.tools),n=$t+"-button",i=$t+"-separator";R.tools=t;for(u in t)c=t[u],a=e[c],(a||a==={})&&(a=tn(a,c,e),o=a.i||c,"|"===o||Ke(o,"<")||(o=Ze(o)),l="|"!==o,s=Ze(c).replace(/[\/\s]/g,"-"),Qt=_t(l?n+" "+n+"-"+s:i+" "+i+"-"+u,l?"a":"span"),l?(Qt=a.target||Qt,r=n+":"+s,je(Qt,{href:Me,id:r,tabindex:-1}),Je(Qt,"tool-id",c),o=Ke(o,"<")?o:Lt.i(s,o),en(a)?nt(Qt,"x"):rt(Qt,"x"),a.on?nt(Qt,"on"):rt(Qt,"on"),a.text&&(o=We('<span class="'+$t+'-text">'+a.text+"</span>",[o]),nt(Qt,"text")),st(Qt,o),ot(Qt,!1,a.attributes),!a.attributes.title&&(A=a.title)&&(Qt.title=_(A)?A[0]+(A[1]?" ("+A[1]+")":""):A),Ie(se,Qt,nn),Ie(pe,Qt,rn)):Qt.id=i+":"+u,a.target=Qt,(s=Ne(Qt,an))&&Lt.menu.set(c,s),Tt(Gt,Qt));Se("update.tools",[f])}function ln(){Lt.keys=function(){var n,e=Re(Lt.keys).sort().reverse(),t={};for(U=0,A=De(e);A>U;++U)n=e[U],t[n]=Lt.keys[n];return t}(),fn(),Se("update.keys",[f])}function sn(e){function b(e){return e.replace(/\+/g,"\n").replace(/\n\n/g,"\n+").split("\n")}var n=f.$(),i=n.before,r=n.after,a=i.slice(-1),o=r[0],l=n.length,s=Lt.keys,u=TE.keys_alias,c={control:0,shift:0,option:"alt",meta:0},d=(i.match(/(?:^|\n)([\t ]*).*$/)||[""]).pop();for(U in c)e.TE[U]()&&(B[c[U]||U]=1);q=e.TE.key(),B[q]=1,t=Be(B),m(function(){f.record()});for(U in s){I=b(U),S=0;for(A in I)A=I[A],B[u[A]||A]&&++S;if(I=De(I),S===I&&t===I&&($(s[U])&&(s[U]=Lt.tools[s[U]].click),Y=E(s[U])&&s[U](e,f),Y===!1))return Ae(e)}if(ve)for(U in ve)if(X=ve[U],X!==!1){if(q===X&&o===X)return"\\"===a?(f.insert(q,0),Ae(e)):(f.select(n.end+1),Ae(e));if(U===q)return f.wrap(U,X),Ae(e);if(a===U&&o===X){if("backspace"===q&&i.slice(-2)!=="\\"+U)return f.unwrap(U,X),Ae(e);if(xe&&"enter"===q&&U!==X&&!l)return f.tidy("\n"+d+Te,"\n"+d).scroll(1),Ae(e)}}if(xe&&!l){if("backspace"===q&&h(p(Te)+"$").test(i))return f.outdent(Te),Ae(e);if("enter"===q&&h("(^|\\n)("+p(Te)+")+.*$").test(i))return f.insert("\n"+d,0,1).scroll(1),Ae(e)}}function fn(e){e&&e.TE&&e.TE.key?delete B[e.TE.key()]:B={}}function bn(e){return un=Rt,V=et(jt),Ae(e)}function hn(e){un===Rt&&c(Pt,{height:Qe(St,e).y-V.h+$e})}function gn(){un=0}function mn(){Lt.exit(1)}function kn(){t=et(At),ie=t.w,N=t.h,t=et(Ut),cn=t.w,dn=t.h}function yn(e,t){return t&&Se("exit.modal."+t,[f]),Xe(se,Ut,[e]),Ae(e)}function vn(e){un=e.target,t=Qe(At,e),re=t.x,ae=t.y,kn()}function xn(e){var n=pn.header,i=pn.sizer;un===n||tt(un,n)===n?(t=Qe(St,e),Y=t.x-re,ee=t.y-ae,c(At,{left:(ie>cn?Y:d(Y,0,cn-ie))+$e,top:(N>dn?ee:d(ee,0,dn-N))+$e})):un===i&&(t=Qe(At,e),V=et(i),c(At,{width:t.x+V.w/4+$e,height:t.y+V.h/4+$e}))}function wn(){un=0}function Tn(e,t,n){return{header:e,body:t,footer:n}}function En(e){H=Lt.drop.target,O=It,S=e&&e.target||0,(!S||S!==H&&tt(S,H)!==H)&&(Lt.drop.target=0,Ye(se,s,En),Ye(ye,l,En),Lt.exit(e.target===Pt))}var H,O,S,P,N,U,A,I,Y,X,q,t,W,Q,V,ee,te,ne,ie,re,ae,n="⌘",i="…",a="⇥",o="⇧",l=window,s=document,f=new TE(e),u=f._,c=u.css,d=u.edge,p=u.x,b=u.extend,h=u.pattern,g=u.timer.reset,m=u.timer.set,k=u.trim,y={},v=function(){},x=TE.is,w=x.e,T=x.a,E=x.f,C=x.i,_=x.o,L=x.r,M=function(e){return!x.x(e)},$=x.s,F=s.documentElement,K=(s.head,s.body),R=(s.currentScript,b({tab:"  ",direction:"ltr",path:TE.path,resize:1,keys:1,tools:"indent outdent | undo redo",attributes:{spellcheck:"false"},unit:[[["<",">","/"],["=",'"','"'," "]],[["\\u003C","\\u003E","\\u002F"],["\\u003D","\\u0022","\\u0022","\\u0020"]]],auto_tab:1,auto_close:{'"':'"',"'":"'","(":")","{":"}","[":"]","<":">"},languages:{tools:{tools:["Focus Tools","F10"],undo:["Undo",n+"+Z"],redo:["Redo",n+"+Y"],indent:["Indent",a],outdent:["Outdent",o+"+"+a]},buttons:{okay:"OK",cancel:"Cancel",yes:"Yes",no:"No",enter:"Enter",exit:"Exit",open:"Open",close:"Close",ignore:"Ignore"},placeholders:{"":"text here"+i},labels:{},others:{}},classes:{"":"text-editor",i:"text-editor-i text-editor-i-%1 text-editor-i-%1--%2 fa fa-%2"}},t)),B={},le="blur",se="click",pe="keydown",be="keyup",he="touchstart mousedown",ge="touchmove mousemove",me="touchend mouseup",ye="orientationchange resize",ve=R.auto_close,xe=R.auto_tab,we=R.languages,Te=R.tab,Ce=(R.unit[0][1],R.unit[0][0]),_e=R.unit[1][1],Le=R.unit[1][0],Me="javascript:;",$e="px",Lt=f.ui={};f.tidy=function(e,t){var n=f.$(),i=k(n.before)?e:"",r=k(n.after)?M(t)?t:e:"";return f.trim(i,r)},f.i=function(){return k(f.replace(/\s+/g," "))},f.format=function(e,t,n,i){_(e)||(e=[e]),M(n)||(n=" "),M(i)||(i="");var r=f.h,a=f[0]().$(),o=e[0].split(h("("+_e[3]+")+"))[0],l=(e[0]?Ce[0]+e[0]+Ce[1]:"")+i,s=i+(e[0]?Ce[0]+Ce[2]+(e[1]||o)+Ce[1]:""),u=p(e[0]?Ce[0]+o+Ce[1]:""),c=p(s),d=h("^"+u+"([\\s\\S]*?)"+c+"$"),b=h(u+"$"),g=h("^"+c),m=a.before,k=a.after;return a.length?n=!1:f.insert(we.placeholders[""]),f.toggle(t?!d.test(a.value):!b.test(m)&&!g.test(k),[function(e){e.unwrap(l,s,1).tidy(h(Le[0]+"[^"+Le[0]+Le[1]+Le[2]+"]+?"+Le[1]+"$").test(m)?"":n,h("^"+Le[0]+Le[2]+"[^"+Le[0]+Le[1]+"]+?"+Le[1]).test(k)?"":n).wrap(l,s,t)},function(e){e.unwrap(l,s,t)}])[r]()};var Qt,Mt=R.classes,$t=Mt[""],Ft=we.tools,zt=we.buttons,Kt=we.labels,Dt=$t+"-textarea "+$t+"-content block",Rt=_t($t+"-sizer s"),Bt=_t($t+"-sizer se"),Ht=_t($t),Ot=_t($t+"-header"),St=_t($t+"-body"),jt=_t($t+"-footer"),Gt=_t($t+"-tool"),Pt=ot(e,!1,R.attributes),Jt=_t($t+"-description"),Nt=ot(),Ut=ot(),At=ot(),It=ot(),Yt=ot(),Xt=ot(),qt=_t("left","span"),Wt=_t("right","span"),Zt=0;Lt.i=function(e,t,n){return e=Ze(e).replace(/[\/\s]/g,"-"),V=We(Mt.i,[e,t||e]),n?(rt(n),nt(n,V),n):'<i class="'+V+'"></i>'},M(R.suffix)||(R.suffix=Ce[1]);var an="ui-drop-data",un=0,re=0,ae=0,ie=0,N=0,cn=0,dn=0,pn={};f.create=function(e,t){if(f.is.create)return f;f.is.create=!0,_(e)&&(R=b(R,e));var n=kt(Pt);return nt(Ht,$t+"-is-can-update"),nt(Ht,$t+"-is-can-copy"),nt(Pt,Dt),n&&gt(n,"p")?(yt(n,Ht),Zt=n,Et(n,!1)):yt(Pt,Ht),Ht.dir=R.direction,Tt(Ht,Ot),Tt(Ht,St),Tt(Ht,jt),Tt(St,Pt),R.tools&&(Tt(Ot,Gt),Tt(jt,Jt),Tt(Jt,qt),Tt(Jt,Wt)),Ie(pe,Pt,sn),Ie(be+" "+le,Pt,fn),R.resize&&(Tt(Ht,Rt),nt(Ht,$t+"-is-can-resize"),Ie(he,Rt,bn),Ie(ge,s,hn),Ie(me,K,gn)),on(),ln(),0!==t?Se("create",[f]):f},f.update=function(e,t){return f.is.create&&f.destroy(0),(0!==t?Se("update",[f]):f).create(e,0)},f.destroy=function(e){return f.is.create?(f.is.create=!1,Lt.exit(0,0,0),rt(Pt,Dt),R.tools=ze(R.tools),R.keys&&(Ye(pe,Pt,sn),Ye(be,Pt,fn)),R.resize&&(Ye(he,Rt,bn),Ye(ge,s,hn),Ye(me,s,gn)),Zt?(yt(Ht,Zt),Tt(Zt,Pt),Zt=0):yt(Ht,Pt),Ct(Ht),0!==e?Se("destroy",[f]):f):f},f.enable=function(e){return Pt.disabled=Pt.readOnly=!1,nt(Ht,$t+"-is-can-update"),nt(Ht,$t+"-is-can-copy"),0!==e?Se("enable",[f]):f},f.disable=function(e){return Pt.disabled=!0,rt(Ht,$t+"-is-can-update"),rt(Ht,$t+"-is-can-copy"),0!==e?Se("disable",[f]):f},f.freeze=function(e){return Pt.disabled=!1,Pt.readOnly=!0,rt(Ht,$t+"-is-can-update"),nt(Ht,$t+"-is-can-copy"),0!==e?Se("freeze",[f]):f},Lt.exit=function(e,t,n){if(P={panel:function(){Ct(Nt)},overlay:function(){Ye(se,Ut,mn),Ct(Ut)},modal:function(){Ye(se+" "+pe,pn.x,yn),Ye(he,St,vn),Ye(ge,St,xn),Ye(me,s,wn),Ct(At)},drop:function(){Ct(It)},bubble:function(){Ct(Yt)}},fn(),t)if(_(t))for(U in t)U=t[U],P[U]&&P[U](),0!==n&&Se("exit."+U,[f]);else P[t]&&P[t](),0!==n&&Se("exit."+U,[f]);else for(U in P)P[U]();return e&&f.select(),0!==n&&Se("exit",[f]),f},Lt.panel=function(e,t,n,i){function r(e){return Ye(se+" "+pe,re,r),Lt.panel.exit(1),Ae(e)}return Lt.exit(0,0,0),Y=Ze(e),ee=0,i&&(Y+=" "+Y+"--"+Ze(i)),_(t)&&!w(t)&&(ee=_t($t+"-panel-header "+Y,0,t.header),t=t.body),te=_t($t+"-panel-body "+Y,0,_t($t+"-panel-content "+Y,0,E(t)?"":t)),E(t)&&t(te),re=ot("a",!1,{href:Me,"class":$t+"-a "+$t+"-x "+Y}),re.title=zt.close,ot(Nt,!1,{"class":$t+"-panel "+Y}),Ie(se+" "+pe,re,r),ut(Nt,0),ee&&Tt(Nt,ee),Tt(St,ot(Nt,[te,re])),E(n)?n(Nt):$(n)&&ot(Nt,n),H=[f,Nt],i&&Se("enter.panel."+e+":"+i,H),Se("enter.panel."+e,H),Se("enter.panel",H),Se("enter",H),re.focus(),f},Lt.panel.fit=function(){},Lt.overlay=function(e,t,n,i){return Lt.exit(0,0,0),Y=Ze(e),i&&(Y+=" "+Y+"--"+Ze(i)),Tt(St,ot(Ut,!1,{"class":$t+"-overlay "+Y})),t&&Ie(se,Ut,mn),E(n)?n(Ut):$(n)&&ot(Ut,n),H=[f,Ut],i&&Se("enter.overlay."+e+":"+i,H),Se("enter.overlay."+e,H),Se("enter.overlay",H),Se("enter",H),f},Lt.overlay.fit=function(){},Lt.message=function(e,t,n,i,r){function o(e){return Ye(se+" "+pe,re,o),g(a),Lt.overlay.exit(1),Ae(e)}var a;return Y=Ze(e),r&&(Y+=" "+Y+"--"+Ze(r)),re=ot("a",!1,{href:Me,"class":$t+"-a "+$t+"-x "+Y}),re.title=zt.close,ot(Xt,E(t)?t(Xt):t,{"class":$t+"-message "+Y}),Ie(se+" "+pe,re,o),Lt.overlay("message message-"+Y,0,function(e){Tt(Xt,re),n&&(a=m(function(){o()},n)),Tt(e,Xt)},r),E(i)?i(Xt):$(i)&&ot(Xt,i),f},Lt.modal=function(){var l,u,e=arguments,t=e[0],n=e[1],i=e[2],r=e[3],a=$t+"-modal",o=n.footer;if(_(t)&&(t="default",n=e[0],i=e[1],r=e[2]),Lt.overlay(t,1,0,r).blur(),Y=Ze(t),r&&(Y+=" "+Y+"--"+Ze(r)),ot(At,!1,{"class":a+" "+Y}),M(n.body)&&(n.body=ot("div",n.body,{"class":a+"-content "+Y})),M(o)&&_(o)&&!w(o)){u=[];for(U in o)A=o[U],w(A)?u.push(A):(A=tn(A,U,o),I=U.text||zt[U]||U,l=ot("button",I,b({name:"y["+U+"]",type:"button","class":$t+"-button",data:{"button-id":U}},A.attributes)),Ie(se,l,function(e){return I=o[Ne(this,"button-id")].click(e,f),I===!1?Ae(e):void 0}),u.push(l));n.footer=u}for(U in n)a[1]=U,pn[U]=_t(a+"-"+We(U,a)+" "+Y,0,n[U]);return pn.x=ot("a",!1,{href:Me,"class":$t+"-a "+$t+"-x "+Y}),pn.sizer=Bt,ut(At,0),pn.x.title=zt.close,Tt(St,ot(At,pn,{style:""})),Lt.modal.fit(),vt(At,Ut),Ie(se+" "+pe,pn.x,yn),Ie(he,pn.header,Ae),Ie(he,pn.sizer,Ae),Ie(he,St,vn),Ie(ge,St,xn),Ie(me,s,wn),E(i)&&i(pn),H=[f,At,pn],r&&Se("enter.modal."+t+":"+r,H),Se("enter.modal."+t,H),Se("enter.modal",H),Se("enter",H),pn.x.focus(),f},Lt.modal.fit=function(e){return kn(),Y=cn/2-ie/2,ee=dn/2-N/2,_(e)?(M(e[0])&&(Y=e[0]),M(e[1])&&(ee=e[1])):(Y=d(Y,0),ee=d(ee,0)),c(At,{left:Y+$e,top:ee+$e,"min-width":ie+$e,"min-height":N+$e,visibility:"visible"}),H=[f,At,pn],Se("fit.modal",H),Se("fit",H),f};var Cn={"class":$t+"-button",name:"y"};return Lt.alert=function(e,t,n,i,r){var a=ot("button",zt.okay,Cn),o="alert";return n=n||v,_(e)&&(o+=":"+e[0],e=e[1]||e[0]),Ie(se,a,function(e){return n(e,f),yn(e,o+".y")}),Ie(pe,a,function(e){var t=e.TE.key;return t(/^(escape|enter)$/)&&Xe(se,a,[e]),Ae(e)}),Lt.modal(o,Tn(e,t,a),i,r),a.focus(),f},Lt.confirm=function(e,t,n,i,r,a){function c(e){return E(n)&&n(e,f),yn(e,s+".y")}function d(e){return E(i)&&i(e,f),yn(e,s+".n")}var u,o=ot("button",zt.okay,Cn),l=ot("button",zt.cancel,Cn),s="confirm";return l.name="n",Ie(se,o,c),Ie(se,l,d),Ie(pe,o,function(e){return u=e.TE.key,u("arrowright")?l.focus():u("enter")?c(e):u("escape")&&yn(e,s+".y"),Ae(e)}),Ie(pe,l,function(e){return u=e.TE.key,u("arrowleft")?o.focus():u("enter")?d(e):u("escape")&&yn(e,s+".n"),Ae(e)}),Lt.modal(s,Tn(e,t,[o,l]),r,a),l.focus(),f},Lt.prompt=function(e,t,n,i,r,a,o){function g(){u.focus(),"placeholder"in u&&u.select()}function m(e){return p=u.value,E(n)&&!n(p)?g():!n||k(p)&&p!==t?(yn(e,c+".y"),i(e,f,p!==t?p:"",t)):g(),Ae(e)}function y(e){return yn(e,c+".n")}var p,b,h,l=ot("button",zt.okay,Cn),s=ot("button",zt.cancel,Cn),u=ot("input",!1,{type:"text",value:t,placeholder:t,spellcheck:"false","class":$t+"-input block"}),c="prompt",d=[];if(r=r||0,1===r)u=ot("textarea",t,{placeholder:t.split("\n")[0],"class":$t+"-textarea block",spellcheck:"false"});else if(2===r){for(U in t)d.push(ot("option",t[U],{value:U,selected:U===n||null}));u=ot("select",d,{"class":$t+"-select block"})}return i=i||v,u.name="data",s.name="n",Ie(pe,u,function(e){return b=e.TE.key,h=e.TE.control,b("enter")&&0===r||h("enter")?m(e):b("escape")||b("backspace")&&!this.value?y(e):b("arrowdown")&&0===r||b("enter")&&2===r||h("arrowdown")?(l.focus(),Ae(e)):void 0}),Ie(pe,l,function(e){return b=e.TE.key,b("enter")?m(e):b("escape")?y(e):b("arrowup")?u.focus():b("arrowright")&&s.focus(),Ae(e)}),Ie(pe,s,function(e){return b=e.TE.key,b(/^(enter|escape)$/)?y(e):b("arrowup")?u.focus():b("arrowleft")&&l.focus(),Ae(e)}),Ie(se,l,m),Ie(se,s,y),Lt.modal(c,Tn(e,u,[l,s]),a,o),g(),f},Lt.drop=function(){Lt.exit(0,0,0);var e=arguments,t=e[0],n=e[1],i=e[2];return 1===De(e)&&(t="default",n=e[0],i=e[1]),Y=Ze(t),ut(It,0),Tt(K,ot(It,!1,{"class":$t+"-drop "+Y})),E(n)?n(It):ot(It,n),Lt.drop.fit(),i===!1||Ie(se,s,En),Ie(ye,l,En),H=[f,It],Se("enter.drop."+t,H),Se("enter.drop",H),f},Lt.drop.fit=function(e){return H=et(F),O=et(It),S=Lt.drop.target,Y=H.w/2-O.w/2,ee=H.h/2-O.h/2,!M(e)&&S&&(t=Ve(S),Y=t.l,ee=t.t+et(S).h),_(e)?(M(e[0])&&(Y=e[0]),M(e[1])&&(ee=e[1])):(Y=d(Y,0,H.w-O.w),ee=d(ee,0,Math.max(H.h,et(l).h)-O.h)),c(It,{left:Y+$e,top:ee+$e,visibility:"visible"}),H=[f,It],Se("fit.drop",H),Se("fit",H),f},Lt.menu=function(e,n,i,r){var l,a=Lt.tools,o=0;if(n===!1)return Lt.tool(e,n);for(r in i)ie="%"===r[0],l=i[r],l=$(l)&&!ie?a[l]:l,l&&(l=tn(l,r,a),i[r]=l);return Lt.tool(e,{i:_(n)?n[0]:0,text:_(n)?n[1]||0:n&&i[n]&&i[n].text||n,click:function(s){var u=Lt.drop.target=a[e].target;return Lt.drop("menu menu-"+Ze(e),function(s){function c(o){return ee=this,t=Ne(ee,"tool-id"),X=i[t],X=$(X)?a[X]:X||{},q=ft(ee),!en(X)&&E(r=X.click)&&(r=r(o,f),X.i&&(a[e].i=X.i),Lt.menu.set(e,_(X.text)?[X.text[0],t]:_(n)?[n[0],t]:t),r===!1)?(f.select(),Ae(o)):(f.select(),Ae(o))}function d(e){if(ee=this,(I=e.TE.key)("escape"))Lt.exit(1);else if(I("enter"))Xe(se,ee,[e]);else if(I("f10")&&u)u.focus();else if(I("arrowdown")&&(Y=pt(ee))){for(;!gt(Y,"a")&&Y;)Y=pt(Y);Y&&Y.focus()}else if(I("arrowup")&&(Y=bt(ee))){for(;!gt(Y,"a")&&Y;)Y=bt(Y);!Y&&u?(Lt.exit(),u.focus()):Y&&Y.focus()}else I("arrowup")&&u&&(Lt.exit(),u.focus());return Ae(e)}for(r in i)if(l=i[r],ie="%"===r[0],l){var p={href:ie?null:Me,"class":$t+"-"+(ie?"label":"button")};ie?A=Kt[e]&&Kt[e][+r.slice(1)-1]||r:(p.data={},p.data["tool-id"]=r,A=Ft[r]||r),Q=l.text,Q=_(Q)?Q[1]||"":Q,A=_(A)?A[0]:A,V=ot(ie?"span":"a","<span>"+(ie?A||"%"+o:Q||A)+"</span>",b(p,l.attributes||{})),nt(V,"menu-"+Ze(r).replace(/[\/\s]/g,"-")),!p.title&&(ee=l.title)&&(V.title=_(ee)?ee[0]+(ee[1]?" ("+ee[1]+")":""):ee),ie?je(V,{id:$t+"-label:"+o}):(en(l)?nt(V,"x"):rt(V,"x"),l.on?nt(V,"on"):rt(V,"on"),Ie(se,V,c),Ie(pe,V,d)),Tt(s,V),++o}m(function(){(mt('[data-tool-id="'+Ne(u,an)+'"]',s)[0]||mt("a",s)[0]).focus()},1)}),!1}},r),Je(a[e].target,{"ui-drop":e}),a[e].data=i,Lt.menu.set(e,n)},Lt.menu.set=function(e,t){var a,o,n=Lt.tools[e]||{},i=n.target,r=n.data;return i?(_(t)?Je(i,an,t[1]||""):(Je(i,an,t),t=r[t]&&r[t].text||t),_(t)?(o=t[0],o=Ke(o,"<")?o:Lt.i(o,n.i),t=M(t[1])?t[1]:0,t=t&&r[t]&&r[t].text||t,t=o+(0!==t?"<span>"+(_(t)?t[1]||t:t)+"</span>":"")):o=Lt.i(e,n.i),(a=mt("."+$t+"-text",i)[0])?(nt(i,"text"),st(a,t)):(rt(i,"text"),st(i,o)),f):f},Lt.bubble=function(){Lt.exit(0,0,0);var e=arguments,t=e[0],n=e[1];return 1===De(e)&&(t="default",n=e[0]),Y=Ze(t),ut(Yt,0),Tt(K,ot(Yt,!1,{"class":$t+"-bubble "+Y})),E(n)?n(Yt):ot(Yt,n),Lt.bubble.fit(),H=[f,Yt],Se("enter.bubble."+t,H),Se("enter.bubble",H),f},Lt.bubble.fit=function(e){V=f.$(1),t=Ve(Pt),N=c(Pt,"line-height");var n="border-",i="-width";Y=V.caret[0].x+t.l-Pt.scrollLeft,ee=V.caret[1].y+t.t+N-Pt.scrollTop,O=c(St,[n+"top"+i,n+"bottom"+i,n+"left"+i,n+"right"+i]);var r=et(St),a=et(Yt),o=O[0]+O[1],l=O[2]+O[3];return _(e)?(M(e[0])&&(Y=e[0]),M(e[1])&&(ee=e[1])):(Y=d(Y,t.l,t.l+r.w-a.w-l),ee=d(ee,t.t,t.t+r.h-a.h-o)),c(Yt,{left:Y+$e,top:ee+$e,visibility:"visible"}),H=[f,Yt],Se("fit.bubble",H),Se("fit",H),f},Lt.panel.exit=function(e){return Lt.exit(e,"panel")},Lt.overlay.exit=function(e){return Lt.exit(e,"overlay")},Lt.modal.exit=function(e){return Lt.exit(e,"modal")},Lt.drop.exit=function(e){return Lt.exit(e,"drop")},Lt.bubble.exit=function(e){return Lt.exit(e,"bubble")},Lt.tool=function(e,t,n){var i=Lt.tools;return A="",I=M(i[e])?"update":"create","|"!==e&&(R.tools=Fe(R.tools).filter(function(t,n){return t===e?(A=n,!1):!0})),t===!1?(delete i[e],I="destroy"):("|"===e?(n=t,t={}):(E(t)&&(t={click:t}),i[e]=b(i[e]||{},t),M(n)||""===A||(n=A)),C(n)?R.tools.splice(n,0,e):R.tools.push(e)),Se(I+".tool."+e,[f,i[e]]),on(),f},Lt.separator=function(e,t){return Lt.tool("|",e!==!1?{attributes:e||{}}:!1,t)},Lt.key=function(e,t){var n=Lt.keys;return I=M(n[e])?"update":"create",t===!1?(delete n[e],I="destroy"):n[e]=t,Se(I+".key."+e,[f,n[e]]),ln(),f},Lt.key.set=function(e){B[e]=1},Lt.key.reset=function(e){e?delete B[e]:B={}},Lt.tools={"|":{},undo:{i:"undo",click:function(e,t){return t.undo(),!1}},redo:{i:"repeat",click:function(e,t){return t.redo(),!1}},indent:function(e,t){return t.indent(Te),!1},outdent:function(e,t){return t.outdent(Te),!1}},Lt.keys={"control+y":"redo","control+z":"undo",escape:function(e,t){return Q=":not([tabindex]):not([disabled])",(V=mt("input"+Q+",button"+Q+",select"+Q+",textarea"+Q+",a[href]"+Q+",[contenteditable]"+Q+',[tabindex]:not([tabindex="-1"])',s,0))&&-1!==(ee=V.indexOf(Pt))?((V[ee+1]||s).focus(),!1):void 0},f10:function(e,t){return mt("a",Gt)[0].focus(),!1},tab:xe?"indent":0,"shift+tab":xe?"outdent":0},Lt.el={container:Ht,header:Ot,body:St,footer:jt,panel:Nt,overlay:Ut,modal:At,drop:It,bubble:Yt},f.config=R,b(TE._,{time:function(e){var t=new Date(M(e)?e:Date.now()),n=t.getFullYear(),i=t.getMonth()+1,r=t.getDate(),a=t.getHours(),o=t.getMinutes(),l=t.getSeconds(),s=t.getMilliseconds();return 10>i&&(i="0"+i),10>r&&(r="0"+r),10>a&&(a="0"+a),10>o&&(o="0"+o),10>l&&(l="0"+l),10>s&&(s="0"+s),[""+n,""+i,""+r,""+a,""+o,""+l,""+s]},replace:qe,format:We,dom:{set:Tt,reset:Et,get:mt,id:lt,copy:function(e,t){return e.cloneNode(M(t)?t:!0)},classes:{set:nt,reset:rt,toggle:at,get:it},attributes:{set:je,reset:Pe,get:Ge},data:{set:Je,reset:Ue,get:Ne},is:gt,offset:Ve,pointer:Qe,size:et,content:{set:st,reset:ut,get:ft},closest:tt,parent:ct,children:dt,next:pt,previous:bt,index:ht,before:yt,after:vt,prepend:xt,append:wt},el:ot,event:{set:Ie,reset:Ye,fire:Xe,x:Ae}}),b(f._,TE._),b(f._,{hooks:y,hook:{set:He,reset:Oe,fire:Se}}),f.create()};