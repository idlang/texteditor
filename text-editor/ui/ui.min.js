/*!
 * ==========================================================
 *  USER INTERFACE MODULE FOR TEXT EDITOR PLUGIN 1.5.1
 * ==========================================================
 * Author: Taufik Nurrohman <https://github.com/tovic>
 * License: MIT
 * ----------------------------------------------------------
 */
TE.ui=function(e,t){function Le(e){return _(e)?v(e).split(/\s+/):e}function _e(e){return $(e)?e.join(" "):e}function Ce(e,t,n){return L(e)?L(t)?(L(m[e])||(m[e]={}),L(n)||(n=Object.keys(m[e]).length),m[e][n]=t,l):m[e]:m}function Me(e,t){return L(e)?L(t)&&L(m[e])?(delete m[e][t],l):(m[e]={},l):(m={},l)}function Oe(e,t,n){if(!L(m[e]))return m[e]={},l;if(L(n))L(m[e][n])&&m[e][n].apply(l,t);else for(I in m[e])m[e][I].apply(l,t);return l}function Ne(e,t,n){if($(t))for(I in t)Ne(e,I,t[I]);else e.setAttribute(t,n)}function He(e,n,r){if(_(n))return He(e,[n],L(r)?r:"")[0];t=[];for(I in n)I=n[I],(I=e.getAttribute(I))&&t.push(I);return t.length?t:L(r)?r:[]}function je(e,t){if($(t))for(I in t)je(e,t[I]);else if(L(t))e.removeAttribute(t);else for(je(e,"class"),I=0,W=e.attributes,X=W.length;X>I;++I)W[I]&&je(e,W[I].name)}function Se(e,t,n){if($(t))for(I in t)Se(e,I,t[I]);else Ne(e,"data-"+t,n)}function Be(e,n,r){if(_(n))return Be(e,[n],L(r)?r:"")[0];t=[];for(I in n)I=n[I],(I=He(e,"data-"+I))&&t.push(I);return t.length?t:L(r)?r:[]}function Ae(e,t){if($(t))for(I in t)je(e,"data-"+t[I]);else if(L(t))je(e,"data-"+t);else for(I=0,W=e.attributes,X=W.length;X>I;++I)W[I]&&"data-"===W[I].name.slice(0,5)&&je(e,W[I].name)}function Ye(e){return e&&e.preventDefault(),!1}function De(e,t,n){if(t){for(e=Le(e),I=0,W=e.length;W>I;++I)t.addEventListener(e[I],n,!1),Ce("on:"+e[I],n,Ve(t));return l}}function Fe(e,t,n){if(t){for(e=Le(e),I=0,W=e.length;W>I;++I)t.removeEventListener(e[I],n,!1),Me("on:"+e[I],Ve(t));return k(t)&&t.id.split(":")[0]===kt+"-dom"&&je(t,"id"),l}}function Ie(e,t,n){e=Le(e);var i,r="createEvent"in s;for(I=0,W=e.length;W>I;++I)r?(i=s.createEvent("HTMLEvents"),i.data=n,i.initEvent(e[I],!0,!1),t.dispatchEvent(i)):Oe("on:"+e[I],n,Ve(t));return l}function We(e,t,n){for(I=0,W=t.length,X;W>I;++I)X=t[I],e=e.replace(z(X)?X:b(p(X),"g"),n&&n[I]||"");return e}function Xe(e,t){return e.replace(/%(\d+)/g,function(e,n){return--n,L(t[n])?t[n]:e})}function Ke(e){return v(We(e,[/[^ \/a-z\d-]/g,/([ -])+/g,/^-|-$/g],["-","$1",""]))}function Re(e,t){var n=t.touches?t.touches[0].pageX:t.pageX,r=t.touches?t.touches[0].pageY:t.pageY,i=qe(e);return{x:n-i.l,y:r-i.t}}function qe(e){for(K=e.offsetLeft,J=e.offsetTop;e=e.offsetParent;)K+=e.offsetLeft,J+=e.offsetTop;return{l:K,t:J}}function Pe(e){return{w:e.offsetWidth,h:e.offsetHeight}}function Ue(e,t){for(;(e=rt(e))&&e!==t;);return e}function Ze(e,t){t=Le(t);for(I in t)e.classList.add(t[I])}function Ge(e,n,r){if(_(n))return Ge(e,[n],L(r)?r:"")[0];t=[];for(I in n)I=n[I],e.classList.contains(I)&&t.push(I);return t.length?t:L(r)?r:!1}function Je(e,t){if(L(t)){t=Le(t);for(I in t)e.classList.remove(t[I])}else je(e,"class")}function Qe(e,t,n){if(e=_(e)?s.createElement(e):e,$(n))for(I in n)if(V=n[I],"classes"===I)Ze(e,V);else if("data"===I)for(W in V)V=V[W],null===V?Ae(e,W):Se(e,W,V);else"css"===I?_(V)?Ne(e,"style",V):null===V?je(e,"style"):c(e,V):E(V)?e[I]=V:null===V?je(e,I):Ne(e,I,$(V)?V.join(" "):""+V);if(k(t))bt(e,t);else if($(t))for(I in t)V=t[I],k(V)?bt(e,V):V!==!1&&et(e,V);else L(t)&&t!==!1&&et(e,t);return e}function Ve(e){var t=e.id;return t||(t=kt+"-dom:"+Date.now(),e.id=t),t}function et(e,t){e.innerHTML=t}function tt(e,t){return e.innerHTML||(L(t)?t:"")}function nt(e,t){if(t!==!1&&(S=it(e)))for(I=0,W=S.length;W>I;++I)nt(S[I]);et(e,"")}function rt(e){return e&&e.parentNode}function it(e){return e&&e.children||[]}function ot(e){return e&&e.nextSibling}function ft(e){return e&&e.previousSibling}function ut(e){for(I=0;e=ft(e);)++I;return I}function st(e,t){return e&&_(t)?e.nodeName.toLowerCase()===t.toLowerCase():e&&E(t)?e===t(e):e===t}function lt(e,n){if(!(n=L(n)?n:s))return[];if(t=[],_(e)){if(/^([#.]?[\w-]+|\*)$/.test(e)){if("#"===e[0]&&(e=n.getElementById(e.slice(1))))return[e];if("."===e[0]&&(e=n.getElementsByClassName(e.slice(1)))||(e=n.getElementsByTagName(e))){for(I=0,W=e.length;W>I;++I)t.push(e[I]);return t}return[]}for(e=n.querySelectorAll(e),I=0,W=e.length;W>I;++I)t.push(e[I]);return t}return at(e)?[e]:[]}function at(e,t){var n=rt(e);return 1===arguments.length?n||!1:e&&n===e?n:!1}function ct(e,t){P=rt(e),P&&P.insertBefore(t,e)}function dt(e,t){P=rt(e),P&&P.insertBefore(t,ot(e))}function pt(e,t){S=it(e)[0],S?ct(S,t):bt(e,t)}function ht(e,t){bt(e,t)}function bt(e,t){e.appendChild(t)}function gt(e,t){var n=at(e);if(n){if(t!==!1)for(S=it(e)[0];S;)gt(S);n.removeChild(e)}}function yt(e){nt(Qe(e,!1,{style:""})),gt(e)}function vt(e,t,n){return Qe(t||"div",n,{"class":e})}function Rt(e){return!e||L(e.active)&&!e.active}function qt(e,t,n){return E(e)&&(e={click:e}),_(e.click)&&(e.click=(n[e.click]||{}).click),L(e.title)||(e.title=Et[t]||""),L(e.attributes)||(e.attributes={}),n[t]=e,e}function Pt(t){if(e.disabled||e.readonly)return Ye(t);mt.exit(0,0,0);var n=Be(this,"tool-id"),r=mt.tools,i=r[n];return mt.drop.target=t.currentTarget||t.target,!Rt(i)&&E(W=i.click)&&(W=W(t,l,n),Oe("on:change",[t,l,n]),W===!1)?Ye(t):(l.select(),Ye(t))}function Ut(e){if(J=this,(X=e.TE.key)(/^(escape|f10)$/))mt.exit(1);else if(X("enter")||X("arrowdown")&&Be(J,"ui-drop"))mt.drop.target=J,Ie(oe,J,[e]);else if(X("arrowright")&&(K=ot(J))){for(;!st(K,"a")&&K;)K=ot(K);K&&K.focus()}else if(X("arrowleft")&&(K=ft(J))){for(;!st(K,"a")&&K;)K=ft(K);K&&K.focus()}return Ye(e)}function Zt(){nt(Ot,!1);var r,i,o,f,u,s,a,e=Le(N.tools),t=kt+"-button",n=kt+"-separator";N.tools=e;for(s in e)a=e[s],i=mt.tools[a],(i||i==={})&&(i=qt(i,a,mt.tools),o=i.i||a,"|"!==o&&"<"!==o[0]&&(o=Ke(o)),f="|"!==o,u=Ke(o).replace(/\s/g,""),Xt=vt(f?t+" "+t+"-"+u:n+" "+n+"-"+s,f?"a":"span"),f?(Xt=i.target||Xt,r=t+":"+u,Ne(Xt,{href:$e,id:r,tabindex:-1}),Se(Xt,"tool-id",a),o="<"===o[0]?o:'<i class="'+Xe(wt,[o])+'"></i>',Rt(i)&&Ze(Xt,"x"),i.text&&(o=Xe('<span class="'+kt+'-text">'+i.text+"</span>",[o]),Ze(Xt,"text")),et(Xt,o),Qe(Xt,!1,i.attributes),!i.attributes.title&&(W=i.title)&&(Xt.title=$(W)?W[0]+(W[1]?" ("+W[1]+")":""):W),De(oe,Xt,Pt),De(ae,Xt,Ut)):Xt.id=n+":"+s,i.target=Xt,bt(Ot,Xt));Oe("update.tools",[l])}function Gt(){mt.keys=function(){var n,e=Object.keys(mt.keys).sort().reverse(),t={};for(I=0,W=e.length;W>I;++I)n=e[I],t[n]=mt.keys[n];return t}(),en(),Oe("update.keys",[l])}function Vt(e){function d(e){return e.replace(/\+/g,"\n").replace(/\n\n/g,"\n+").split("\n")}var n=l.$(),r=n.before,i=n.after,o=r.slice(-1),f=i[0],u=n.length,s=mt.keys,a=TE.keys_alias,c=(r.match(/(?:^|\n)([\t ]*).*$/)||[""]).pop();q=e.TE.key(),Jt[q]=1,t=Object.keys(Jt).length,y(function(){l.record()});for(I in s){X=d(I),S=0;for(W in X)W=X[W],Jt[a[W]||W]&&++S;if(X=X.length,S===X&&t===X&&(_(s[I])&&(s[I]=mt.tools[s[I]].click),K=s[I]&&s[I](e,l),K===!1))return Ye(e)}if(ye)for(I in ye)if(R=ye[I],R!==!1){if(q===R&&f===R)return"\\"===o?(l.insert(q,0),Ye(e)):(l.select(n.end+1),Ye(e));if(I===q)return l.wrap(I,R),Ye(e);if(o===I&&f===R){if("backspace"===q&&r.slice(-2)!=="\\"+I)return l.unwrap(I,R),Ye(e);if(ve&&"enter"===q&&I!==R)return l.tidy("\n"+c+xe,"\n"+c),Ye(e)}}if(ve&&!u){if("backspace"===q&&b(p(xe)+"$").test(r))return l.outdent(xe),Ye(e);if("enter"===q&&b("(^|\\n)("+p(xe)+")+.*$").test(r))return l.insert("\n"+c,0,1),Ye(e)}}function en(e){e&&e.TE&&e.TE.key?delete Jt[e.TE.key()]:Jt={}}function fn(e){return tn=Ht,G=Pe(Mt),Ye(e)}function un(e){tn===Ht&&c(Nt,{height:Re(Ct,e).y-G.h+ze})}function sn(){tn=0}function ln(){mt.exit(1)}function an(){t=Pe(At),ee=t.w,F=t.h,t=Pe(Bt),nn=t.w,rn=t.h}function cn(e,t){t&&Oe("exit.modal."+t,[l]),Ie(oe,Bt,[e])}function dn(e){tn=e.target,t=Re(At,e),te=t.x,ne=t.y,an()}function pn(e){var n=on.header,r=on.resize;tn===n||Ue(tn,n)===n?(t=Re(Ct,e),K=t.x-te,J=t.y-ne,c(At,{left:(ee>nn?K:d(K,0,nn-ee))+ze,top:(F>rn?J:d(J,0,rn-F))+ze})):tn===r&&(t=Re(At,e),G=Pe(r),c(At,{width:t.x+G.w/4+ze,height:t.y+G.h/4+ze}))}function hn(){tn=0}function bn(e,t,n){return{header:e,body:t,footer:n}}function gn(t){H=mt.drop.target,j=Yt,S=t&&t.target||0,(!S||S!==H&&Ue(S,H)!==H)&&(mt.drop.target=0,yt(Yt),Fe(oe,s,gn),Fe(ge,u,gn),mt.exit(t.target===e))}var H,j,S,Y,F,I,W,X,K,R,q,t,P,Z,G,J,V,ee,te,ne,n="⌘",r="…",o="⇥",f="⇧",u=window,s=document,l=new TE(e),a=l._,c=a.css,d=a.edge,p=a.x,h=a.extend,b=a.pattern,y=(a.timer.reset,a.timer.set),v=a.trim,m={},x=function(){},w=TE.is,k=w.e,E=w.f,T=w.i,$=w.o,z=w.r,L=function(e){return!w.x(e)},_=w.s,C=s.documentElement,O=(s.head,s.body),N=h({tab:"  ",dir:"ltr",resize:1,keys:1,tools:"indent outdent | undo redo",attributes:{spellcheck:"false"},unit:[[["<",">","/"],["=",'"','"'," "]],[["\\u003C","\\u003E","\\u002F"],["\\u003D","\\u0022","\\u0022","\\u0020"]]],auto_tab:1,auto_close:{'"':'"',"'":"'","(":")","{":"}","[":"]","<":">"},languages:{tools:{tools:["Focus Tools","F10"],undo:["Undo",n+"+Z"],redo:["Redo",n+"+Y"],indent:["Indent",o],outdent:["Outdent",f+"+"+o]},buttons:{okay:"OK",cancel:"Cancel",yes:"Yes",no:"No",enter:"Enter",exit:"Exit",open:"Open",close:"Close",ignore:"Ignore"},placeholders:{"":"text here"+r},labels:{},others:{}},classes:{"":"text-editor",i:"icon icon-%1 fa fa-%1"}},t),ie="blur",oe="click",ae="keydown",ce="keyup",de="touchstart mousedown",pe="touchmove mousemove",he="touchend mouseup",ge="orientationchange resize",ye=N.auto_close,ve=N.auto_tab,me=N.languages,xe=N.tab,ke=(N.unit[0][1],N.unit[0][0]),Ee=N.unit[1][1],Te=N.unit[1][0],$e="javascript:;",ze="px",mt=l.ui={};l.tidy=function(e,t){var n=l.$(),r=v(n.before)?e:"",i=v(n.after)?L(t)?t:e:"";return l.trim(r,i)},l.i=function(){return v(l.replace(/\s+/g," "))},l.format=function(e,t,n,r){$(e)||(e=[e]),L(n)||(n=" "),L(r)||(r="");var i=l.h,o=l[0]().$(),f=(e[0]?ke[0]+e[0]+ke[1]:"")+r,u=r+(e[0]?ke[0]+ke[2]+(e[1]||e[0].split(b("("+Ee[3]+")+"))[0])+ke[1]:""),s=p(f),a=p(u),c=b("^"+s+"([\\s\\S]*?)"+a+"$"),d=b(s+"$"),h=b("^"+a),g=o.before,y=o.after;return o.length?n=!1:l.insert(me.placeholders[""]),l.toggle(t?!c.test(o.value):!d.test(g)&&!h.test(y),[function(e){e.unwrap(f,u,1).tidy(b(Te[0]+"[^"+Te[0]+Te[1]+Te[2]+"]+?"+Te[1]+"$").test(g)?"":n,b("^"+Te[0]+Te[2]+"[^"+Te[0]+Te[1]+"]+?"+Te[1]).test(y)?"":n).wrap(f,u,t)},function(e){e.unwrap(f,u,t)}])[i]()};var Xt,xt=N.classes,wt=xt.i,kt=xt[""],Et=me.tools,Tt=me.buttons,$t=me.labels,zt=kt+"-textarea "+kt+"-content block",Lt=vt(kt),_t=vt(kt+"-header"),Ct=vt(kt+"-body"),Mt=vt(kt+"-footer"),Ot=vt(kt+"-tool"),Nt=Qe(e,!1,N.attributes),Ht=vt(kt+"-resize s"),jt=vt(kt+"-description"),St=vt(kt+"-panel"),Bt=vt(kt+"-overlay"),At=Qe("div"),Yt=Qe("div"),Dt=Qe("div"),Ft=vt("left","span"),It=vt("right","span"),Wt=0;L(N.suffix)||(N.suffix=ke[1]);var Jt={},tn=0,te=0,ne=0,ee=0,F=0,nn=0,rn=0,on={};l.create=function(e,t){$(e)&&(N=h(N,e));var n=at(Nt);return Ze(Lt,kt+"-is-can-update"),Ze(Nt,zt),n&&st(n,"p")?(ct(n,Lt),Wt=n,gt(n,!1)):ct(Nt,Lt),Lt.dir=N.dir,bt(Lt,_t),bt(Lt,Ct),bt(Lt,Mt),bt(Ct,Nt),N.tools&&(bt(_t,Ot),bt(Mt,jt),bt(jt,Ft),bt(jt,It)),De(ae,Nt,Vt),De(ce+" "+ie,Nt,en),N.resize&&(bt(Lt,Ht),Ze(Lt,kt+"-is-can-resize"),De(de,Ht,fn),De(pe,s,un),De(he,O,sn)),Zt(),Gt(),0!==t?Oe("create",[l]):l},l.update=function(e,t){return Ge(Nt,Le(zt),0)&&l.destroy(0),(0!==t?Oe("update",[l]):l).create(e,0)},l.destroy=function(e){return Ge(Nt,Le(zt),0)?(mt.exit(0,0,0),Je(Nt,zt),N.tools=_e(N.tools),N.keys&&(Fe(ae,Nt,Vt),Fe(ce,Nt,en)),N.resize&&(Fe(de,Ht,fn),Fe(pe,s,un),Fe(he,s,sn)),Wt?(ct(Lt,Wt),bt(Wt,Nt),Wt=0):ct(Lt,Nt),yt(Lt),0!==e?Oe("destroy",[l]):l):l},l.enable=function(e){return Nt.disabled=Nt.readOnly=!1,Ze(Lt,kt+"-is-can-update"),0!==e?Oe("enable",[l]):l},l.disable=function(e){return Nt.disabled=!0,Je(Lt,kt+"-is-can-update"),0!==e?Oe("disable",[l]):l},l.freeze=function(e){return Nt.disabled=!1,Nt.readOnly=!0,Je(Lt,kt+"-is-can-update"),0!==e?Oe("freeze",[l]):l},mt.exit=function(e,t,n){if(Y={panel:function(){yt(St)},overlay:function(){Fe(oe,Bt,ln),yt(Bt)},modal:function(){Fe(de,Ct,dn),Fe(pe,Ct,pn),Fe(he,s,hn),Fe(oe,on.x,cn),yt(At)},drop:function(){yt(Yt)},bubble:function(){yt(Dt)}},t)if($(t))for(I in t)I=t[I],Y[I]&&Y[I](),0!==n&&Oe("exit."+I,[l]);else Y[t]&&Y[t](),0!==n&&Oe("exit."+I,[l]);else for(I in Y)Y[I]();return e&&l.select(),0!==n&&Oe("exit",[l]),l},mt.panel=function(e,t){function n(){Fe(oe,te,n),mt.panel.exit(1)}return mt.exit(0,0,0),en(),te=vt(kt+"-x"),te.title=Tt.close,De(oe,te,n),bt(Ct,Qe(St,[vt(kt+"-panel-content","div",e),te])),E(t)?t(St):Qe(St,t),Oe("enter.panel",[l]),Oe("enter",[l]),l},mt.panel.fit=function(){},mt.overlay=function(e,t){return mt.exit(0,0,0),en(),bt(Ct,Bt),e&&De(oe,Bt,ln),E(t)?t(Bt):Qe(Bt,t),Oe("enter.overlay",[l]),Oe("enter",[l]),l},mt.overlay.fit=function(){},mt.modal=function(){mt.overlay(1).blur();var f,u,e=arguments,t=e[0],n=e[1],r=e[2],i=kt+"-modal",o=n.footer;if($(t)&&(t="default",n=e[0],r=e[1]),K=Ke(t),Qe(At,!1,{"class":i+" "+K}),L(n.body)&&(n.body=Qe("div",n.body,{"class":i+"-content "+K})),L(o)&&$(o)&&!k(o)){u=[];for(I in o)W=o[I],k(W)?u.push(W):(W=qt(W,I,o),t=I.text||Tt[I]||I,f=Qe("button",t,h({name:"y["+I+"]",type:"button","class":kt+"-button",data:{"button-id":I}},W.attributes)),De(oe,f,function(e){return t=o[Be(this,"button-id")].click(e,l),t===!1?Ye(e):void 0}),u.push(f));n.footer=u}for(I in n)i[1]=I,on[I]=vt(i+"-"+Xe(I,i)+" "+K,0,n[I]);return on.x=vt(kt+"-x "+K),on.resize=vt(kt+"-resize se "+K),nt(At),on.x.title=Tt.close,bt(Ct,Qe(At,on,{style:""})),mt.modal.fit(),dt(At,Bt),De(oe,on.x,cn),De(de,on.header,Ye),De(de,on.resize,Ye),De(de,Ct,dn),De(pe,Ct,pn),De(he,s,hn),E(r)&&(on.overlay=Bt,on.modal=At,r(on)),Oe("enter.modal."+t,[l]),Oe("enter.modal",[l]),Oe("enter",[l]),l},mt.modal.fit=function(e){return an(),K=nn/2-ee/2,J=rn/2-F/2,$(e)?(L(e[0])&&(K=e[0]),L(e[1])&&(J=e[1])):(K=d(K,0),J=d(J,0)),c(At,{left:K+ze,top:J+ze,"min-width":ee+ze,"min-height":F+ze,visibility:"visible"}),Oe("fit.modal",[l]),Oe("fit",[l]),l};var yn={"class":kt+"-button",name:"y"};return mt.alert=function(e,t,n,r){var i=Qe("button",Tt.okay,yn),o="alert";return n=n||x,$(e)&&(o+=":"+e[0],e=e[1]||e[0]),De(oe,i,function(e){return n(e,l),cn(e,o+".y"),Ye(e)}),De(ae,i,function(e){var t=e.TE.key;return t(/^(escape|enter)$/)?(Ie(oe,i,[e]),Ye(e)):void 0}),mt.modal(o,bn(e,t,i),r),i.focus(),l},mt.confirm=function(e,t,n,r,i){function a(e){return E(n)&&n(e,l),cn(e,u+".y"),Ye(e)}function c(e){return E(r)&&r(e,l),cn(e,u+".n"),Ye(e)}var s,o=Qe("button",Tt.okay,yn),f=Qe("button",Tt.cancel,yn),u="confirm";return f.name="n",$(e)&&(u+=":"+e[0],e=e[1]||e[0]),De(oe,o,a),De(oe,f,c),De(ae,o,function(e){return s=e.TE.key,s("arrowright")?(f.focus(),Ye(e)):s("arrowleft")?Ye(e):s("enter")?(a(e),Ye(e)):s("escape")?(cn(e,u+".y"),Ye(e)):void 0}),De(ae,f,function(e){return s=e.TE.key,s("arrowright")?Ye(e):s("arrowleft")?(o.focus(),Ye(e)):s("enter")?(c(e),Ye(e)):s("escape")?(cn(e,u+".n"),Ye(e)):void 0}),mt.modal(u,bn(e,t,[o,f]),i),f.focus(),l},mt.prompt=function(e,t,n,r,i,o){function h(){s.focus(),"placeholder"in s&&s.select()}function b(e){return Ye(e)}function g(e){return d=s.value,!n||v(d)&&d!==t?(cn(e,a+".y"),Ye(e),r(e,l,d!==t?d:"",t)):(h(),b(e))}function y(e){return cn(e,a+".n"),Ye(e)}var d,p,f=Qe("button",Tt.okay,yn),u=Qe("button",Tt.cancel,yn),s=Qe("input",!1,{type:"text",value:t,placeholder:t,spellcheck:"false","class":kt+"-input block"}),a="prompt",c=[];if($(e)&&(a+=":"+e[0],e=e[1]||e[0]),E(i)&&(o=i,i=0),1===i)s=Qe("textarea",t,{placeholder:t.split("\n")[0],"class":kt+"-textarea block"});else if(2===i){for(I in t)c.push(Qe("option",t[I],{value:I,selected:I===n||null}));s=Qe("select",c,{"class":kt+"-select block"})}return r=r||x,s.name="data",u.name="n",De(ae,s,function(e){return p=e.TE.key,p("enter")?g(e):p("escape")||p("backspace")&&!this.value?y(e):p("arrowup")?b(e):p("arrowdown")?(f.focus(),Ye(e)):void 0}),De(ae,f,function(e){return p=e.TE.key,p("enter")?g(e):p("escape")?y(e):p("arrowup")?(s.focus(),Ye(e)):p("arrowright")?(u.focus(),Ye(e)):p(/^arrow(down|left)$/)?b(e):void 0}),De(ae,u,function(e){return p=e.TE.key,p(/^(enter|escape)$/)?y(e):p("arrowup")?(s.focus(),Ye(e)):p(/^arrow(right|down)$/)?b(e):p("arrowleft")?(f.focus(),Ye(e)):void 0}),De(oe,f,g),De(oe,u,y),mt.modal(a,bn(e,s,[f,u]),o),h(),l},mt.drop=function(){mt.exit(0,0,0);var e=arguments,t=e[0],n=e[1];return 1===e.length&&(t="default",n=e[0]),K=Ke(t),nt(Yt),bt(O,Qe(Yt,!1,{"class":kt+"-drop "+K})),E(n)?n(Yt):Qe(Yt,n),mt.drop.fit(),De(oe,s,gn),De(ge,u,gn),Oe("enter.drop."+t,[l]),Oe("enter.drop",[l]),l},mt.drop.fit=function(e){return H=Pe(C),j=Pe(Yt),S=mt.drop.target,K=H.w/2-j.w/2,J=H.h/2-j.h/2,!L(e)&&S&&(t=qe(S),K=t.l,J=t.t+Pe(S).h),$(e)?(L(e[0])&&(K=e[0]),L(e[1])&&(J=e[1])):(K=d(K,0,Math.max(H.w,u.innerWidth)-j.w),J=d(J,0,Math.max(H.h,u.innerHeight)-j.h)),c(Yt,{left:K+ze,top:J+ze,visibility:"visible"}),Oe("fit.drop",[l]),Oe("fit",[l]),l},mt.menu=function(e,t,n,r){t=!$(t)&&n[t]&&n[t].text||t;var s,i=mt.tools,o='<span class="'+kt+'-current menu">%1</span>',f="",u=0;return t===!1?mt.tool(e,t):($(t)&&(f=t[0],f="<"===f[0]?f:'<i class="'+Xe(wt,[f])+'"></i>',t=L(t[1])?t[1]:0,t=t&&n[t]&&n[t].text||t,o=f+(0!==t?" "+o:"")),mt.tool(e,{i:f,text:t?Xe(o,[t,f]):0,click:function(a){var c=mt.drop.target=i[e].target;return mt.drop("menu menu-"+Ke(e),function(a){function d(e){return J=this,R=n[Be(J,"tool-id")],R=_(R)?i[R]:R||{},q=tt(J),!Rt(R)&&E(r=R.click)&&(r=r(e,l),t!==!1&&c&&(S=it(c)[0]||c,st(S,"i")||et(S,Xe(o,[q,f])),$(R.text)&&(S=it(S)[0])&&st(S,"i")&&(Je(S),Ze(S,Xe(wt,[R.text[0]])))),r===!1)?Ye(e):(l.select(),Ye(e))}function p(e){if(J=this,(X=e.TE.key)("escape"))mt.exit(1);else if(X("enter"))Ie(oe,J,[e]);else if(X("f10")&&c)c.focus();else if(X("arrowdown")&&(K=ot(J))){for(;!st(K,"a")&&K;)K=ot(K);K&&K.focus()}else if(X("arrowup")&&(K=ft(J))){for(;!st(K,"a")&&K;)K=ft(K);!K&&c?(mt.exit(),c.focus()):K&&K.focus()}else X("arrowup")&&c&&(mt.exit(),c.focus());return Ye(e)}for(r in n)if(s=n[r],ee="%"===r[0],s=_(s)&&!ee?i[s]:s){s=qt(s,r,i);var b={href:ee?null:$e,"class":kt+"-"+(ee?"label":"button")};ee?W=$t[e]&&$t[e][+r.slice(1)-1]||r:(b.data={},b.data["tool-id"]=r,W=Et[r]||r),Z=s.text,Z=$(Z)?Z[1]||"":Z,W=$(W)?W[0]:W,G=Qe(ee?"span":"a",ee?"<span>"+(W||"%"+u)+"</span>":s.text||W,h(b,s.attributes||{})),!b.title&&(J=s.title)&&(G.title=$(J)?J[0]+(J[1]?" ("+J[1]+")":""):J),ee?Ne(G,{id:kt+"-label:"+u}):(Rt(s)&&Ze(G,"x"),De(oe,G,d),De(ae,G,p)),n[r]=s,bt(a,G),++u}y(function(){lt("a",a)[0].focus()},1)}),!1}},r),Se(i[e].target,"ui-drop",e),i[e].data=n,l)},mt.bubble=function(){mt.exit(0,0,0);var e=arguments,t=e[0],n=e[1];return 1===e.length&&(t="default",n=e[0]),K=Ke(t),nt(Dt),bt(O,Qe(Dt,!1,{"class":kt+"-bubble "+K})),E(n)?n(Dt):Qe(Dt,n),mt.bubble.fit(),Oe("enter.bubble."+t,[l]),Oe("enter.bubble",[l]),l},mt.bubble.fit=function(e){G=l.$(1),t=qe(Nt),F=c(Nt,"line-height");var n="border-",r="-width";K=G.caret[0].x+t.l-Nt.scrollLeft,J=G.caret[1].y+t.t+F-Nt.scrollTop,j=c(Ct,[n+"top"+r,n+"bottom"+r,n+"left"+r,n+"right"+r]);var i=Pe(Ct),o=Pe(Dt),f=j[0]+j[1],u=j[2]+j[3];return $(e)?(L(e[0])&&(K=e[0]),L(e[1])&&(J=e[1])):(K=d(K,t.l,t.l+i.w-o.w-u),J=d(J,t.t,t.t+i.h-o.h-f)),c(Dt,{left:K+ze,top:J+ze,visibility:"visible"}),Oe("fit.bubble",[l]),Oe("fit",[l]),l},mt.panel.exit=function(e){return mt.exit(e,"panel")},mt.overlay.exit=function(e){return mt.exit(e,"overlay")},mt.modal.exit=function(e){return mt.exit(e,"modal")},mt.drop.exit=function(e){return mt.exit(e,"drop")},mt.bubble.exit=function(e){return mt.exit(e,"bubble")},mt.tool=function(e,t,n){return W="","|"!==e&&(N.tools=Le(N.tools).filter(function(t,n){return t===e?(W=n,!1):!0})),t===!1?delete mt.tools[e]:("|"===e?(n=t,t={}):(E(t)&&(t={click:t}),mt.tools[e]=h(mt.tools[e]||{},t),L(n)||""===W||(n=W)),T(n)?N.tools.splice(n,0,e):N.tools.push(e)),Zt(),l},mt.key=function(e,t){return N.keys?(t===!1?delete mt.keys[e]:mt.keys[e]=t,Gt(),l):l},mt.tools={"|":{},undo:{i:"undo",click:function(e,t){return t.undo(),!1}},redo:{i:"repeat",click:function(e,t){return t.redo(),!1}},indent:function(e,t){return t.indent(xe),!1},outdent:function(e,t){return t.outdent(xe),!1}},mt.keys={"control+y":"redo","control+z":"undo",escape:function(t,n){return Z=":not([tabindex]):not([disabled])",(G=lt("input"+Z+",button"+Z+",select"+Z+",textarea"+Z+",a[href]"+Z+",[contenteditable]"+Z+',[tabindex]:not([tabindex="-1"])',s,0))&&-1!==(J=G.indexOf(e))?((G[J+1]||s).focus(),!1):void 0},f10:function(e,t){return lt("a",Ot)[0].focus(),!1},"shift+tab":ve?"outdent":0,tab:ve?"indent":0},mt.el={container:Lt,header:_t,body:Ct,footer:Mt,overlay:Bt,modal:At,drop:Yt,bubble:Dt},l.config=N,h(TE._,{time:function(){var e=new Date,t=e.getFullYear(),n=e.getMonth()+1,r=e.getDate(),i=e.getHours(),o=e.getMinutes(),f=e.getSeconds(),u=e.getMilliseconds();return 10>n&&(n="0"+n),10>r&&(r="0"+r),10>i&&(i="0"+i),10>o&&(o="0"+o),10>f&&(f="0"+f),10>u&&(u="0"+u),[""+t,""+n,""+r,""+i,""+o,""+f,""+u]},replace:We,format:Xe,dom:{set:bt,reset:gt,get:lt,id:Ve,copy:function(e,t){return e.cloneNode(L(t)?t:!0)},classes:{set:Ze,reset:Je,get:Ge},attributes:{set:Ne,reset:je,get:He},data:{set:Se,reset:Ae,get:Be},is:st,offset:qe,pointer:Re,size:Pe,content:{set:et,reset:nt,get:tt},closest:Ue,parent:rt,children:it,next:ot,previous:ft,index:ut,before:ct,after:dt,prepend:pt,append:ht},el:Qe,event:{set:De,reset:Fe,fire:Ie,x:Ye}}),h(l._,TE._),h(l._,{hooks:m,hook:{set:Ce,reset:Me,fire:Oe}}),l.create()};