/*!
 * ==========================================================
 *  USER INTERFACE MODULE FOR TEXT EDITOR PLUGIN 1.9.1
 * ==========================================================
 * Author: Taufik Nurrohman <https://github.com/tovic>
 * License: MIT
 * ----------------------------------------------------------
 */
TE.ui=function(E,T){function WE(E){return E.toLowerCase()}function KE(E){return D(E)?u(E).split(/\s+/):E}function hE(E){return H(E)?E.join(" "):E}function mE(E,T){return-1!==E.indexOf(T)}function FE(E){return Object.keys(E)}function gE(E){return E.length}function BE(E){return gE(FE(E))}function bE(E,T,A){return p(E)?p(T)?(p(C[E])||(C[E]={}),p(A)||(A=BE(C[E])),C[E][A]=T,r):C[E]:C}function vE(E,T){return p(E)?p(T)&&p(C[E])?(delete C[E][T],r):(C[E]={},r):(C={},r)}function xE(E,T,A){if(!p(C[E]))return C[E]={},r;if(p(A))p(C[E][A])&&C[E][A].apply(r,T);else for(k in C[E])C[E][k].apply(r,T);return r}function yE(E,T,A){if(H(T))for(k in T)yE(E,k,T[k]);else E[(null===A?"remove":"set")+"Attribute"](T,A)}function wE(E,A,L){if(!A){for(T={},k=0,V=E.attributes,Q=gE(V);Q>k;++k)X=V[k],T[X.name]=X.value;return BE(T)?T:p(L)?L:{}}if(D(A))return wE(E,[A],[p(L)?L:""])[0];T=[];for(k in A)k=A[k],k=E.getAttribute(k)||"",T.push(k);return gE(T)?T:p(L)?L:[]}function YE(E,T){if(H(T))for(k in T)YE(E,T[k]);else if(p(T))E.removeAttribute(T);else for(YE(E,"class"),k=0,V=E.attributes,Q=gE(V);Q>k;++k)V[k]&&YE(E,V[k].name)}function kE(E,T,A){if(H(T))for(k in T)kE(E,k,T[k]);else yE(E,"data-"+T,A)}function VE(E,A,L){if(!A){for(T={},k=0,V=E.attributes,Q=gE(V);Q>k;++k)X=V[k],"data-"===X.name.slice(0,5)&&(T[X.name]=X.value);return BE(T)?T:p(L)?L:{}}if(D(A))return VE(E,[A],[p(L)?L:""])[0];T=[];for(k in A)k=A[k],k=wE(E,"data-"+k),T.push(k);return gE(T)?T:p(L)?L:[]}function QE(E,T){if(H(T))for(k in T)YE(E,"data-"+T[k]);else if(p(T))YE(E,"data-"+T);else for(k=0,V=E.attributes,Q=gE(V);Q>k;++k)V[k]&&"data-"===V[k].name.slice(0,5)&&YE(E,V[k].name)}function XE(E){return E&&E.preventDefault(),!1}function qE(E,T,A){if(T){for(E=KE(E),k=0,V=gE(E);V>k;++k)T.addEventListener(E[k],A,!1),bE("on:"+E[k],A,iT(T));return r}}function zE(E,T,A){if(T){for(E=KE(E),k=0,V=gE(E);V>k;++k)T.removeEventListener(E[k],A,!1),vE("on:"+E[k],iT(T));return G(T)&&T.id.split(":")[0]===FT+"-dom"&&YE(T,"id"),r}}function ZE(E,T,A){E=KE(E);var e,L="createEvent"in i;for(k=0,V=gE(E);V>k;++k)L?(e=i.createEvent("HTMLEvents"),e.data=A,e.initEvent(E[k],!0,!1),T.dispatchEvent(e)):xE("on:"+E[k],A,iT(T));return r}function $E(E,T,A){for(k=0,V=gE(T),Q;V>k;++k)Q=T[k],E=E.replace(U(Q)?Q:l(N(Q),"g"),A&&A[k]||"");return E}function jE(E,T){return E.replace(/%(\d+)/g,function(E,A){return--A,p(T[A])?T[A]:E})}function JE(E){return u($E(WE(E),[/[^ \/a-z\d-]/g,/([ -])+/g,/^-|-$/g],["-","$1",""]))}function _E(E,T){var A=T.touches?T.touches[0].pageX:T.pageX,L=T.touches?T.touches[0].pageY:T.pageY,e=ET(E);return{x:A-e.l,y:L-e.t}}function ET(E){for(X=E.offsetLeft,_=E.offsetTop;E=E.offsetParent;)X+=E.offsetLeft,_+=E.offsetTop;return{l:X,t:_}}function TT(E){return E===R?{w:E.innerWidth,h:E.innerHeight}:{w:E.offsetWidth,h:E.offsetHeight}}function AT(E,T){for(;(E=NT(E))&&E!==T;);return E}function LT(E,T){T=KE(T);for(k in T)E.classList.add(T[k])}function eT(E,A,L){if(!A)return T=KE(E.className),gE(T)?T:p(L)?L:[];if(D(A))return eT(E,[A],[p(L)?L:""])[0];T=[];for(k in A)k=A[k],E.classList.contains(k)&&T.push(k);return gE(T)?T:p(L)?L:[]}function IT(E,T){if(p(T)){T=KE(T);for(k in T)E.classList.remove(T[k])}else YE(E,"class")}function tT(E,T){T=KE(T);for(k in T)E.classList.toggle(T[k])}function RT(E,T,A){if(E=E||"div",E=D(E)?i.createElement(E):E,H(A)){T||(p(A.html)?(T=A.html,delete A.html):p(A.text)&&(T=A.text,delete A.text));for(k in A)if(AE=A[k],"classes"===k)LT(E,AE);else if("data"===k)for(V in AE)AE=AE[V],null===AE?QE(E,V):kE(E,V,AE);else"css"===k?D(AE)?yE(E,"style",AE):null===AE?YE(E,"style"):o(E,AE):d(AE)?E[k]=AE:null===AE?YE(E,k):yE(E,k,M(AE)?AE.join(" "):""+AE)}if(G(T))HT(E,T);else if(H(T))for(k in T)AE=T[k],G(AE)?HT(E,AE):AE!==!1&&rT(E,AE);else p(T)&&T!==!1&&rT(E,T);return E}function iT(E){var T=E.id;return T||(T=FT+"-dom:"+Math.floor(Date.now()*Math.random()),E.id=T),T}function rT(E,T){E.innerHTML=T}function nT(E,T){return E.innerHTML||(p(T)?T:"")}function oT(E,T){if((!p(T)||T)&&(b=OT(E)))for(k=0,V=gE(b);V>k;++k)oT(b[k]);rT(E,"")}function aT(E){return Array.prototype.slice.call(E)}function NT(E){return E&&E.parentNode}function OT(E){return E&&aT(E.children||[])}function lT(E,T){return p(T)?D(T)?E.closest(T):AT(E,T):NT(E)}function sT(E){return E&&E.nextElementSibling}function ST(E){return E&&E.previousElementSibling}function uT(E){for(k=0;E=ST(E);)++k;return k}function CT(E,T){return E&&D(T)?WE(E.nodeName)===WE(T):E&&d(T)?E===T(E):E===T}function cT(E,T){return(T=p(T)?T:i)?D(E)?/^[#.]?(?:\\.|[\w-]|[^\x00-\xa0])+$/.test(E)?"#"===E[0]&&(E=T.getElementById(E.slice(1)))?[E]:"."===E[0]&&(E=T.getElementsByClassName(E.slice(1)))||(E=T.getElementsByTagName(E))?aT(E):[]:aT(T.querySelectorAll(E)):fT(E)?[E]:[]:[]}function fT(E,T){var A=NT(E);return 1===gE(arguments)?A||!1:E&&A===E?A:!1}function GT(E,T){Z=NT(E),Z&&Z.insertBefore(T,E)}function MT(E,T){Z=NT(E),Z&&Z.insertBefore(T,sT(E))}function dT(E,T){b=E.firstChild,b?GT(b,T):HT(E,T)}function PT(E,T){HT(E,T)}function HT(E,T){E.appendChild(T)}function UT(E,T){var A=NT(E);if(A){if(!p(T)||T)for(b=E.firstChild;b;)UT(b);A.removeChild(E)}}function pT(E,T){return E.cloneNode(p(T)?!!T:!0)}function DT(E,T){return NT(E).replaceChild(T,E),T}function WT(E){oT(RT(E,!1,{style:""})),UT(E)}function KT(E,T,A){return RT(T,A,{"class":E})}function IA(E){return!E||p(E.active)&&!E.active}function tA(E,T,A){return d(E)&&(E={click:E}),D(E.click)&&(E.click=(A[E.click]||{}).click),E.title=gT[T]||"",p(E.attributes)||(E.attributes={}),A[T]&&(A[T]=E),E}function RA(E){hT.exit(0,0,0);var T=VE(this,"tool-id"),A=hT.tools,L=A[T];return hT.drop.target=E.currentTarget||E.target,!IA(L)&&d(V=L.click)&&(V=V(E,r,T),xE("on:change",[E,r,T]),V===!1)?XE(E):(r.select(),XE(E))}function iA(E){if(_=this,(Q=E.TE.key)(["escape","f10"]))hT.exit(1);else if(Q("enter")||Q("down")&&VE(_,"ui-drop"))hT.drop.target=_,ZE(iE,_,[E]);else if(Q("right")&&(X=sT(_))){for(;!CT(X,"a")&&X;)X=sT(X);X&&X.focus()}else if(Q("left")&&(X=ST(_))){for(;!CT(X,"a")&&X;)X=ST(X);X&&X.focus()}return XE(E)}function nA(){oT(QT,0);var e,I,t,R,i,n,o,E=hT.tools,T=KE(m.tools),A=FT+"-button",L=FT+"-separator";m.tools=T;for(n in T)o=T[n],I=E[o],(I||I==={})&&(I=tA(I,o,E),t=I.i||o,"|"===t||mE(t,"<")||(t=JE(t)),R="|"!==t,i=JE(o).replace(/[\/\s]/g,"-"),LA=KT(R?A+" "+A+"-"+i:L+" "+L+"-"+n,R?"a":"span"),R?(LA=I.target||LA,e=A+":"+i,yE(LA,{href:pE,id:e,tabindex:-1}),kE(LA,"tool-id",o),t=mE(t,"<")?t:hT.i(i,t),IA(I)?LT(LA,"x"):IT(LA,"x"),I.on?LT(LA,"on"):IT(LA,"on"),I.text&&(t=jE('<span class="'+FT+'-text">'+I.text+"</span>",[t]),LT(LA,"text")),rT(LA,t),RT(LA,!1,I.attributes),!I.attributes.title&&(V=I.title)&&(LA.title=H(V)?V[0]+(V[1]?" ("+V[1]+")":""):V),qE(iE,LA,RA),qE(NE,LA,iA)):LA.id=L+":"+n,I.target=LA,(i=VE(LA,rA))&&hT.menu.set(o,i),HT(QT,LA));xE("update.tools",[r])}function oA(){hT.keys=function(){var A,E=FE(hT.keys).sort().reverse(),T={};for(k=0,V=gE(E);V>k;++k)A=E[k],T[A]=hT.keys[A];return T}(),NA(),xE("update.keys",[r])}function aA(E){function O(E){return E.replace(/\+/g,"\n").replace(/\n\n/g,"\n+").split("\n")}var A=r.$(),L=A.before,e=A.after,I=L.slice(-1),t=e[0],R=A.length,i=hT.keys,n=TE.keys_alias,o={control:0,shift:0,option:"alt",meta:0},a=(L.match(/(?:^|\n)([\t ]*).*$/)||[""]).pop();for(k in o)E.TE[k]()&&(F[o[k]||k]=1);z=E.TE.key(),F[z]=1,T=BE(F),S(function(){r.record()});for(k in i){Q=O(k),b=0;for(V in Q)V=Q[V],F[n[V]||V]&&++b;if(Q=gE(Q),b===Q&&T===Q&&(D(i[k])&&(i[k]=hT.tools[i[k]].click),X=d(i[k])&&i[k](E,r),X===!1))return XE(E)}if(cE)for(k in cE)if(q=cE[k],q!==!1){if(z===q&&t===q)return"\\"===I?(r.insert(z,0),XE(E)):(r.select(A.end+1),XE(E));if(k===z)return r.wrap(k,q),XE(E);if(I===k&&t===q){if("backspace"===z&&L.slice(-2)!=="\\"+k)return r.unwrap(k,q),XE(E);if(fE&&"enter"===z&&k!==q&&!R)return r.tidy("\n"+a+ME,"\n"+a).scroll(1),XE(E)}}if(fE&&!R){if("backspace"===z&&l(N(ME)+"$").test(L))return r.outdent(ME),XE(E);if("enter"===z&&l("(^|\\n)("+N(ME)+")+.*$").test(L))return r.insert("\n"+a,0,1).scroll(1),XE(E)}}function NA(E){E&&E.TE&&E.TE.key?delete F[E.TE.key()]:F={}}function uA(E){return OA=xT,J=TT(VT),XE(E)}function CA(E){OA===xT&&o(XT,{height:_E(kT,E).y-J.h+DE})}function cA(){OA=0}function fA(){hT.exit(1)}function GA(){T=TT($T),LE=T.w,Y=T.h,T=TT(ZT),lA=T.w,sA=T.h}function MA(E,T){return T&&xE("exit.modal."+T,[r]),ZE(iE,ZT,[E]),XE(E)}function dA(E){OA=E.target,T=_E($T,E),eE=T.x,IE=T.y,GA()}function PA(E){var A=SA.header,L=SA.sizer;OA===A||AT(OA,A)===A?(T=_E(kT,E),X=T.x-eE,_=T.y-IE,o($T,{left:(LE>lA?X:a(X,0,lA-LE))+DE,top:(Y>sA?_:a(_,0,sA-Y))+DE})):OA===L&&(T=_E($T,E),J=TT(L),o($T,{width:T.x+J.w/4+DE,height:T.y+J.h/4+DE}))}function HA(){OA=0}function UA(E,T,A){return{header:E,body:T,footer:A}}function pA(E){g=hT.drop.target,B=jT,b=E&&E.target||0,(!b||b!==g&&AT(b,g)!==g)&&(hT.drop.target=0,hT.exit(b===XT))}var g,B,b,y,Y,k,V,Q,X,q,z,T,Z,j,J,_,EE,AE,LE,eE,IE,A="⌘",L="…",I="⇥",t="⇧",R=window,i=document,r=new TE(E),n=r._,o=n.css,a=n.edge,N=n.x,O=n.extend,l=n.pattern,s=n.timer.reset,S=n.timer.set,u=n.trim,C={},c=function(){},f=TE.is,G=f.e,M=f.a,d=f.f,P=f.i,H=f.o,U=f.r,p=function(E){return!f.x(E)},D=f.s,W=i.documentElement,h=(i.head,i.body),m=O({tab:"  ",direction:"ltr",path:TE.path,resize:1,keys:1,tools:"indent outdent | undo redo",attributes:{spellcheck:"false"},union:[[["\\u003C","\\u003E","\\u002F"],["\\u003D","\\u0022","\\u0022","\\u0020"]],[["<",">","/"],["=",'"','"'," "]]],auto_tab:1,auto_close:{'"':'"',"'":"'","(":")","{":"}","[":"]","<":">"},languages:{tools:{tools:["Focus Tools","F10"],undo:["Undo",A+"+Z"],redo:["Redo",A+"+Y"],indent:["Indent",I],outdent:["Outdent",t+"+"+I]},buttons:{okay:"OK",cancel:"Cancel",yes:"Yes",no:"No",enter:"Enter",exit:"Exit",open:"Open",close:"Close",ignore:"Ignore"},placeholders:{"":"text here"+L},labels:{},others:{}},classes:{"":"text-editor",i:"text-editor-i text-editor-i-%1 text-editor-i-%1--%2 fa fa-%2"}},T),F={},RE="blur",iE="click",NE="keydown",OE="keyup",lE="touchstart mousedown",sE="touchmove mousemove",SE="touchend mouseup",CE="orientationchange resize",cE=m.auto_close,fE=m.auto_tab,GE=m.languages,ME=m.tab,PE=(m.union[1][1],m.union[1][0]),HE=m.union[0][1],UE=m.union[0][0],pE="javascript:;",DE="px",hT=r.ui={};r.tidy=function(E,T){var A=r.$(),L=u(A.before)?E:"",e=u(A.after)?p(T)?T:E:"";return r.trim(L,e)},r.i=function(){return u(r.replace(/\s+/g," "))},r.format=function(E,T,A,L){H(E)||(E=[E]),p(A)||(A=" "),p(L)||(L="");var e=r.h,I=r[0]().$(),t=E[0].split(l("("+HE[3]+")+"))[0],R=(E[0]?PE[0]+E[0]+PE[1]:"")+L,i=L+(E[0]?PE[0]+PE[2]+(E[1]||t)+PE[1]:""),n=N(E[0]?PE[0]+t+PE[1]:""),o=N(i),a=l("^"+n+"([\\s\\S]*?)"+o+"$"),O=l(n+"$"),s=l("^"+o),S=I.before,u=I.after;return I.length?A=!1:r.insert(GE.placeholders[""]),r.toggle(T?!a.test(I.value):!O.test(S)&&!s.test(u),[function(E){E.unwrap(R,i,1).tidy(l(UE[0]+"[^"+UE[0]+UE[1]+UE[2]+"]+?"+UE[1]+"$").test(S)?"":A,l("^"+UE[0]+UE[2]+"[^"+UE[0]+UE[1]+"]+?"+UE[1]).test(u)?"":A).wrap(R,i,T)},function(E){E.unwrap(R,i,T)}])[e]()};var LA,mT=m.classes,FT=mT[""],gT=GE.tools,BT=GE.buttons,bT=GE.labels,vT=FT+"-textarea "+FT+"-content block",xT=KT(FT+"-sizer s"),yT=KT(FT+"-sizer se"),wT=KT(FT),YT=KT(FT+"-header"),kT=KT(FT+"-body"),VT=KT(FT+"-footer"),QT=KT(FT+"-tool"),XT=RT(E,!1,m.attributes),qT=KT(FT+"-description"),zT=RT(),ZT=RT(),$T=RT(),jT=RT(),JT=RT(),_T=RT(),EA=KT("left","span"),TA=KT("right","span"),AA=0;hT.i=function(E,T,A){return E=JE(E).replace(/[\/\s]/g,"-"),J=jE(mT.i,[E,T||E]),A?(IT(A),LT(A,J),A):'<i class="'+J+'"></i>'},p(m.suffix)||(m.suffix=PE[1]);var rA="ui-drop-data",OA=0,eE=0,IE=0,LE=0,Y=0,lA=0,sA=0,SA={};r.create=function(E,T){if(r.is.create)return r;r.is.create=!0,H(E)&&(m=O(m,E));var A=fT(XT);return LT(wT,FT+"-is-can-update"),LT(wT,FT+"-is-can-copy"),LT(XT,vT),A&&CT(A,"p")?(GT(A,wT),AA=A,UT(A,!1)):GT(XT,wT),wT.dir=m.direction,HT(wT,YT),HT(wT,kT),HT(wT,VT),HT(kT,XT),m.tools&&(HT(YT,QT),HT(VT,qT),HT(qT,EA),HT(qT,TA)),qE(NE,XT,aA),qE(OE+" "+RE,XT,NA),m.resize&&(HT(wT,xT),LT(wT,FT+"-is-can-resize"),qE(lE,xT,uA),qE(sE,i,CA),qE(SE,h,cA)),nA(),oA(),0!==T?xE("create",[r]):r},r.update=function(E,T){return r.is.create&&r.destroy(0),(0!==T?xE("update",[r]):r).create(E,0)},r.destroy=function(E){return r.is.create?(r.is.create=!1,hT.exit(0,0,0),IT(XT,vT),m.tools=hE(m.tools),m.keys&&(zE(NE,XT,aA),zE(OE,XT,NA)),m.resize&&(zE(lE,xT,uA),zE(sE,i,CA),zE(SE,i,cA)),AA?(GT(wT,AA),HT(AA,XT),AA=0):GT(wT,XT),WT(wT),0!==E?xE("destroy",[r]):r):r},r.enable=function(E){return XT.disabled=XT.readOnly=!1,LT(wT,FT+"-is-can-update"),LT(wT,FT+"-is-can-copy"),0!==E?xE("enable",[r]):r},r.disable=function(E){return XT.disabled=!0,IT(wT,FT+"-is-can-update"),IT(wT,FT+"-is-can-copy"),0!==E?xE("disable",[r]):r},r.freeze=function(E){return XT.disabled=!1,XT.readOnly=!0,IT(wT,FT+"-is-can-update"),LT(wT,FT+"-is-can-copy"),0!==E?xE("freeze",[r]):r},hT.exit=function(E,T,A){if(y={panel:function(){WT(zT)},overlay:function(){zE(iE,ZT,fA),WT(ZT)},modal:function(){zE(iE+" "+NE,SA.x,MA),zE(lE,kT,dA),zE(sE,kT,PA),zE(SE,i,HA),WT($T)},drop:function(){zE(iE,i,pA),zE(CE,R,pA),WT(jT)},bubble:function(){WT(JT)}},NA(),T)if(H(T))for(k in T)k=T[k],y[k]&&y[k](),0!==A&&xE("exit."+k,[r]);else y[T]&&y[T](),0!==A&&xE("exit."+k,[r]);else for(k in y)y[k]();return E&&r.select(),0!==A&&xE("exit",[r]),r},hT.panel=function(E,T,A,L){function e(E){return zE(iE+" "+NE,eE,e),hT.panel.exit(1),XE(E)}return hT.exit(0,0,0),X=JE(E),_=0,L&&(X+=" "+X+"--"+JE(L)),H(T)&&!G(T)&&(_=KT(FT+"-panel-header "+X,0,T.header),T=T.body),EE=KT(FT+"-panel-body "+X,0,KT(FT+"-panel-content "+X,0,d(T)?"":T)),d(T)&&T(EE),eE=RT("a",!1,{href:pE,"class":FT+"-a "+FT+"-x "+X}),eE.title=BT.close,RT(zT,!1,{"class":FT+"-panel "+X}),qE(iE+" "+NE,eE,e),oT(zT,0),_&&HT(zT,_),HT(kT,RT(zT,[EE,eE])),d(A)?A(zT):D(A)&&RT(zT,A),g=[r,zT],L&&xE("enter.panel."+E+":"+L,g),xE("enter.panel."+E,g),xE("enter.panel",g),xE("enter",g),eE.focus(),r},hT.panel.fit=function(){},hT.overlay=function(E,T,A,L){return hT.exit(0,0,0),X=JE(E),L&&(X+=" "+X+"--"+JE(L)),HT(kT,RT(ZT,!1,{"class":FT+"-overlay "+X})),T&&qE(iE,ZT,fA),d(A)?A(ZT):D(A)&&RT(ZT,A),g=[r,ZT],L&&xE("enter.overlay."+E+":"+L,g),xE("enter.overlay."+E,g),xE("enter.overlay",g),xE("enter",g),r},hT.overlay.fit=function(){},hT.message=function(E,T,A,L,e){function t(E){return zE(iE+" "+NE,eE,t),s(I),hT.overlay.exit(1),XE(E)}var I;return X=JE(E),e&&(X+=" "+X+"--"+JE(e)),eE=RT("a",!1,{href:pE,"class":FT+"-a "+FT+"-x "+X}),eE.title=BT.close,RT(_T,d(T)?T(_T):T,{"class":FT+"-message "+X}),qE(iE+" "+NE,eE,t),hT.overlay("message message-"+X,0,function(E){HT(_T,eE),A&&(I=S(function(){t()},A)),HT(E,_T)},e),d(L)?L(_T):D(L)&&RT(_T,L),r},hT.modal=function(){var R,n,E=arguments,T=E[0],A=E[1],L=E[2],e=E[3],I=FT+"-modal",t=A.footer;if(H(T)&&(T="default",A=E[0],L=E[1],e=E[2]),hT.overlay(T,1,0,e).blur(),X=JE(T),e&&(X+=" "+X+"--"+JE(e)),RT($T,!1,{"class":I+" "+X}),p(A.body)&&(A.body=RT("div",A.body,{"class":I+"-content "+X})),p(t)&&H(t)&&!G(t)){n=[];for(k in t)V=t[k],G(V)?n.push(V):(V=tA(V,k,t),Q=k.text||BT[k]||k,R=RT("button",Q,O({name:"y["+k+"]",type:"button","class":FT+"-button",data:{"button-id":k}},V.attributes)),qE(iE,R,function(E){return Q=t[VE(this,"button-id")].click(E,r),Q===!1?XE(E):void 0}),n.push(R));A.footer=n}for(k in A)I[1]=k,SA[k]=KT(I+"-"+jE(k,I)+" "+X,0,A[k]);return SA.x=RT("a",!1,{href:pE,"class":FT+"-a "+FT+"-x "+X}),SA.sizer=yT,oT($T,0),SA.x.title=BT.close,HT(kT,RT($T,SA,{style:""})),hT.modal.fit(),MT($T,ZT),qE(iE+" "+NE,SA.x,MA),qE(lE,SA.header,XE),qE(lE,SA.sizer,XE),qE(lE,kT,dA),qE(sE,kT,PA),qE(SE,i,HA),d(L)&&L(SA),g=[r,$T,SA],e&&xE("enter.modal."+T+":"+e,g),xE("enter.modal."+T,g),xE("enter.modal",g),xE("enter",g),SA.x.focus(),r},hT.modal.fit=function(E){return GA(),X=lA/2-LE/2,_=sA/2-Y/2,H(E)?(p(E[0])&&(X=E[0]),p(E[1])&&(_=E[1])):(X=a(X,0),_=a(_,0)),o($T,{left:X+DE,top:_+DE,"min-width":LE+DE,"min-height":Y+DE,visibility:"visible"}),g=[r,$T,SA],xE("fit.modal",g),xE("fit",g),r};var DA={"class":FT+"-button",name:"y"};return hT.alert=function(E,T,A,L,e){var I=RT("button",BT.okay,DA),t="alert";return A=A||c,H(E)&&(t+=":"+E[0],E=E[1]||E[0]),qE(iE,I,function(E){return A(E,r),MA(E,t+".y")}),qE(NE,I,function(E){var T=E.TE.key;return T(["enter","escape"])&&ZE(iE,I,[E]),XE(E)}),hT.modal(t,UA(E,T,I),L,e),I.focus(),r},hT.confirm=function(E,T,A,L,e,I){function o(E){return d(A)&&A(E,r),MA(E,i+".y")}function a(E){return d(L)&&L(E,r),MA(E,i+".n")}var n,t=RT("button",BT.okay,DA),R=RT("button",BT.cancel,DA),i="confirm";return R.name="n",qE(iE,t,o),qE(iE,R,a),qE(NE,t,function(E){return n=E.TE.key,n("right")?R.focus():n("enter")?o(E):n("escape")&&MA(E,i+".y"),XE(E)}),qE(NE,R,function(E){return n=E.TE.key,n("left")?t.focus():n("enter")?a(E):n("escape")&&MA(E,i+".n"),XE(E)}),hT.modal(i,UA(E,T,[t,R]),e,I),R.focus(),r},hT.prompt=function(E,T,A,L,e,I,t){function s(){n.focus(),"placeholder"in n&&n.select()}function S(E){return N=n.value,d(A)&&!A(N)?s():!A||u(N)&&N!==T?(MA(E,o+".y"),L(E,r,N!==T?N:"",T)):s(),XE(E)}function C(E){return MA(E,o+".n")}var N,O,l,R=RT("button",BT.okay,DA),i=RT("button",BT.cancel,DA),n=RT("input",!1,{type:"text",value:T,placeholder:T,spellcheck:"false","class":FT+"-input block"}),o="prompt",a=[];if(e=e||0,1===e)n=RT("textarea",T,{placeholder:T.split("\n")[0],"class":FT+"-textarea block",spellcheck:"false"});else if(2===e){for(k in T)a.push(RT("option",T[k],{value:k,selected:k===A||null}));n=RT("select",a,{"class":FT+"-select block"})}return L=L||c,n.name="data",i.name="n",qE(NE,n,function(E){return O=E.TE.key,l=E.TE.control,O("enter")&&0===e||l("enter")?S(E):O("escape")||O("back")&&!this.value?C(E):O("down")&&0===e||O("enter")&&2===e||l("down")?(R.focus(),XE(E)):void 0}),qE(NE,R,function(E){return O=E.TE.key,O("enter")?S(E):O("escape")?C(E):O("up")?n.focus():O("right")&&i.focus(),XE(E)}),qE(NE,i,function(E){return O=E.TE.key,O(["enter","escape"])?C(E):O("up")?n.focus():O("left")&&R.focus(),XE(E)}),qE(iE,R,S),qE(iE,i,C),hT.modal(o,UA(E,n,[R,i]),I,t),s(),r},hT.drop=function(){hT.exit(0,0,0);var E=arguments,T=E[0],A=E[1],L=E[2];return 1===gE(E)&&(T="default",A=E[0],L=E[1]),X=JE(T),oT(jT,0),HT(h,RT(jT,!1,{"class":FT+"-drop "+X})),d(A)?A(jT):RT(jT,A),hT.drop.fit(),L===!1||(qE(iE,i,pA),qE(CE,R,pA)),g=[r,jT],xE("enter.drop."+T,g),xE("enter.drop",g),r},hT.drop.fit=function(E){return g=TT(W),B=TT(jT),b=hT.drop.target,X=g.w/2-B.w/2,_=g.h/2-B.h/2,!p(E)&&b&&(T=ET(b),X=T.l,_=T.t+TT(b).h),H(E)?(p(E[0])&&(X=E[0]),p(E[1])&&(_=E[1])):(X=a(X,0,g.w-B.w),_=a(_,0,Math.max(g.h,TT(R).h)-B.h)),o(jT,{left:X+DE,top:_+DE,visibility:"visible"}),g=[r,jT],xE("fit.drop",g),xE("fit",g),r},hT.menu=function(E,A,L,e){var R,I=hT.tools,t=0;if(A===!1)return hT.tool(E,A);for(e in L)LE="%"===e[0],R=L[e],R=D(R)&&!LE?I[R]:R,R&&(R=tA(R,e,I),L[e]=R);return hT.tool(E,{i:H(A)?A[0]:0,text:H(A)?A[1]||0:A&&L[A]&&L[A].text||A,click:function(i){var n=hT.drop.target=I[E].target;return hT.drop("menu menu-"+JE(E),function(i){function o(t){return _=this,T=VE(_,"tool-id"),q=L[T],q=D(q)?I[q]:q||{},z=nT(_),!IA(q)&&d(e=q.click)&&(e=e(t,r),q.i&&(I[E].i=q.i),hT.menu.set(E,H(q.text)?[q.text[0],T]:H(A)?[A[0],T]:T),e===!1)?(r.select(),XE(t)):(r.select(),XE(t))}function a(E){if(_=this,(Q=E.TE.key)("escape"))hT.exit(1);else if(Q("enter"))ZE(iE,_,[E]);else if(Q("f10")&&n)n.focus();else if(Q("down")&&(X=sT(_))){for(;!CT(X,"a")&&X;)X=sT(X);X&&X.focus()}else if(Q("up")&&(X=ST(_))){for(;!CT(X,"a")&&X;)X=ST(X);!X&&n?(hT.exit(),n.focus()):X&&X.focus()}else Q("up")&&n&&(hT.exit(),n.focus());return XE(E)}for(e in L)if(R=L[e],LE="%"===e[0],R){var N={href:LE?null:pE,"class":FT+"-"+(LE?"label":"button")};LE?V=bT[E]&&bT[E][+e.slice(1)-1]||e:(N.data={},N.data["tool-id"]=e,V=gT[e]||e),j=R.text,j=H(j)?j[1]||"":j,V=H(V)?V[0]:V,J=RT(LE?"span":"a","<span>"+(LE?V||"%"+t:j||V)+"</span>",O(N,R.attributes||{})),LT(J,"menu-"+JE(e).replace(/[\/\s]/g,"-")),!N.title&&(_=R.title)&&(J.title=H(_)?_[0]+(_[1]?" ("+_[1]+")":""):_),LE?yE(J,{id:FT+"-label:"+t}):(IA(R)?LT(J,"x"):IT(J,"x"),R.on?LT(J,"on"):IT(J,"on"),qE(iE,J,o),qE(NE,J,a)),HT(i,J),++t}S(function(){(cT('[data-tool-id="'+VE(n,rA)+'"]',i)[0]||cT("a",i)[0]).focus()},1)}),!1}},e),kE(I[E].target,{"ui-drop":E}),I[E].data=L,hT.menu.set(E,A)},hT.menu.set=function(E,T){var I,t,A=hT.tools[E]||{},L=A.target,e=A.data;return L?(H(T)?kE(L,rA,T[1]||""):(kE(L,rA,T),T=e[T]&&e[T].text||T),H(T)?(t=T[0],t=mE(t,"<")?t:hT.i(t,A.i),T=p(T[1])?T[1]:0,T=T&&e[T]&&e[T].text||T,T=t+(0!==T?"<span>"+(H(T)?T[1]||T:T)+"</span>":"")):t=hT.i(E,A.i),(I=cT("."+FT+"-text",L)[0])?(LT(L,"text"),rT(I,T)):(IT(L,"text"),rT(L,t)),r):r},hT.bubble=function(){hT.exit(0,0,0);var E=arguments,T=E[0],A=E[1];return 1===gE(E)&&(T="default",A=E[0]),X=JE(T),oT(JT,0),HT(h,RT(JT,!1,{"class":FT+"-bubble "+X})),d(A)?A(JT):RT(JT,A),hT.bubble.fit(),g=[r,JT],xE("enter.bubble."+T,g),xE("enter.bubble",g),r},hT.bubble.fit=function(E){J=r.$(1),T=ET(XT),Y=o(XT,"line-height");var A="border-",L="-width";X=J.caret[0].x+T.l-XT.scrollLeft,_=J.caret[1].y+T.t+Y-XT.scrollTop,B=o(kT,[A+"top"+L,A+"bottom"+L,A+"left"+L,A+"right"+L]);var e=TT(kT),I=TT(JT),t=B[0]+B[1],R=B[2]+B[3];return H(E)?(p(E[0])&&(X=E[0]),p(E[1])&&(_=E[1])):(X=a(X,T.l,T.l+e.w-I.w-R),_=a(_,T.t,T.t+e.h-I.h-t)),o(JT,{left:X+DE,top:_+DE,visibility:"visible"}),g=[r,JT],xE("fit.bubble",g),xE("fit",g),r},hT.panel.exit=function(E){return hT.exit(E,"panel")},hT.overlay.exit=function(E){return hT.exit(E,"overlay")},hT.modal.exit=function(E){return hT.exit(E,"modal")},hT.drop.exit=function(E){return hT.exit(E,"drop")},hT.bubble.exit=function(E){return hT.exit(E,"bubble")},hT.tool=function(E,T,A){var L=hT.tools;return V="",Q=p(L[E])?"update":"create","|"!==E&&(m.tools=KE(m.tools).filter(function(T,A){return T===E?(V=A,!1):!0})),T===!1?(delete L[E],Q="destroy"):("|"===E?(A=T,T={}):(d(T)&&(T={click:T}),L[E]=O(L[E]||{},T),p(A)||""===V||(A=V)),P(A)?m.tools.splice(A,0,E):m.tools.push(E)),xE(Q+".tool."+E,[r,L[E]]),nA(),r},hT.separator=function(E,T){return hT.tool("|",E!==!1?{attributes:E||{}}:!1,T)},hT.key=function(E,T){var A=hT.keys;return Q=p(A[E])?"update":"create",T===!1?(delete A[E],Q="destroy"):A[E]=T,xE(Q+".key."+E,[r,A[E]]),oA(),r},hT.key.set=function(E){F[E]=1},hT.key.reset=function(E){E?delete F[E]:F={}},hT.tools={"|":{},undo:{i:"undo",click:function(E,T){return T.undo(),!1}},redo:{i:"repeat",click:function(E,T){return T.redo(),!1}},indent:function(E,T){return T.indent(ME),!1},outdent:function(E,T){return T.outdent(ME),!1}},hT.keys={"control+y":"redo","control+z":"undo",escape:function(E,T){return j=":not([tabindex]):not([disabled])",(J=cT("input"+j+",button"+j+",select"+j+",textarea"+j+",a[href]"+j+",[contenteditable]"+j+',[tabindex]:not([tabindex="-1"])',i,0))&&-1!==(_=J.indexOf(XT))?((J[_+1]||i).focus(),!1):void 0},f10:function(E,T){return cT("a",QT)[0].focus(),!1},tab:fE?"indent":0,"shift+tab":fE?"outdent":0},hT.el={container:wT,header:YT,body:kT,footer:VT,panel:zT,overlay:ZT,modal:$T,drop:jT,bubble:JT},r.config=m,O(TE._,{time:function(E){var T=new Date(p(E)?E:Date.now()),A=T.getFullYear(),L=T.getMonth()+1,e=T.getDate(),I=T.getHours(),t=T.getMinutes(),R=T.getSeconds(),i=T.getMilliseconds();return 10>L&&(L="0"+L),10>e&&(e="0"+e),10>I&&(I="0"+I),10>t&&(t="0"+t),10>R&&(R="0"+R),10>i&&(i="0"+i),[""+A,""+L,""+e,""+I,""+t,""+R,""+i]},replace:$E,format:jE,dom:{set:HT,reset:UT,get:cT,id:iT,copy:pT,replace:DT,classes:{set:LT,reset:IT,toggle:tT,get:eT},attributes:{set:yE,reset:YE,get:wE},data:{set:kE,reset:QE,get:VE},is:CT,offset:ET,pointer:_E,size:TT,content:{set:rT,reset:oT,get:nT},closest:AT,parent:NT,children:OT,closest:lT,next:sT,previous:ST,index:uT,before:GT,after:MT,prepend:dT,append:PT},el:RT,events:{set:qE,reset:zE,fire:ZE,x:XE}}),O(r._,TE._),O(r._,{hooks:{set:bE,reset:vE,fire:xE}}),r.create()};