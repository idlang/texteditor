/*!
 * ==========================================================
 *  USER INTERFACE MODULE FOR TEXT EDITOR PLUGIN 1.10.0
 * ==========================================================
 * Author: Taufik Nurrohman <https://github.com/tovic>
 * License: MIT
 * ----------------------------------------------------------
 */
TE.ui=function(A,E){function BA(A){return A.toLowerCase()}function PA(A){return B(A)?G(A).split(/\s+/):A}function WA(A){return H(A)?A.join(" "):A}function KA(A,E){return-1!==A.indexOf(E)}function pA(A){return Object.keys(A)}function YA(A){return A.length}function gA(A){return YA(pA(A))}function hA(A,E,e){return U(A)?U(E)?(U(F[A])||(F[A]={}),U(e)||(e=gA(F[A])),F[A][e]=E,N):F[A]:F}function mA(A,E){return U(A)?U(E)&&U(F[A])?(delete F[A][E],N):(F[A]={},N):(F={},N)}function bA(A,E,e){if(!U(F[A]))return F[A]={},N;if(U(e))U(F[A][e])&&F[A][e].apply(N,E);else for(Q in F[A])F[A][Q].apply(N,E);return N}function xA(A,E,e){if(H(E))for(Q in E)xA(A,Q,E[Q]);else A[(null===e?"remove":"set")+"Attribute"](E,e)}function yA(A,e,T){if(!e){for(E={},Q=0,V=A.attributes,k=YA(V);k>Q;++Q)z=V[Q],E[z.name]=z.value;return gA(E)?E:U(T)?T:{}}if(B(e))return yA(A,[e],[U(T)?T:""])[0];E=[];for(Q in e)Q=e[Q],Q=A.getAttribute(Q)||"",E.push(Q);return YA(E)?E:U(T)?T:[]}function vA(A,E){if(H(E))for(Q in E)vA(A,E[Q]);else if(U(E))A.removeAttribute(E);else for(vA(A,"class"),Q=0,V=A.attributes,k=YA(V);k>Q;++Q)V[Q]&&vA(A,V[Q].name)}function wA(A,E,e){if(H(E))for(Q in E)wA(A,Q,E[Q]);else xA(A,"data-"+E,e)}function QA(A,e,T){if(!e){for(E={},Q=0,V=A.attributes,k=YA(V);k>Q;++Q)z=V[Q],"data-"===z.name.slice(0,5)&&(E[z.name]=z.value);return gA(E)?E:U(T)?T:{}}if(B(e))return QA(A,[e],[U(T)?T:""])[0];E=[];for(Q in e)Q=e[Q],Q=yA(A,"data-"+Q),E.push(Q);return YA(E)?E:U(T)?T:[]}function VA(A,E){if(H(E))for(Q in E)vA(A,"data-"+E[Q]);else if(U(E))vA(A,"data-"+E);else for(Q=0,V=A.attributes,k=YA(V);k>Q;++Q)V[Q]&&"data-"===V[Q].name.slice(0,5)&&vA(A,V[Q].name)}function kA(A){return A&&A.preventDefault(),!1}function zA(A,E,e){if(E){for(A=PA(A),Q=0,V=YA(A);V>Q;++Q)E.addEventListener(A[Q],e,!1),hA("on:"+A[Q],e,tE(E));return N}}function JA(A,E,e){if(E){for(A=PA(A),Q=0,V=YA(A);V>Q;++Q)E.removeEventListener(A[Q],e,!1),mA("on:"+A[Q],tE(E));return M(E)&&E.id.split(":")[0]===YE+"-dom"&&vA(E,"id"),N}}function XA(A,E,e){A=PA(A);var L,T="createEvent"in t;for(Q=0,V=YA(A);V>Q;++Q)T?(L=t.createEvent("HTMLEvents"),L.data=e,L.initEvent(A[Q],!0,!1),E.dispatchEvent(L)):bA("on:"+A[Q],e,tE(E));return N}function ZA(A,E,e){for(Q=0,V=YA(E),k;V>Q;++Q)k=E[Q],A=A.replace(d(k)?k:C(r(k),"g"),e&&e[Q]||"");return A}function jA(A,E){return A.replace(/%(\d+)/g,function(A,e){return--e,U(E[e])?E[e]:A})}function qA(A){return G(ZA(BA(A),[/[^ \/a-z\d-]/g,/([ -])+/g,/^-|-$/g],["-","$1",""]))}function _A(A,E){var e=E.touches?E.touches[0].pageX:E.pageX,T=E.touches?E.touches[0].pageY:E.pageY,L=$A(A);return{x:e-L.l,y:T-L.t}}function $A(A){for(z=A.offsetLeft,$=A.offsetTop;A=A.offsetParent;)z+=A.offsetLeft,$+=A.offsetTop;return{l:z,t:$}}function AE(A){return A===O?{w:A.innerWidth,h:A.innerHeight}:{w:A.offsetWidth,h:A.offsetHeight}}function EE(A,E){for(;(A=rE(A))&&A!==E;);return A}function eE(A,E){E=PA(E);for(Q in E)A.classList.add(E[Q])}function LE(A,e,T){if(!e)return E=PA(A.className),YA(E)?E:U(T)?T:[];if(B(e))return LE(A,[e],[U(T)?T:""])[0];E=[];for(Q in e)Q=e[Q],A.classList.contains(Q)&&E.push(Q);return YA(E)?E:U(T)?T:[]}function IE(A,E){if(U(E)){E=PA(E);for(Q in E)A.classList.remove(E[Q])}else vA(A,"class")}function RE(A,E){E=PA(E);for(Q in E)A.classList.toggle(E[Q])}function OE(A,E,e){if(A=A||"div",A=B(A)?t.createElement(A):A,H(e)){E||(U(e.html)?(E=e.html,delete e.html):U(e.text)&&(E=e.text,delete e.text));for(Q in e)if(EA=e[Q],"classes"===Q)eE(A,EA);else if("data"===Q)for(V in EA)EA=EA[V],null===EA?VA(A,V):wA(A,V,EA);else"css"===Q?B(EA)?xA(A,"style",EA):null===EA?vA(A,"style"):n(A,EA):u(EA)?A[Q]=EA:null===EA?vA(A,Q):xA(A,Q,f(EA)?EA.join(" "):""+EA)}if(M(E))HE(A,E);else if(H(E))for(Q in E)EA=E[Q],M(EA)?HE(A,EA):EA!==!1&&NE(A,EA);else U(E)&&E!==!1&&NE(A,E);return A}function tE(A){var E=A.id;return E||(E=YE+"-dom:"+Math.floor(Date.now()*Math.random()),A.id=E),E}function NE(A,E){A.innerHTML=E}function iE(A,E){return A.innerHTML||(U(E)?E:"")}function nE(A,E){if((!U(E)||E)&&(m=SE(A)))for(Q=0,V=YA(m);V>Q;++Q)nE(m[Q]);NE(A,"")}function oE(A){return Array.prototype.slice.call(A)}function rE(A){return A&&A.parentNode}function SE(A){return A&&oE(A.children||[])}function CE(A,E){return U(E)?B(E)?A.closest(E):EE(A,E):rE(A)}function aE(A){return A&&A.nextElementSibling}function lE(A){return A&&A.previousElementSibling}function GE(A){for(Q=0;A=lE(A);)++Q;return Q}function FE(A,E){return A&&B(E)?BA(A.nodeName)===BA(E):A&&u(E)?A===E(A):A===E}function cE(A,E){return(E=U(E)?E:t)?B(A)?/^[#.]?(?:\\.|[\w-]|[^\x00-\xa0])+$/.test(A)?"#"===A[0]&&(A=E.getElementById(A.slice(1)))?[A]:"."===A[0]&&(A=E.getElementsByClassName(A.slice(1)))||(A=E.getElementsByTagName(A))?oE(A):[]:oE(E.querySelectorAll(A)):sE(A)?[A]:[]:[]}function sE(A,E){var e=rE(A);return 1===YA(arguments)?e||!1:A&&e===A?e:!1}function ME(A,E){Z=rE(A),Z&&Z.insertBefore(E,A)}function fE(A,E){Z=rE(A),Z&&Z.insertBefore(E,aE(A))}function uE(A,E){m=A.firstChild,m?ME(m,E):HE(A,E)}function DE(A,E){HE(A,E)}function HE(A,E){A.appendChild(E)}function dE(A,E){var e=rE(A);if(e){if(!U(E)||E)for(m=A.firstChild;m;)dE(m);e.removeChild(A)}}function UE(A,E){return A.cloneNode(U(E)?!!E:!0)}function BE(A,E){return rE(A).replaceChild(E,A),E}function PE(A){nE(OE(A,!1,{style:""})),dE(A)}function WE(A,E,e){return OE(E,e,{"class":A})}function Ie(A){return!A||U(A.active)&&!A.active}function Re(A,E,e){return u(A)&&(A={click:A}),B(A.click)&&(A.click=(e[A.click]||{}).click),A.title=gE[E]||"",U(A.attributes)||(A.attributes={}),e[E]&&(e[E]=A),A}function Oe(A){KE.exit(0,0,0);var E=QA(this,"tool-id"),e=KE.tools,T=e[E];return KE.drop.target=A.currentTarget||A.target,!Ie(T)&&u(V=T.click)&&(V=V(A,N,E),bA("on:change",[A,N,E]),V===!1)?kA(A):(N.select(),kA(A))}function te(A){if($=this,(k=A.TE.key)(["escape","f10"]))KE.exit(1);else if(k("enter")||k("down")&&QA($,"ui-drop"))KE.drop.target=$,XA(OA,$,[A]);else if(k("right")&&(z=aE($))){for(;!FE(z,"a")&&z;)z=aE(z);z&&z.focus()}else if(k("left")&&(z=lE($))){for(;!FE(z,"a")&&z;)z=lE(z);z&&z.focus()}return kA(A)}function ie(){nE(kE,0);var L,I,R,O,t,i,n,A=KE.tools,E=PA(p.tools),e=YE+"-button",T=YE+"-separator";p.tools=E;for(i in E)n=E[i],I=A[n],(I||I==={})&&(I=Re(I,n,A),R=I.i||n,"|"===R||KA(R,"<")||(R=qA(R)),O="|"!==R,t=qA(n).replace(/[\/\s]/g,"-"),Te=WE(O?e+" "+e+"-"+t:T+" "+T+"-"+i,O?"a":"span"),O?(Te=I.target||Te,L=e+":"+t,xA(Te,{href:dA,id:L,tabindex:-1}),wA(Te,"tool-id",n),R=KA(R,"<")?R:KE.i(t,R),Ie(I)?eE(Te,"x"):IE(Te,"x"),I.on?eE(Te,"on"):IE(Te,"on"),I.text&&(R=jA('<span class="'+YE+'-text">'+I.text+"</span>",[R]),eE(Te,"text")),NE(Te,R),OE(Te,!1,I.attributes),!I.attributes.title&&(V=I.title)&&(Te.title=H(V)?V[0]+(V[1]?" ("+V[1]+")":""):V),zA(OA,Te,Oe),zA(oA,Te,te)):Te.id=T+":"+i,I.target=Te,(t=QA(Te,Ne))&&KE.menu.set(n,t),HE(kE,Te));bA("update.tools",[N])}function ne(){KE.keys=function(){var e,A=pA(KE.keys).sort().reverse(),E={};for(Q=0,V=YA(A);V>Q;++Q)e=A[Q],E[e]=KE.keys[e];return E}(),re(),bA("update.keys",[N])}function oe(A){function S(A){return A.replace(/\+/g,"\n").replace(/\n\n/g,"\n+").split("\n")}var e=N.$(),T=e.before,L=e.after,I=T.slice(-1),R=L[0],O=e.length,t=KE.keys,i=TE.keys_alias,n={control:0,shift:0,option:"alt",meta:0},o=(T.match(/(?:^|\n)([\t ]*).*$/)||[""]).pop();for(Q in n)A.TE[Q]()&&(Y[n[Q]||Q]=1);X=A.TE.key(),Y[X]=1,E=gA(Y),l(function(){N.record()});for(Q in t){k=S(Q),m=0;for(V in k)V=k[V],Y[i[V]||V]&&++m;if(k=YA(k),m===k&&E===k&&(B(t[Q])&&(t[Q]=KE.tools[t[Q]].click),z=u(t[Q])&&t[Q](A,N),z===!1))return kA(A)}if(FA)for(Q in FA)if(J=FA[Q],J!==!1){if(X===J&&R===J)return"\\"===I?(N.insert(X,0),kA(A)):(N.select(e.end+1),kA(A));if(Q===X)return N.wrap(Q,J),kA(A);if(I===Q&&R===J){if("backspace"===X&&T.slice(-2)!=="\\"+Q)return N.unwrap(Q,J),kA(A);if(cA&&"enter"===X&&Q!==J&&!O)return N.tidy("\n"+o+MA,"\n"+o).scroll(1),kA(A)}}if(cA&&!O){if("backspace"===X&&C(r(MA)+"$").test(T))return N.outdent(MA),kA(A);if("enter"===X&&C("(^|\\n)("+r(MA)+")+.*$").test(T))return N.insert("\n"+o,0,1).scroll(1),kA(A)}}function re(A){A&&A.TE&&A.TE.key?delete Y[A.TE.key()]:Y={}}function Ge(A){return Se=xE,_=AE(VE),kA(A)}function Fe(A){Se===xE&&n(zE,{height:_A(QE,A).y-_.h+UA})}function ce(){Se=0}function se(){KE.exit(1)}function Me(){E=AE(jE),eA=E.w,w=E.h,E=AE(ZE),Ce=E.w,ae=E.h}function fe(A,E){return E&&bA("exit.modal."+E,[N]),XA(OA,ZE,[A]),kA(A)}function ue(A){Se=A.target,E=_A(jE,A),TA=E.x,LA=E.y,Me()}function De(A){var e=le.header,T=le.sizer;Se===e||EE(Se,e)===e?(E=_A(QE,A),z=E.x-TA,$=E.y-LA,n(jE,{left:(eA>Ce?z:o(z,0,Ce-eA))+UA,top:(w>ae?$:o($,0,ae-w))+UA})):Se===T&&(E=_A(jE,A),_=AE(T),n(jE,{width:E.x+_.w/4+UA,height:E.y+_.h/4+UA}))}function He(){Se=0}function de(A,E,e){return{header:A,body:E,footer:e}}function Ue(A){g=KE.drop.target,h=qE,m=A&&A.target||0,(!m||m!==g&&EE(m,g)!==g)&&(KE.drop.target=0,KE.exit(m===zE))}var g,h,m,y,w,Q,V,k,z,J,X,E,Z,q,_,$,AA,EA,eA,TA,LA,e="⌘",T="…",I="⇥",R="⇧",O=window,t=document,N=new TE(A),i=N._,n=i.css,o=i.edge,r=i.x,S=i.extend,C=i.pattern,a=i.timer.reset,l=i.timer.set,G=i.trim,F={},c=function(){},s=TE.is,M=s.e,f=s.a,u=s.f,D=s.i,H=s.o,d=s.r,U=function(A){return!s.x(A)},B=s.s,P=t.documentElement,K=(t.head,t.body),p=S({tab:"  ",direction:"ltr",path:TE.path,resize:1,keys:1,tools:"indent outdent | undo redo",attributes:{spellcheck:"false"},union:[[["\\u003C","\\u003E","\\u002F"],["\\u003D","\\u0022","\\u0022","\\u0020"]],[["<",">","/"],["=",'"','"'," "]]],auto_tab:1,auto_close:{'"':'"',"'":"'","(":")","{":"}","[":"]","<":">"},languages:{tools:{tools:["Focus Tools","F10"],undo:["Undo",e+"+Z"],redo:["Redo",e+"+Y"],indent:["Indent",I],outdent:["Outdent",R+"+"+I]},buttons:{okay:"OK",cancel:"Cancel",yes:"Yes",no:"No",enter:"Enter",exit:"Exit",open:"Open",close:"Close",ignore:"Ignore"},placeholders:{"":"text here"+T},labels:{},others:{}},classes:{"":"text-editor",i:"text-editor-i text-editor-i-%1 text-editor-i-%2"}},E),Y={},RA="blur",OA="click",oA="keydown",rA="keyup",SA="touchstart mousedown",CA="touchmove mousemove",aA="touchend mouseup",GA="orientationchange resize",FA=p.auto_close,cA=p.auto_tab,sA=p.languages,MA=p.tab,uA=(p.union[1][1],p.union[1][0]),DA=p.union[0][1],HA=p.union[0][0],dA="javascript:;",UA="px",KE=N.ui={};N.tidy=function(A,E){var e=N.$(),T=G(e.before)?A:"",L=G(e.after)?U(E)?E:A:"";return N.trim(T,L)},N.i=function(){return G(N.replace(/\s+/g," "))},N.format=function(A,E,e,T){H(A)||(A=[A]),U(e)||(e=" "),U(T)||(T="");var L=N.h,I=N[0]().$(),R=A[0].split(C("("+DA[3]+")+"))[0],O=(A[0]?uA[0]+A[0]+uA[1]:"")+T,t=T+(A[0]?uA[0]+uA[2]+(A[1]||R)+uA[1]:""),i=r(A[0]?uA[0]+R+uA[1]:""),n=r(t),o=C("^"+i+"([\\s\\S]*?)"+n+"$"),S=C(i+"$"),a=C("^"+n),l=I.before,G=I.after;return I.length?e=!1:N.insert(sA.placeholders[""]),N.toggle(E?!o.test(I.value):!S.test(l)&&!a.test(G),[function(A){A.unwrap(O,t,1).tidy(C(HA[0]+"[^"+HA[0]+HA[1]+HA[2]+"]+?"+HA[1]+"$").test(l)?"":e,C("^"+HA[0]+HA[2]+"[^"+HA[0]+HA[1]+"]+?"+HA[1]).test(G)?"":e).wrap(O,t,E)},function(A){A.unwrap(O,t,E)}])[L]()};var Te,pE=p.classes,YE=pE[""],gE=sA.tools,hE=sA.buttons,mE=sA.labels,bE=YE+"-textarea "+YE+"-content block",xE=WE(YE+"-sizer s"),yE=WE(YE+"-sizer se"),vE=WE(YE),wE=WE(YE+"-header"),QE=WE(YE+"-body"),VE=WE(YE+"-footer"),kE=WE(YE+"-tool"),zE=OE(A,!1,p.attributes),JE=WE(YE+"-description"),XE=OE(),ZE=OE(),jE=OE(),qE=OE(),_E=OE(),$E=OE(),Ae=WE("left","span"),Ee=WE("right","span"),ee=0;KE.i=function(A,E,e){return A=qA(A).replace(/[\/\s]/g,"-"),_=jA(pE.i,[A,E||A]),e?(IE(e),eE(e,_),e):'<i class="'+_+'"></i>'},U(p.suffix)||(p.suffix=uA[1]);var Ne="ui-drop-data",Se=0,TA=0,LA=0,eA=0,w=0,Ce=0,ae=0,le={};N.create=function(A,E){if(N.is.create)return N;N.is.create=!0,H(A)&&(p=S(p,A));var e=sE(zE);return eE(vE,YE+"-is-can-update"),eE(vE,YE+"-is-can-copy"),eE(zE,bE),e&&FE(e,"p")?(ME(e,vE),ee=e,dE(e,!1)):ME(zE,vE),vE.dir=p.direction,HE(vE,wE),HE(vE,QE),HE(vE,VE),HE(QE,zE),p.tools&&(HE(wE,kE),HE(VE,JE),HE(JE,Ae),HE(JE,Ee)),zA(oA,zE,oe),zA(rA+" "+RA,zE,re),X=YE+"-is-can-resize",p.resize?(HE(vE,xE),eE(vE,X),zA(SA,xE,Ge),zA(CA,t,Fe),zA(aA,K,ce)):IE(vE,X),ie(),ne(),0!==E?bA("create",[N]):N},N.update=function(A,E){return N.is.create&&N.destroy(0),(0!==E?bA("update",[N]):N).create(A,0)},N.destroy=function(A){return N.is.create?(N.is.create=!1,KE.exit(0,0,0),IE(zE,bE),p.tools=WA(p.tools),p.keys&&(JA(oA,zE,oe),JA(rA,zE,re)),p.resize&&(JA(SA,xE,Ge),JA(CA,t,Fe),JA(aA,t,ce)),ee?(ME(vE,ee),HE(ee,zE),ee=0):ME(vE,zE),PE(vE),0!==A?bA("destroy",[N]):N):N},N.enable=function(A){return zE.disabled=zE.readOnly=!1,eE(vE,YE+"-is-can-update"),eE(vE,YE+"-is-can-copy"),0!==A?bA("enable",[N]):N},N.disable=function(A){return zE.disabled=!0,IE(vE,YE+"-is-can-update"),IE(vE,YE+"-is-can-copy"),0!==A?bA("disable",[N]):N},N.freeze=function(A){return zE.disabled=!1,zE.readOnly=!0,IE(vE,YE+"-is-can-update"),eE(vE,YE+"-is-can-copy"),0!==A?bA("freeze",[N]):N},KE.exit=function(A,E,e){if(y={panel:function(){PE(XE)},overlay:function(){JA(OA,ZE,se),PE(ZE)},modal:function(){JA(OA+" "+oA,le.x,fe),JA(SA,QE,ue),JA(CA,QE,De),JA(aA,t,He),PE(jE)},drop:function(){JA(OA,t,Ue),JA(GA,O,Ue),PE(qE)},bubble:function(){PE(_E)}},re(),E)if(H(E))for(Q in E)Q=E[Q],y[Q]&&y[Q](),0!==e&&bA("exit."+Q,[N]);else y[E]&&y[E](),0!==e&&bA("exit."+Q,[N]);else for(Q in y)y[Q]();return A&&N.select(),0!==e&&bA("exit",[N]),N},KE.panel=function(A,E,e,T){function L(A){return JA(OA+" "+oA,TA,L),KE.panel.exit(1),kA(A)}return KE.exit(0,0,0),z=qA(A),$=0,T&&(z+=" "+z+"--"+qA(T)),H(E)&&!M(E)&&($=WE(YE+"-panel-header "+z,0,E.header),E=E.body),AA=WE(YE+"-panel-body "+z,0,WE(YE+"-panel-content "+z,0,u(E)?"":E)),u(E)&&E(AA),TA=OE("a",!1,{href:dA,"class":YE+"-a "+YE+"-x "+z}),TA.title=hE.close,OE(XE,!1,{"class":YE+"-panel "+z}),zA(OA+" "+oA,TA,L),nE(XE,0),$&&HE(XE,$),HE(QE,OE(XE,[AA,TA])),u(e)?e(XE):B(e)&&OE(XE,e),g=[N,XE],T&&bA("enter.panel."+A+":"+T,g),bA("enter.panel."+A,g),bA("enter.panel",g),bA("enter",g),TA.focus(),N},KE.panel.fit=function(){},KE.overlay=function(A,E,e,T){return KE.exit(0,0,0),z=qA(A),T&&(z+=" "+z+"--"+qA(T)),HE(QE,OE(ZE,!1,{"class":YE+"-overlay "+z})),E&&zA(OA,ZE,se),u(e)?e(ZE):B(e)&&OE(ZE,e),g=[N,ZE],T&&bA("enter.overlay."+A+":"+T,g),bA("enter.overlay."+A,g),bA("enter.overlay",g),bA("enter",g),N},KE.overlay.fit=function(){},KE.message=function(A,E,e,T,L){function R(A){return JA(OA+" "+oA,TA,R),a(I),KE.overlay.exit(1),kA(A)}var I;return z=qA(A),L&&(z+=" "+z+"--"+qA(L)),TA=OE("a",!1,{href:dA,"class":YE+"-a "+YE+"-x "+z}),TA.title=hE.close,OE($E,u(E)?E($E):E,{"class":YE+"-message "+z}),zA(OA+" "+oA,TA,R),KE.overlay("message message-"+z,0,function(A){HE($E,TA),e&&(I=l(function(){R()},e)),HE(A,$E)},L),u(T)?T($E):B(T)&&OE($E,T),N},KE.modal=function(){var O,i,A=arguments,E=A[0],e=A[1],T=A[2],L=A[3],I=YE+"-modal",R=e.footer;if(H(E)&&(E="default",e=A[0],T=A[1],L=A[2]),KE.overlay(E,1,0,L).blur(),z=qA(E),L&&(z+=" "+z+"--"+qA(L)),OE(jE,!1,{"class":I+" "+z}),U(e.body)&&(e.body=OE("div",e.body,{"class":I+"-content "+z})),U(R)&&H(R)&&!M(R)){i=[];for(Q in R)V=R[Q],M(V)?i.push(V):(V=Re(V,Q,R),k=Q.text||hE[Q]||Q,O=OE("button",k,S({name:"y["+Q+"]",type:"button","class":YE+"-button",data:{"button-id":Q}},V.attributes)),zA(OA,O,function(A){return k=R[QA(this,"button-id")].click(A,N),k===!1?kA(A):void 0}),i.push(O));e.footer=i}for(Q in e)I[1]=Q,le[Q]=WE(I+"-"+jA(Q,I)+" "+z,0,e[Q]);return le.x=OE("a",!1,{href:dA,"class":YE+"-a "+YE+"-x "+z}),le.sizer=yE,nE(jE,0),le.x.title=hE.close,HE(QE,OE(jE,le,{style:""})),KE.modal.fit(),fE(jE,ZE),zA(OA+" "+oA,le.x,fe),zA(SA,le.header,kA),zA(SA,le.sizer,kA),zA(SA,QE,ue),zA(CA,QE,De),zA(aA,t,He),u(T)&&T(le),g=[N,jE,le],L&&bA("enter.modal."+E+":"+L,g),bA("enter.modal."+E,g),bA("enter.modal",g),bA("enter",g),le.x.focus(),N},KE.modal.fit=function(A){return Me(),z=Ce/2-eA/2,$=ae/2-w/2,H(A)?(U(A[0])&&(z=A[0]),U(A[1])&&($=A[1])):(z=o(z,0),$=o($,0)),n(jE,{left:z+UA,top:$+UA,"min-width":eA+UA,"min-height":w+UA,visibility:"visible"}),g=[N,jE,le],bA("fit.modal",g),bA("fit",g),N};var Be={"class":YE+"-button",name:"y"};return KE.alert=function(A,E,e,T,L){var I=OE("button",hE.okay,Be),R="alert";return e=e||c,H(A)&&(R+=":"+A[0],A=A[1]||A[0]),zA(OA,I,function(A){return e(A,N),fe(A,R+".y")}),zA(oA,I,function(A){var E=A.TE.key;return E(["enter","escape"])&&XA(OA,I,[A]),kA(A)}),KE.modal(R,de(A,E,I),T,L),I.focus(),N},KE.confirm=function(A,E,e,T,L,I){function n(A){return u(e)&&e(A,N),fe(A,t+".y")}function o(A){return u(T)&&T(A,N),fe(A,t+".n")}var i,R=OE("button",hE.okay,Be),O=OE("button",hE.cancel,Be),t="confirm";return O.name="n",zA(OA,R,n),zA(OA,O,o),zA(oA,R,function(A){return i=A.TE.key,i("right")?O.focus():i("enter")?n(A):i("escape")&&fe(A,t+".y"),kA(A)}),zA(oA,O,function(A){return i=A.TE.key,i("left")?R.focus():i("enter")?o(A):i("escape")&&fe(A,t+".n"),kA(A)}),KE.modal(t,de(A,E,[R,O]),L,I),O.focus(),N},KE.prompt=function(A,E,e,T,L,I,R){function a(){i.focus(),"placeholder"in i&&i.select()}function l(A){return r=i.value,u(e)&&!e(r)?a():!e||G(r)&&r!==E?(fe(A,n+".y"),T(A,N,r!==E?r:"",E)):a(),kA(A)}function F(A){return fe(A,n+".n")}var r,S,C,O=OE("button",hE.okay,Be),t=OE("button",hE.cancel,Be),i=OE("input",!1,{type:"text",value:E,placeholder:E,spellcheck:"false","class":YE+"-input block"}),n="prompt",o=[];if(L=L||0,1===L)i=OE("textarea",E,{placeholder:E.split("\n")[0],"class":YE+"-textarea block",spellcheck:"false"});else if(2===L){for(Q in E)o.push(OE("option",E[Q],{value:Q,selected:Q===e||null}));i=OE("select",o,{"class":YE+"-select block"})}return T=T||c,i.name="data",t.name="n",zA(oA,i,function(A){return S=A.TE.key,C=A.TE.control,S("enter")&&0===L||C("enter")?l(A):S("escape")||S("back")&&!this.value?F(A):S("down")&&0===L||S("enter")&&2===L||C("down")?(O.focus(),kA(A)):void 0}),zA(oA,O,function(A){return S=A.TE.key,S("enter")?l(A):S("escape")?F(A):S("up")?i.focus():S("right")&&t.focus(),kA(A)}),zA(oA,t,function(A){return S=A.TE.key,S(["enter","escape"])?F(A):S("up")?i.focus():S("left")&&O.focus(),kA(A)}),zA(OA,O,l),zA(OA,t,F),KE.modal(n,de(A,i,[O,t]),I,R),a(),N},KE.drop=function(){KE.exit(0,0,0);var A=arguments,E=A[0],e=A[1],T=A[2];return 1===YA(A)&&(E="default",e=A[0],T=A[1]),z=qA(E),nE(qE,0),HE(K,OE(qE,!1,{"class":YE+"-drop "+z})),u(e)?e(qE):OE(qE,e),KE.drop.fit(),T===!1||(zA(OA,t,Ue),zA(GA,O,Ue)),g=[N,qE],bA("enter.drop."+E,g),bA("enter.drop",g),N},KE.drop.fit=function(A){return g=AE(P),h=AE(qE),m=KE.drop.target,z=g.w/2-h.w/2,$=g.h/2-h.h/2,!U(A)&&m&&(E=$A(m),z=E.l,$=E.t+AE(m).h),H(A)?(U(A[0])&&(z=A[0]),U(A[1])&&($=A[1])):(z=o(z,0,g.w-h.w),$=o($,0,Math.max(g.h,AE(O).h)-h.h)),n(qE,{left:z+UA,top:$+UA,visibility:"visible"}),g=[N,qE],bA("fit.drop",g),bA("fit",g),N},KE.menu=function(A,e,T,L){var O,I=KE.tools,R=0;if(e===!1)return KE.tool(A,e);for(L in T)eA="%"===L[0],O=T[L],O=B(O)&&!eA?I[O]:O,O&&(O=Re(O,L,I),T[L]=O);return KE.tool(A,{i:H(e)?e[0]:0,text:H(e)?e[1]||0:e&&T[e]&&T[e].text||e,click:function(t){var i=KE.drop.target=I[A].target;return KE.drop("menu menu-"+qA(A),function(t){function n(R){return $=this,E=QA($,"tool-id"),J=T[E],J=B(J)?I[J]:J||{},X=iE($),!Ie(J)&&u(L=J.click)&&(L=L(R,N),J.i&&(I[A].i=J.i),KE.menu.set(A,H(J.text)?[J.text[0],E]:H(e)?[e[0],E]:E),L===!1)?(N.select(),kA(R)):(N.select(),kA(R))}function o(A){if($=this,(k=A.TE.key)("escape"))KE.exit(1);else if(k("enter"))XA(OA,$,[A]);else if(k("f10")&&i)i.focus();else if(k("down")&&(z=aE($))){for(;!FE(z,"a")&&z;)z=aE(z);z&&z.focus()}else if(k("up")&&(z=lE($))){for(;!FE(z,"a")&&z;)z=lE(z);!z&&i?(KE.exit(),i.focus()):z&&z.focus()}else k("up")&&i&&(KE.exit(),i.focus());return kA(A)}for(L in T)if(O=T[L],eA="%"===L[0],O){var r={href:eA?null:dA,"class":YE+"-"+(eA?"label":"button")};eA?V=mE[A]&&mE[A][+L.slice(1)-1]||L:(r.data={},r.data["tool-id"]=L,V=gE[L]||L),q=O.text,q=H(q)?q[1]||"":q,V=H(V)?V[0]:V,_=OE(eA?"span":"a","<span>"+(eA?V||"%"+R:q||V)+"</span>",S(r,O.attributes||{})),eE(_,"menu-"+qA(L).replace(/[\/\s]/g,"-")),!r.title&&($=O.title)&&(_.title=H($)?$[0]+($[1]?" ("+$[1]+")":""):$),eA?xA(_,{id:YE+"-label:"+R}):(Ie(O)?eE(_,"x"):IE(_,"x"),O.on?eE(_,"on"):IE(_,"on"),zA(OA,_,n),zA(oA,_,o)),HE(t,_),++R}l(function(){(cE('[data-tool-id="'+QA(i,Ne)+'"]',t)[0]||cE("a",t)[0]).focus()},1)}),!1}},L),wA(I[A].target,{"ui-drop":A}),I[A].data=T,KE.menu.set(A,e)},KE.menu.set=function(A,E){var I,R,e=KE.tools[A]||{},T=e.target,L=e.data;return T?(H(E)?wA(T,Ne,E[1]||""):(wA(T,Ne,E),E=L[E]&&L[E].text||E),H(E)?(R=E[0],R=KA(R,"<")?R:KE.i(R,e.i),E=U(E[1])?E[1]:0,E=E&&L[E]&&L[E].text||E,E=R+(0!==E?"<span>"+(H(E)?E[1]||E:E)+"</span>":"")):R=KE.i(A,e.i),(I=cE("."+YE+"-text",T)[0])?(eE(T,"text"),NE(I,E)):(IE(T,"text"),NE(T,R)),N):N},KE.bubble=function(){KE.exit(0,0,0);var A=arguments,E=A[0],e=A[1];return 1===YA(A)&&(E="default",e=A[0]),z=qA(E),nE(_E,0),HE(K,OE(_E,!1,{"class":YE+"-bubble "+z})),u(e)?e(_E):OE(_E,e),KE.bubble.fit(),g=[N,_E],bA("enter.bubble."+E,g),bA("enter.bubble",g),N},KE.bubble.fit=function(A){_=N.$(1),E=$A(zE),w=n(zE,"line-height");var e="border-",T="-width";z=_.caret[0].x+E.l-zE.scrollLeft,$=_.caret[1].y+E.t+w-zE.scrollTop,h=n(QE,[e+"top"+T,e+"bottom"+T,e+"left"+T,e+"right"+T]);var L=AE(QE),I=AE(_E),R=h[0]+h[1],O=h[2]+h[3];return H(A)?(U(A[0])&&(z=A[0]),U(A[1])&&($=A[1])):(z=o(z,E.l,E.l+L.w-I.w-O),$=o($,E.t,E.t+L.h-I.h-R)),n(_E,{left:z+UA,top:$+UA,visibility:"visible"}),g=[N,_E],bA("fit.bubble",g),bA("fit",g),N},KE.panel.exit=function(A){return KE.exit(A,"panel")},KE.overlay.exit=function(A){return KE.exit(A,"overlay")},KE.modal.exit=function(A){return KE.exit(A,"modal")},KE.drop.exit=function(A){return KE.exit(A,"drop")},KE.bubble.exit=function(A){return KE.exit(A,"bubble")},KE.tool=function(A,E,e){var T=KE.tools;return V="",k=U(T[A])?"update":"create","|"!==A&&(p.tools=PA(p.tools||"").filter(function(E,e){return E===A?(V=e,!1):!0})),E===!1?(delete T[A],k="destroy"):("|"===A?(e=E,E={}):(u(E)&&(E={click:E}),T[A]=S(T[A]||{},E),U(e)||""===V||(e=V)),D(e)?p.tools.splice(e,0,A):p.tools.push(A)),bA(k+".tool."+A,[N,T[A]]),ie(),N},KE.separator=function(A,E){return KE.tool("|",A!==!1?{attributes:A||{}}:!1,E)},KE.key=function(A,E){var e=KE.keys;return k=U(e[A])?"update":"create",E===!1?(delete e[A],k="destroy"):e[A]=E,bA(k+".key."+A,[N,e[A]]),ne(),N},KE.key.set=function(A){Y[A]=1},KE.key.reset=function(A){A?delete Y[A]:Y={}},KE.tools={"|":{},undo:{click:function(A,E){return E.undo(),!1}},redo:{click:function(A,E){return E.redo(),!1}},indent:function(A,E){return E.indent(MA),!1},outdent:function(A,E){return E.outdent(MA),!1}},KE.keys={"control+y":"redo","control+z":"undo",escape:function(A,E){return q=":not([tabindex]):not([disabled])",(_=cE("input"+q+",button"+q+",select"+q+",textarea"+q+",a[href]"+q+",[contenteditable]"+q+',[tabindex]:not([tabindex="-1"])',t,0))&&-1!==($=_.indexOf(zE))?((_[$+1]||t).focus(),!1):void 0},f10:function(A,E){return cE("a",kE)[0].focus(),!1},tab:cA?"indent":0,"shift+tab":cA?"outdent":0},KE.el={container:vE,header:wE,body:QE,footer:VE,panel:XE,overlay:ZE,modal:jE,drop:qE,bubble:_E},N.config=p,S(TE._,{time:function(A){var E=new Date(U(A)?A:Date.now()),e=E.getFullYear(),T=E.getMonth()+1,L=E.getDate(),I=E.getHours(),R=E.getMinutes(),O=E.getSeconds(),t=E.getMilliseconds();return 10>T&&(T="0"+T),10>L&&(L="0"+L),10>I&&(I="0"+I),10>R&&(R="0"+R),10>O&&(O="0"+O),10>t&&(t="0"+t),[""+e,""+T,""+L,""+I,""+R,""+O,""+t]},replace:ZA,format:jA,dom:{set:HE,reset:dE,get:cE,id:tE,copy:UE,replace:BE,classes:{set:eE,reset:IE,toggle:RE,get:LE},attributes:{set:xA,reset:vA,get:yA},data:{set:wA,reset:VA,get:QA},is:FE,offset:$A,pointer:_A,size:AE,content:{set:NE,reset:nE,get:iE},closest:EE,parent:rE,children:SE,closest:CE,next:aE,previous:lE,index:GE,before:ME,after:fE,prepend:uE,append:DE},el:OE,events:{set:zA,reset:JA,fire:XA,x:kA}}),S(N._,TE._),S(N._,{hooks:{set:hA,reset:mA,fire:bA}}),N.create()};