/*!
 * ==========================================================
 *  USER INTERFACE MODULE FOR TEXT EDITOR PLUGIN 1.4.9
 * ==========================================================
 * Author: Taufik Nurrohman <https://github.com/tovic>
 * License: MIT
 * ----------------------------------------------------------
 */
TE.prototype.ui=function(e){function ge(e){return F(e)?R(e).split(/\s+/):e}function me(e){return S(e)?e.join(" "):e}function He(e,t,n){return C(e)?C(t)?(C(H[e])||(H[e]={}),C(n)||(n=Object.keys(H[e]).length),H[e][n]=t,a):H[e]:H}function De(e,t){return C(e)?C(t)&&C(H[e])?(delete H[e][t],a):(H[e]={},a):(H={},a)}function ve(e,t,n){if(!C(H[e]))return H[e]={},a;if(C(n))C(H[e][n])&&H[e][n].apply(a,t);else for(K in H[e])H[e][K].apply(a,t);return a}function Me(e,t,n){if(S(t))for(K in t)Me(e,K,t[K]);else e.setAttribute(t,n)}function Ue(t,n,r){if(F(n))return Ue(t,[n],C(r)?r:"")[0];e=[];for(K in n)K=n[K],(K=t.getAttribute(K))&&e.push(K);return e.length?e:C(r)?r:[]}function Be(e,t){if(S(t))for(K in t)Be(e,t[K]);else if(C(t))e.removeAttribute(t);else for(Be(e,"class"),K=0,$=e.attributes,x=$.length;x>K;++K)$[K]&&Be(e,$[K].name)}function Pe(e,t,n){if(S(t))for(K in t)Pe(e,K,t[K]);else Me(e,"data-"+t,n)}function ye(t,n,r){if(F(n))return ye(t,[n],C(r)?r:"")[0];e=[];for(K in n)K=n[K],(K=Ue(t,"data-"+K))&&e.push(K);return e.length?e:C(r)?r:[]}function ke(e,t){if(S(t))for(K in t)Be(e,"data-"+t[K]);else if(C(t))Be(e,"data-"+t);else for(K=0,$=e.attributes,x=$.length;x>K;++K)$[K]&&"data-"===$[K].name.slice(0,5)&&Be(e,$[K].name)}function We(e){return e&&e.preventDefault(),!1}function we(e,t,n){if(t){for(e=ge(e),K=0,$=e.length;$>K;++K)t.addEventListener(e[K],n,!1),He("on:"+e[K],n,et(t));return a}}function Ke(e,t,n){if(t){for(e=ge(e),K=0,$=e.length;$>K;++K)t.removeEventListener(e[K],n,!1),De("on:"+e[K],et(t));return T(t)&&t.id.split(":")[0]===St+"-dom"&&Be(t,"id"),a}}function $e(e,t,n){e=ge(e);var i,r="createEvent"in f;for(K=0,$=e.length;$>K;++K)r?(i=f.createEvent("HTMLEvents"),i.data=n,i.initEvent(e[K],!0,!1),t.dispatchEvent(i)):ve("on:"+e[K],n,et(t));return a}function xe(e,t,n){for(K=0,$=t.length,x;$>K;++K)x=t[K],e=e.replace(h(x)?x:O(u(x),"g"),n&&n[K]||"");return e}function Ye(e,t){return e.replace(/%(\d+)/g,function(e,n){return--n,C(t[n])?t[n]:e})}function _e(e){return R(xe(e,[/[^ \/a-z\d-]/g,/([ -])+/g,/^-|-$/g],["-","$1",""]))}function Ve(e,t){var n=t.touches?t.touches[0].pageX:t.pageX,r=t.touches?t.touches[0].pageY:t.pageY,i=Qe(e);return{x:n-i.l,y:r-i.t}}function Qe(e){for(Y=e.offsetLeft,X=e.offsetTop;e=e.offsetParent;)Y+=e.offsetLeft,X+=e.offsetTop;return{l:Y,t:X}}function qe(e){return{w:e.offsetWidth,h:e.offsetHeight}}function je(e,t){for(;(e=it(e))&&e!==t;);return e}function ze(e,t){t=ge(t);for(K in t)e.classList.add(t[K])}function Xe(t,n,r){if(F(n))return Xe(t,[n],C(r)?r:"")[0];e=[];for(K in n)K=n[K],t.classList.contains(K)&&e.push(K);return e.length?e:C(r)?r:!1}function Je(e,t){if(C(t)){t=ge(t);for(K in t)e.classList.remove(t[K])}else Be(e,"class")}function Ze(e,t,n){if(e=F(e)?f.createElement(e):e,S(n))for(K in n)if(Z=n[K],"classes"===K)ze(e,Z);else if("data"===K)for($ in Z)Z=Z[$],null===Z?ke(e,$):Pe(e,$,Z);else"css"===K?F(Z)?Me(e,"style",Z):null===Z?Be(e,"style"):A(e,Z):d(Z)?e[K]=Z:null===Z?Be(e,K):Me(e,K,S(Z)?Z.join(" "):""+Z);if(T(t))Rt(e,t);else if(S(t))for(K in t)Z=t[K],T(Z)?Rt(e,Z):Z!==!1&&tt(e,Z);else C(t)&&t!==!1&&tt(e,t);return e}function et(e){var t=e.id;return t||(t=St+"-dom:"+Date.now(),e.id=t),t}function tt(e,t){e.innerHTML=t}function nt(e,t){return e.innerHTML||(C(t)?t:"")}function rt(e,t){if(t!==!1&&(B=ot(e)))for(K=0,$=B.length;$>K;++K)rt(B[K]);tt(e,"")}function it(e){return e&&e.parentNode}function ot(e){return e&&e.children||[]}function lt(e){return e&&e.nextSibling}function ft(e){return e&&e.previousSibling}function at(e,t){return e&&F(t)?e.nodeName.toLowerCase()===t.toLowerCase():e&&d(t)?e===t(e):e===t}function st(t,n){if(!(n=C(n)?n:f))return[];if(e=[],F(t)){if(/^([#.]?[\w-]+|\*)$/.test(t)){if("#"===t[0]&&(t=n.getElementById(t.slice(1))))return[t];if("."===t[0]&&(t=n.getElementsByClassName(t.slice(1)))||(t=n.getElementsByTagName(t))){for(K=0,$=t.length;$>K;++K)e.push(t[K]);return e}return[]}for(t=n.querySelectorAll(t),K=0,$=t.length;$>K;++K)e.push(t[K]);return e}return ut(t)?[t]:[]}function ut(e,t){var n=it(e);return 1===arguments.length?n||!1:e&&n===e?n:!1}function ct(e,t){Q=it(e),Q&&Q.insertBefore(t,e)}function At(e,t){Q=it(e),Q&&Q.insertBefore(t,lt(e))}function Et(e,t){B=ot(e)[0],B?ct(B,t):Rt(e,t)}function Ot(e,t){Rt(e,t)}function Rt(e,t){e.appendChild(t)}function It(e,t){var n=ut(e);if(n){if(t!==!1)for(B=ot(e)[0];B;)It(B);n.removeChild(e)}}function Lt(e){rt(Ze(e,!1,{style:""})),It(e)}function Nt(e,t,n){return Ze(t||"div",n,{"class":e})}function Vt(e){return!e||C(e.active)&&!z.active}function Qt(){bt._word&&bt._words&&(Z=(Mt.value||"").replace(O(he[0]+"[^"+he[0]+he[1]+"]+?"+he[1],"g"),""),K=(Z.match(/(\w+)/g)||[]).length,tt(Kt,Ye(bt["_word"+(1===K?"":"s")],[K])))}function qt(e,t,n){return d(e)&&(e={click:e}),F(e.click)&&(e.click=(n[e.click]||{}).click),C(e.title)||(e.title=ht[t]||""),n[t]=e,e}function jt(e){Tt.exit(0,0,0);var t=ye(this,Ce),n=Tt.tools,r=n[t];return Tt.drop.target=e.currentTarget||e.target,!Vt(r)&&d($=r.click)&&($=$(e,a,t),ve("on:change",[e,a,t]),$===!1)?We(e):(a.select(),We(e))}function zt(e){if(X=this,(x=e.TE.key)(/^(escape|f10)$/))Tt.exit(1);else if(x("enter"))Tt.drop.target=X,$e(Ae,X,[e]);else if(x("arrowright")&&(Y=lt(X))){for(;!at(Y,"a")&&Y;)Y=lt(Y);Y&&Y.focus()}else if(x("arrowleft")&&(Y=ft(X))){for(;!at(Y,"a")&&Y;)Y=ft(Y);Y&&Y.focus()}return We(e)}function Xt(){rt(vt,!1);var r,i,o,l,f,s,u,e=ge(v.tools),t=St+"-button",n=St+"-separator";v.tools=e;for(s in e)u=e[s],i=Tt.tools[u],(i||i==={})&&(i=qt(i,u,Tt.tools),o=i.i||u,"|"!==o&&"<"!==o[0]&&(o=_e(o)),l="|"!==o,f=_e(o).replace(/\s/g,""),Yt=Nt(l?t+" "+t+"-"+f:n+" "+n+"-"+s,l?"a":"span"),l?(r=t+":"+f,Me(Yt,{href:be,id:r,tabindex:-1}),Pe(Yt,Ce,u),o="<"===o[0]?o:'<i class="'+Ye(pt,[o])+'"></i>',Vt(i)&&ze(Yt,"x"),i.text&&(o=Ye('<span class="'+St+'-text">'+i.text+"</span>",[o]),ze(Yt,"text")),tt(Yt,o),Ze(Yt,!1,i.attributes||{}),!Yt.title&&($=i.title)&&(Yt.title=S($)?$[0]+($[1]?" ("+$[1]+")":""):$),we(Ae,Yt,jt),we(ie,Yt,zt)):Yt.id=n+":"+s,Tt.tools[u].target=Yt,Rt(vt,Yt));ve("update.tools",[a])}function Jt(){Tt.keys=function(){var n,e=Object.keys(Tt.keys).sort().reverse(),t={};for(K=0,$=e.length;$>K;++K)n=e[K],t[n]=Tt.keys[n];return t}(),rn(1),ve("update.keys",[a])}function Zt(e){Qt(),ve("on:change",[e,a])}function nn(t){function E(e){return e.replace(/\+/g,"\n").replace(/\n\n/g,"\n+").split("\n")}var n=a.$(),r=n.before,i=n.after,o=r.slice(-1),l=i[0],f=n.length,s=Tt.keys,c=TE.keys_alias,A=(r.match(/(?:^|\n)([\t ]*).*$/)||[""]).pop();V=t.TE.key(),en[V]=1,e=Object.keys(en).length,I(function(){a.record()},1);for(K in s){x=E(K),B=0;for($ in x)$=x[$],en[c[$]||$]&&++B;if(x=x.length,B===x&&e===x&&(F(s[K])&&(s[K]=Tt.tools[s[K]].click),Y=s[K]&&s[K](t,a),Y===!1))return We(t)}if(de)for(K in de)if(_=de[K],_!==!1){if(V===_&&l===_)return"\\"===o?(a.insert(V,0),We(t)):(a.select(n.end+1),We(t));if(K===V)return a.wrap(K,_),We(t);if(o===K&&l===_){if("backspace"===V&&r.slice(-2)!=="\\"+K)return a.unwrap(K,_),We(t);if(Te&&"enter"===V&&K!==_)return a.tidy("\n"+A+Ne,"\n"+A),We(t)}}if(Te&&!f){if("backspace"===V&&O(u(Ne)+"$").test(r))return a.outdent(Ne),We(t);if("enter"===V&&O("(^|\\n)("+u(Ne)+")+.*$").test(r))return a.insert("\n"+A,0,1),We(t)}}function rn(e){S(e)?delete en[e.TE.key()]:en={}}function on(e){/^(focus|blur)$/.test(e.type)&&rn(1),L(tn),tn=I(function(){Zt(e)},v.debounce||0)}function un(e){return ln=Ut,z=qe(Dt),We(e)}function cn(e){ln===Ut&&A(Mt,{height:Ve(Ht,e).y-z.h+Ge})}function An(){ln=0}function En(){Tt.exit(1)}function On(){e=qe(yt),ee=e.w,w=e.h,e=qe(Pt),fn=e.w,an=e.h}function Rn(e,t){t&&ve("exit.modal."+t,[a]),$e(Ae,Pt,[e])}function In(t){ln=t.target,e=Ve(yt,t),te=e.x,ne=e.y,On()}function Ln(t){var n=sn.header,r=sn.resize;ln===n||je(ln,n)===n?(e=Ve(Ht,t),Y=e.x-te,X=e.y-ne,A(yt,{left:(ee>fn?Y:E(Y,0,fn-ee))+Ge,top:(w>an?X:E(X,0,an-w))+Ge})):ln===r&&(e=Ve(yt,t),z=qe(r),A(yt,{width:e.x+z.w/4+Ge,height:e.y+z.h/4+Ge}))}function Nn(){ln=0}function Tn(e,t,n){return{header:e,body:t,footer:n}}function dn(e){M=Tt.drop.target,U=kt,B=e&&e.target||0,(!B||B!==M&&je(B,M)!==M)&&(Tt.drop.target=0,Lt(kt),Ke(Ae,f,dn),Ke(Re,l,dn),Tt.exit(e.target===m))}function Sn(t){function i(){e&&(Q=qe(e),A(j,{width:Q.w+Ge,height:Q.h+Ge}))}var n=a.get(),r="";return-1===n.indexOf("</html>")&&(r='<!DOCTYPE html><html dir="'+v.dir+'"><head><meta charset="utf-8"><style>'+v.css+"</style></head><body>"+n+"</body></html>"),j=Ze("iframe",!1,{"class":St+"-portal",src:"data:text/html,"+encodeURIComponent(r)}),!ut(Pt)&&n?Tt.overlay(j,1,function(){e=ot(Pt)[0],i(),we(Re,l,i),ve("enter.overlay.preview",[t,a,[n,r],e])}):(Ke(Re,l,i),En()),We(t)}var M,U,B,y,k,w,K,$,x,Y,_,V,e,Q,j,z,X,Z,ee,te,ne,t="⌘",n="…",i="⇥",o="⇧",l=window,f=document,a=this,s=a._,u=s.x,c=s.extend,A=s.css,E=s.edge,O=s.pattern,R=s.trim,I=s.timer.set,L=s.timer.reset,N=a.is,T=N.e,d=N.f,p=N.i,S=N.o,h=N.r,F=N.s,C=function(e){return!N.x(e)},b=f.documentElement,g=(f.head,f.body),m=a.target,H={},D=function(){},v=c({tab:"  ",dir:"ltr",keys:1,tools:"indent outdent | undo redo",attributes:{spellcheck:"false"},css:"html,body{background:#fff;color:#000}",unit:[[["<",">","/"],["=",'"','"'," "]],[["\\u003C","\\u003E","\\u002F"],["\\u003D","\\u0022","\\u0022","\\u0020"]]],suffix:0,auto_tab:1,auto_close:{'"':'"',"'":"'","(":")","{":"}","[":"]","<":">"},languages:{tools:{undo:["Undo",t+"+Z"],redo:["Redo",t+"+Y"],indent:["Indent",i],outdent:["Outdent",o+"+"+i],preview:["Preview","F5"]},buttons:{okay:"OK",cancel:"Cancel",yes:"Yes",no:"No",enter:"Enter",exit:"Exit",open:"Open",close:"Close",ignore:"Ignore"},placeholders:{"":"text here"+n},labels:{},others:{preview:"Preview",_word:"%1 Word",_words:"%1 Words"}},classes:{"":"text-editor",i:"icon icon-%1 fa fa-%1"},debounce:500},e),ie="keydown",oe="keyup",le="copy",fe="cut",ae="paste",se="touchstart mousedown",ue="touchend mouseup",ce="touchmove mousemove",Ae="click",Ee="focus",Oe="blur",Re="orientationchange resize",Ie=Oe+" "+le+" "+fe+" "+Ee+" input "+ie+" "+ae,Le=v.languages,Ne=v.tab,Te=v.auto_tab,de=v.auto_close,pe=v.unit[0][0],he=(v.unit[0][1],v.unit[1][0]),Fe=v.unit[1][1],Ce="tool-id",be="javascript:;",Ge="px",Tt=a.ui={};a.tidy=function(e,t){var n=a.$(),r=R(n.before)?e:"",i=R(n.after)?C(t)?t:e:"";return a.trim(r,i)},a.i=function(){return R(a.replace(/\s+/g," "))},a.format=function(e,t,n,r){S(e)||(e=[e]),C(n)||(n=" "),C(r)||(r="");var i=a.h,o=a[0]().$(),l=(e[0]?pe[0]+e[0]+pe[1]:"")+r,f=r+(e[0]?pe[0]+pe[2]+(e[1]||e[0].split(O("("+Fe[3]+")+"))[0])+pe[1]:""),s=u(l),c=u(f),A=O("^"+s+"([\\s\\S]*?)"+c+"$"),E=O(s+"$"),R=O("^"+c),I=o.before,L=o.after;return o.length?n=!1:a.insert(Le.placeholders[""]),a.toggle(t?!A.test(o.value):!E.test(I)&&!R.test(L),[function(e){e.unwrap(l,f,1).tidy(O(he[0]+"[^"+he[0]+he[1]+he[2]+"]+?"+he[1]+"$").test(I)?"":n,O("^"+he[0]+he[2]+"[^"+he[0]+he[1]+"]+?"+he[1]).test(L)?"":n).wrap(l,f,t)},function(e){e.unwrap(l,f,t)}])[i]()};var Yt,dt=v.classes,pt=dt.i,St=dt[""],ht=Le.tools,Ft=Le.buttons,Ct=Le.labels,bt=Le.others,Gt=St+"-textarea "+St+"-content block",gt=Nt(St),mt=Nt(St+"-header"),Ht=Nt(St+"-body"),Dt=Nt(St+"-footer"),vt=Nt(St+"-tool"),Mt=Ze(m,!1,v.attributes),Ut=Nt(St+"-resize s"),Bt=Nt(St+"-description"),Pt=Nt(St+"-overlay"),yt=Ze("div"),kt=Ze("div"),Wt=Ze("div"),wt=Nt("left","span"),Kt=Nt("right","span"),$t=Nt(St+"-preview","a"),xt=0;v.suffix||(v.suffix=pe[1]);var en={},tn=null;a.create=function(e,t){S(e)&&(v=c(v,e));var n=ut(Mt);return ze(Mt,Gt),n&&at(n,"p")?(ct(n,gt),xt=n,It(n,!1)):ct(Mt,gt),gt.dir=v.dir,Rt(gt,mt),Rt(gt,Ht),Rt(gt,Dt),Rt(gt,Ut),Rt(Ht,Mt),v.tools&&(Rt(mt,vt),Rt(Dt,Bt),Rt(Bt,wt),Rt(Bt,Kt)),we(ie,Mt,nn),we(oe,Mt,rn),we(Ie,Mt,on),we(se,Ut,un),we(ce,f,cn),we(ue,g,An),bt.preview&&(z=ht.preview,Me($t,{href:be,title:S(z)?z[0]+(z[1]?" ("+z[1]+")":""):z}),Rt(wt,$t),tt($t,bt.preview)),Zt(null),Xt(),Jt(),0!==t?ve("create",[a]):a},a.update=function(e,t){return Xe(Mt,ge(Gt),0)&&a.destroy(0),(0!==t?ve("update",[a]):a).create(e,0)},a.destroy=function(e){return Xe(Mt,ge(Gt),0)?(Tt.exit(0,0,0),Je(Mt,Gt),v.tools=me(v.tools),v.keys&&(Ke(ie,Mt,nn),Ke(oe,Mt,rn)),Ke(se,Ut,un),Ke(ce,f,cn),Ke(ue,f,An),Ke(Ie,Mt,on),xt?(ct(gt,xt),Rt(xt,Mt),xt=0):ct(gt,Mt),Lt(gt),0!==e?ve("destroy",[a]):a):a};var ln=0,te=0,ne=0,ee=0,w=0,fn=0,an=0,sn={};Tt.exit=function(e,t,n){if(k={overlay:function(){Ke(Ae,Pt,En),Lt(Pt)},modal:function(){Ke(se,Ht,In),Ke(ce,Ht,Ln),Ke(ue,f,Nn),Ke(Ae,sn.x,Rn),Lt(yt)},drop:function(){Lt(kt)},bubble:function(){Lt(Wt)}},t)if(S(t))for(K in t)K=t[K],k[K]&&k[K](),0!==n&&ve("exit."+K,[a]);else k[t]&&k[t](),0!==n&&ve("exit."+K,[a]);else for(K in k)k[K]();return e&&a.select(),0!==n&&ve("exit",[a]),a},Tt.overlay=function(e,t,n){return Tt.exit(0,0,0),rn(1),Rt(Ht,Ze(Pt,e.length||T(e)?Nt(St+"-overlay-content","div",e):"")),t&&we(Ae,Pt,En),d(n)?n(Pt):Ze(Pt,n),ve("enter.overlay",[a]),ve("enter",[a]),a},Tt.overlay.fit=function(){},Tt.modal=function(){Tt.overlay("",1).blur();var e=arguments,t=e[0],n=e[1],r=e[2],i=St+"-modal";S(t)&&(t="default",n=e[0],r=e[1]),Y=_e(t),Ze(yt,!1,{"class":i+" "+Y}),C(n.body)&&(n.body=Ze("div",n.body,{"class":i+"-content "+Y}));for(K in n)i[1]=K,sn[K]=Nt(i+"-"+Ye(K,i)+" "+Y,0,n[K]);return sn.x=Nt(St+"-x "+Y),sn.resize=Nt(St+"-resize se "+Y),rt(yt),Rt(Ht,Ze(yt,sn,{style:""})),Tt.modal.fit(),At(yt,Pt),we(Ae,sn.x,Rn),we(se,sn.header,We),we(se,sn.resize,We),we(se,Ht,In),we(ce,Ht,Ln),we(ue,f,Nn),d(r)&&(sn.overlay=Pt,sn.modal=yt,r(sn)),ve("enter.modal."+t,[a]),ve("enter.modal",[a]),ve("enter",[a]),a},Tt.modal.fit=function(e){return On(),Y=fn/2-ee/2,X=an/2-w/2,S(e)?(C(e[0])&&(Y=e[0]),C(e[1])&&(X=e[1])):(Y=E(Y,0),X=E(X,0)),A(yt,{left:Y+Ge,top:X+Ge,"min-width":ee+Ge,"min-height":w+Ge,visibility:"visible"}),ve("fit.modal",[a]),ve("fit",[a]),a};var pn={"class":St+"-button",name:"y"};return Tt.alert=function(e,t,n,r){var i=Ze("button",Ft.okay,pn),o="alert";return n=n||D,S(e)&&(o+=":"+e[0],e=e[1]||e[0]),we(Ae,i,function(e){return n(e,a),Rn(e,o+".y"),We(e)}),we(ie,i,function(e){var t=e.TE.key;return t(/^(escape|enter)$/)?($e(Ae,i,[e]),We(e)):void 0}),Tt.modal(o,Tn(e,t,i),r),i.focus(),a},Tt.confirm=function(e,t,n,r,i){function u(e){return d(n)&&n(e,a),Rn(e,f+".y"),We(e)}function c(e){return d(r)&&r(e,a),Rn(e,f+".n"),We(e)}var s,o=Ze("button",Ft.okay,pn),l=Ze("button",Ft.cancel,pn),f="confirm";return l.name="n",S(e)&&(f+=":"+e[0],e=e[1]||e[0]),we(Ae,o,u),we(Ae,l,c),we(ie,o,function(e){return s=e.TE.key,s("arrowright")?(l.focus(),We(e)):s("arrowleft")?We(e):s("enter")?(u(e),We(e)):s("escape")?(Rn(e,f+".y"),We(e)):void 0}),we(ie,l,function(e){return s=e.TE.key,s("arrowright")?We(e):s("arrowleft")?(o.focus(),We(e)):s("enter")?(c(e),We(e)):s("escape")?(Rn(e,f+".n"),We(e)):void 0}),Tt.modal(f,Tn(e,t,[o,l]),i),l.focus(),a},Tt.prompt=function(e,t,n,r,i,o){function O(){s.focus(),"placeholder"in s&&s.select()}function I(e){return We(e)}function L(e){return A=s.value,!n||R(A)&&A!==t?(Rn(e,u+".y"),We(e),r(e,a,A!==t?A:"",t)):(O(),I(e))}function N(e){return Rn(e,u+".n"),We(e)}var A,E,l=Ze("button",Ft.okay,pn),f=Ze("button",Ft.cancel,pn),s=Ze("input",!1,{type:"text",value:t,placeholder:t,spellcheck:"false","class":St+"-input block"}),u="prompt",c=[];if(S(e)&&(u+=":"+e[0],e=e[1]||e[0]),d(i)&&(o=i,i=0),1===i)s=Ze("textarea",t,{placeholder:t.split("\n")[0],"class":St+"-textarea block"});else if(2===i){for(K in t)c.push(Ze("option",t[K],{value:K,selected:K===n||null}));s=Ze("select",c,{"class":St+"-select block"})}return r=r||D,s.name="data",f.name="n",we(ie,s,function(e){return E=e.TE.key,E("enter")?L(e):E("escape")||E("backspace")&&!this.value?N(e):E("arrowup")?I(e):E("arrowdown")?(l.focus(),We(e)):void 0}),we(ie,l,function(e){return E=e.TE.key,E("enter")?L(e):E("escape")?N(e):E("arrowup")?(s.focus(),We(e)):E("arrowright")?(f.focus(),We(e)):E(/^arrow(down|left)$/)?I(e):void 0}),we(ie,f,function(e){return E=e.TE.key,E(/^(enter|escape)$/)?N(e):E("arrowup")?(s.focus(),We(e)):E(/^arrow(right|down)$/)?I(e):E("arrowleft")?(l.focus(),We(e)):void 0}),we(Ae,l,L),we(Ae,f,N),Tt.modal(u,Tn(e,s,[l,f]),o),O(),a},Tt.drop=function(){Tt.exit(0,0,0);var e=arguments,t=e[0],n=e[1];return 1===e.length&&(t="default",n=e[0]),Y=_e(t),rt(kt),Rt(g,Ze(kt,!1,{"class":St+"-drop "+Y})),d(n)?n(kt):Ze(kt,n),Tt.drop.fit(),we(Ae,f,dn),we(Re,l,dn),ve("enter.drop."+t,[a]),ve("enter.drop",[a]),a},Tt.drop.fit=function(t){return M=qe(b),U=qe(kt),B=Tt.drop.target,Y=M.w/2-U.w/2,X=M.h/2-U.h/2,!C(t)&&B&&(e=Qe(B),Y=e.l,X=e.t+qe(B).h),S(t)?(C(t[0])&&(Y=t[0]),C(t[1])&&(X=t[1])):(Y=E(Y,0,Math.max(M.w,l.innerWidth)-U.w),X=E(X,0,Math.max(M.h,l.innerHeight)-U.h)),A(kt,{left:Y+Ge,top:X+Ge,visibility:"visible"}),ve("fit.drop",[a]),ve("fit",[a]),a},Tt.menu=function(e,t,n,r){t=!S(t)&&n[t]&&n[t].text||t;var s,i=Tt.tools,o='<span class="'+St+'-current menu">%1</span>',l="",f=0;return t===!1?Tt.tool(e,t):(S(t)&&(l=t[0],l="<"===l[0]?l:'<i class="'+Ye(pt,[l])+'"></i>',t=C(t[1])?t[1]:0,t=t&&n[t]&&n[t].text||t,o=l+(0!==t?" "+o:"")),Tt.tool(e,{i:l,text:t?Ye(o,[t,l]):0,click:function(u){return Tt.drop("menu menu-"+_e(e),function(u){function A(e){return X=this,_=n[ye(X,Ce)],_=F(_)?i[_]:_||{},V=nt(X),!Vt(_)&&d(r=_.click)&&(r=r(e,a),t!==!1&&M&&(B=ot(M)[0]||M,at(B,"i")||tt(B,Ye(o,[V,l])),S(_.text)&&(B=ot(B)[0])&&at(B,"i")&&(Je(B),ze(B,Ye(pt,[_.text[0]])))),r===!1)?We(e):(a.select(),We(e))}function E(e){if(X=this,(x=e.TE.key)("escape"))Tt.exit(1);else if(x("enter"))$e(Ae,X,[e]);else if(x("f10")&&M)M.focus();else if(x("arrowdown")&&(Y=lt(X))){for(;!at(Y,"a")&&Y;)Y=lt(Y);Y&&Y.focus()}else if(x("arrowup")&&(Y=ft(X))){for(;!at(Y,"a")&&Y;)Y=ft(Y);!Y&&M?(Tt.exit(),M.focus()):Y&&Y.focus()}else x("arrowup")&&M&&(Tt.exit(),M.focus());return We(e)}M=Tt.drop.target;for(r in n)if(s=n[r],ee="%"===r[0],s=F(s)&&!ee?i[s]:s){s=qt(s,r,i);var O={href:ee?null:be,"class":St+"-"+(ee?"label":"button")};ee?$=Ct[e]&&Ct[e][+r.slice(1)-1]||r:(O.data={},O.data[Ce]=r,$=ht[r]||r),j=s.text,j=S(j)?j[1]||"":j,$=S($)?$[0]:$,z=Ze(ee?"span":"a",ee?"<span>"+($||"%"+f)+"</span>":s.text||$,c(O,s.attributes||{})),!z.title&&(X=s.title)&&(z.title=S(X)?X[0]+(X[1]?" ("+X[1]+")":""):X),ee?Me(z,{id:St+"-label:"+f}):(Vt(s)&&ze(z,"x"),we(Ae,z,A),we(ie,z,E)),n[r]=s,Rt(u,z),++f}I(function(){st("a",u)[0].focus()},1)}),!1}},r),we(ie,i[e].target,function(t){return t.TE.key("arrowdown")?(Tt.drop.target=this,i[e].click(y,a),We(t)):void 0}),i[e].data=n,a)},Tt.bubble=function(){Tt.exit(0,0,0);var e=arguments,t=e[0],n=e[1];return 1===e.length&&(t="default",n=e[0]),Y=_e(t),rt(Wt),Rt(g,Ze(Wt,!1,{"class":St+"-bubble "+Y})),d(n)?n(Wt):Ze(Wt,n),Tt.bubble.fit(),ve("enter.bubble."+t,[a]),ve("enter.bubble",[a]),a},Tt.bubble.fit=function(t){z=a.$(1),e=Qe(Mt),w=A(Mt,"line-height");var n="border-",r="-width";Y=z.caret[0].x+e.l-Mt.scrollLeft,X=z.caret[1].y+e.t+w-Mt.scrollTop,U=A(Ht,[n+"top"+r,n+"bottom"+r,n+"left"+r,n+"right"+r]);var i=qe(Ht),o=qe(Wt),l=U[0]+U[1],f=U[2]+U[3];return S(t)?(C(t[0])&&(Y=t[0]),C(t[1])&&(X=t[1])):(Y=E(Y,e.l,e.l+i.w-o.w-f),X=E(X,e.t,e.t+i.h-o.h-l)),A(Wt,{left:Y+Ge,top:X+Ge,visibility:"visible"}),ve("fit.bubble",[a]),ve("fit",[a]),a},Tt.overlay.exit=function(e){return Tt.exit(e,"overlay")},Tt.modal.exit=function(e){return Tt.exit(e,"modal")},Tt.drop.exit=function(e){return Tt.exit(e,"drop")},Tt.bubble.exit=function(e){return Tt.exit(e,"bubble")},Tt.tool=function(e,t,n){return $="","|"!==e&&(v.tools=v.tools.filter(function(t,n){return t===e?($=n,!1):!0})),t===!1?delete Tt.tools[e]:("|"===e?(n=t,t={}):(d(t)&&(t={click:t}),Tt.tools[e]=c(Tt.tools[e]||{},t),C(n)||""===$||(n=$)),p(n)?v.tools.splice(n,0,e):v.tools.push(e)),Xt(),a},Tt.key=function(e,t){return v.keys?(t===!1?delete Tt.keys[e]:Tt.keys[e]=t,Jt(),a):a},Tt.tools={"|":{},undo:{i:"undo",click:function(e,t){return t.undo(),!1}},redo:{i:"repeat",click:function(e,t){return t.redo(),!1}},indent:function(e,t){return t.indent(Ne),!1},outdent:function(e,t){return t.outdent(Ne),!1}},we(Ae,$t,Sn),Tt.keys={"control+y":"redo","control+z":"undo",f5:function(e,t){return Sn(e)},f10:function(e,t){return st("a",vt)[0].focus(),!1},"shift+tab":Te?"outdent":0,tab:Te?"indent":0,escape:function(e,t){return $t.focus(),!1}},Tt.el={container:gt,header:mt,body:Ht,footer:Dt,overlay:Pt,modal:yt,drop:kt,bubble:Wt},a.config=v,c(a._,{time:function(){var e=new Date,t=e.getFullYear(),n=e.getMonth()+1,r=e.getDate(),i=e.getHours(),o=e.getMinutes(),l=e.getSeconds(),f=e.getMilliseconds();return 10>n&&(n="0"+n),10>r&&(r="0"+r),10>i&&(i="0"+i),10>o&&(o="0"+o),10>l&&(l="0"+l),10>f&&(f="0"+f),[""+t,""+n,""+r,""+i,""+o,""+l,""+f]},replace:xe,format:Ye,dom:{set:Rt,reset:It,get:st,id:et,copy:function(e,t){return e.cloneNode(C(t)?t:!0)},classes:{set:ze,reset:Je,get:Xe},attributes:{set:Me,reset:Be,get:Ue},data:{set:Pe,reset:ke,get:ye},is:at,offset:Qe,point:Ve,size:qe,content:{set:tt,reset:rt,get:nt},closest:je,parent:it,children:ot,next:lt,previous:ft,before:ct,after:At,prepend:Et,append:Ot},el:Ze,event:{set:we,reset:Ke,fire:$e,x:We},hooks:H,hook:{set:He,reset:De,fire:ve}}),Tt};