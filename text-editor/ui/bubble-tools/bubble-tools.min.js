/*!
 * ==========================================================
 *  BUBBLE TOOLS PLUGIN FOR USER INTERFACE MODULE 1.0.1
 * ==========================================================
 * Author: Taufik Nurrohman <https://github.com/tovic>
 * License: MIT
 * ----------------------------------------------------------
 */
TE.each(function(e){function D(e,t,i){n.tools[e].click(null,i);for(F in t)(H=E("[name=data]",f)[0])&&(H.value=t[F],(G=E("[name=y]",f)[0])&&g.fire("click",G))}function M(t,i,a){C=t.target?w.copy(t.target):function(){return b("a",'<i class="'+v(r,[l[i]&&l[i].i||i])+'"></i>',{"class":o+"-button",href:"javascript:;",data:{"tool-id":i}})}(),g.set("keydown",C,function(t){if(H=this,(G=t.TE.key)("arrowdown"))return g.x(t);if(G("arrowup"))return e.select(),g.x(t);if(G("arrowright")&&(z=x(H))){for(;!$(z,"a")&&z;)z=x(z);z.focus()}else if(G("arrowleft")&&(z=T(H))){for(;!$(z,"a")&&z;)z=T(z);z.focus()}}),g.set("click",C,function(t){return q=_(this,"tool-id"),l[q].click(t,e,q),(G=E("[name=data]",f)[0])&&n.bubble(u,function(t){h(t,{"font-size":"80%"}),z=b("input",!1,{type:"text",value:G.value,"class":o+"-input"}),g.set("keydown",z,function(t){return G=t.TE.key,U=this.value,G("escape")||G("backspace")&&!U?(n.bubble.exit(1),g.x(t)):G("enter")?(D(q,[U,"",""],e),g.x(t)):void 0}),A(t,z),L(function(){z.focus(),z.select()},1)}),O(),g.x(t)}),A(a,C)}var a,I,R,S,C,q,F,H,G,U,z,n=e.ui,i=e.config,o=i.classes[""],r=i.classes.i,l=n.tools,s=["b i a img pre,code","p p,h1,h2,h3,h4,h5,h6 blockquote,q hr table"],u="tool "+o+"-tool",c=e.target,f=n.el.modal,p=e._,b=p.el,d=p.extend,h=p.css,m=p.trim,g=p.event,k=p.hook,v=(p.edge,p.format),w=p.dom,_=w.data.get,E=w.get,x=w.next,T=w.previous,$=w.is,A=w.append,L=setTimeout,O=function(){L(function(){n.bubble.fit()},0)};g.set("keydown",c,function(e){return G=e.TE.key,G("arrowup")?g.x(e):G("arrowdown")?(E("a",n.el.bubble)[0].focus(),g.x(e)):void 0}),g.set("copy cut keyup mouseup paste scroll",c,function(t){G=e.$(),I=c.value&&/(^|\n)$/.test(G.before)&&/(\n|$)$/.test(G.after),G.length||I?n.bubble(u,function(e){h(e,{padding:0,"font-size":"80%"}),a=i.tools_alt||s,a="string"==typeof a?[a,a]:d(a,s),R=m(a[I?1:0]).split(/\s+/);for(H in R)H=R[H],(S=l[H])&&M(S,H,e)}):n.bubble.exit()}),k.set("enter.bubble",O)});