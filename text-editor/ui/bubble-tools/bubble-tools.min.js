/*!
 * ==========================================================
 *  BUBBLE TOOLS PLUGIN FOR USER INTERFACE MODULE 1.0.2
 * ==========================================================
 * Author: Taufik Nurrohman <https://github.com/tovic>
 * License: MIT
 * ----------------------------------------------------------
 */
TE.each(function(e){function z(e,n,i){t.tools[e].click(null,i);for(q in n)(F=_("[name=data]",c)[0])&&(F.value=n[q],(H=_("[name=y]",c)[0])&&m.fire("click",H))}function D(l,a,u){S=l.target?y.copy(l.target):function(){return l=n.languages.tools[a],p("a",'<i class="'+v(o,[r[a]&&r[a].i||a])+'"></i>',{"class":i+"-button",title:"object"==typeof l?l[0]+(l[1]?"("+l[1]+")":""):l,href:"javascript:;",data:{"tool-id":a}})}(),m.set("keydown",S,function(t){if(F=this,(H=t.TE.key)("arrowdown"))return m.x(t);if(H("arrowup"))return e.select(),m.x(t);if(H("arrowright")&&(U=x(F))){for(;!E(U,"a")&&U;)U=x(U);U.focus()}else if(H("arrowleft")&&(U=T(F))){for(;!E(U,"a")&&U;)U=T(U);U.focus()}}),m.set("click",S,function(n){return C=w(this,"tool-id"),r[C].click(n,e,C),(H=_("[name=data]",c)[0])&&t.bubble(s,function(n){d(n,{"font-size":"80%"}),G=H.value,U=p("input",!1,{type:"text",value:G,placeholder:G,"class":i+"-input"}),m.set("keydown",U,function(n){return H=n.TE.key,G=this.value,H("escape")||H("backspace")&&!G?(t.bubble.exit(1),m.x(n)):H("enter")?(z(C,[G,"",""],e),m.x(n)):void 0}),$(n,U),A(function(){U.focus(),U.select()},1)}),L(),m.x(n)}),$(u,S)}var l,O,I,N,S,C,q,F,H,G,U,t=e.ui,n=e.config,i=n.classes[""],o=n.classes.i,r=t.tools,a=["b i a img pre,code","p blockquote,q p,h1,h2,h3,h4,h5,h6 ol ul hr table"],s="tool "+i+"-tool",u=e.target,c=t.el.modal,f=e._,p=f.el,b=f.extend,d=f.css,h=f.trim,m=f.event,g=f.hook,v=(f.edge,f.format),y=f.dom,w=y.data.get,_=y.get,x=y.next,T=y.previous,E=y.is,$=y.append,A=setTimeout,L=function(){A(function(){t.bubble.fit()},0)};m.set("keydown",u,function(e){return H=e.TE.key,H("arrowup")?m.x(e):H("arrowdown")?(_("a",t.el.bubble)[0].focus(),m.x(e)):void 0}),m.set("copy cut keyup mouseup paste scroll",u,function(i){H=e.$(),O=u.value&&/(^|\n)$/.test(H.before)&&/(\n|$)$/.test(H.after),H.length||O?t.bubble(s,function(e){d(e,{padding:0,"font-size":"80%"}),l=n.tools_alt||a,l="string"==typeof l?[l,l]:b(l,a),I=h(l[O?1:0]).split(/\s+/);for(F in I)F=I[F],(N=r[F])&&D(N,F,e)}):t.bubble.exit()}),g.set("enter.bubble",L)});