TE.each(function(e){function E(e){return/^image\/.*/i.test(e.type)}function b(e){return/^(text|application)\/.*/i.test(e.type)}function A(e,n,a){t.tools[e].click(null,a);for(l in n)(h=i("[name=data]",u)[0])&&(h.value=n[l],(f=i("[name=y]",u)[0])&&s("click",f))}var l,h,f,d,g,p,v,t=e.ui,n=e._,a=n.dom,i=a.get,o=n.events.set,s=n.events.fire,r=e._.el("input",!1,{type:"file",style:"margin:0;padding:0;border:0;width:1px;height:1px;font:0/0 a;overflow:hidden;position:absolute;top:-1px;left:-1px;opacity:0;"}),u=t.el.modal,c=new FileReader;e._.dom.set(document.body,r),e.ui.tool("file",{i:"folder-open",click:function(e,t){return r.click(),!1}}),o("change",r,function(){d=this,g=d.files,g&&g.length&&(g=g[0],E(g)?(c.readAsDataURL(g),p=0):b(g)&&(c.readAsBinaryString(g),p=1),o("loadend",c,function(t){v=c.result,1===p?e.tidy("\n\n").insert(v):A("img",[v,""],e)}))})});