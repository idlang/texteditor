TE.each(function(e){function g(e){return/^image\/.*/i.test(e.type)}function m(e){return/^(text|application)\/.*/i.test(e.type)}function v(e,n,i){t.tools[e].click(null,i);for(u in n)(c=r("[name=data]",s)[0])&&(c.value=n[u],(d=r("[name=y]",s)[0])&&f("click",d))}var u,c,d,p,h,y,b,t=e.ui,n=e._,i=n.dom,r=i.get,o=n.event.set,f=n.event.fire,l=e._.el("input",!1,{type:"file",style:"margin:0;padding:0;border:0;width:1px;height:1px;font:0/0 a;overflow:hidden;position:absolute;top:-1px;left:-1px;opacity:0;"}),s=t.el.modal,a=new FileReader;e._.dom.set(document.body,l),e.ui.tool("file",{i:"folder-open",click:function(e,t){return l.click(),!1}}),o("change",l,function(){p=this,h=p.files,h&&h.length&&(h=h[0],g(h)?(a.readAsDataURL(h),y=0):m(h)&&(a.readAsBinaryString(h),y=1),o("loadend",a,function(t){b=a.result,1===y?e.tidy("\n\n").insert(b):v("img",[b,""],e)}))})});