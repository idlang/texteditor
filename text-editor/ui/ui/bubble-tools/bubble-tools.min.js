/*!
 * ==========================================================
 *  BUBBLE TOOLS PLUGIN FOR USER INTERFACE MODULE 1.0.9
 * ==========================================================
 * Author: Taufik Nurrohman <https://github.com/tovic>
 * License: MIT
 * ----------------------------------------------------------
 */
TE.each(function(e){function A(e,t,n){i.tools[e].click(null,n);for(S in t)(D=y("[name=data]",l)[0])&&(D.value=t[S],(j=y("[name=y]",l)[0])&&w.fire("click",j))}function I(o,f,u){O=t.languages.tools[f],S=r[f],o=S&&S.i||f,N="|"===f,H=k(N?"span":"a",N?!1:-1!==o.indexOf("<")?o:i.i(f,S.i),N?{"class":n+"-separator"}:{"class":n+"-button",href:"javascript:;",title:"object"==typeof O?O[0]+(O[1]?" ("+O[1]+")":""):O,data:{"tool-id":f}}),w.set("keydown",H,function(t){if(D=this,j=t.TE.key,B=e.$(),j("arrowdown"))return e.select(B.end+("\n"===B.after[0]?1:0)),w.x(t);if(j(/^(arrowup|escape)$/))return e.select(),w.x(t);if(j("arrowright")&&(Y=v(D))){for(;!g(Y,"a")&&Y;)Y=v(Y);Y.focus()}else if(j("arrowleft")&&(Y=x(D))){for(;!g(Y,"a")&&Y;)Y=x(Y);Y.focus()}}),w.set("click",H,function(t){return S=h(this,"tool-id"),r[S].click(t,e,S),(j=y("[name=data]",l)[0])&&i.bubble(s,function(t){d(t,{"font-size":"80%","line-height":"1.25em"}),B=j.value,Y=k("input",!1,{type:"text",value:B,placeholder:B,"class":n+"-input",spellcheck:"false"}),w.set("keydown",Y,function(t){return j=t.TE.key,B=this.value,j("escape")||j(/^(backspace|enter)$/)&&!B?(i.bubble.exit(1),w.x(t)):j("enter")?(A(S,[B,"",""],e),w.x(t)):void 0}),b(t,Y),z(function(){Y.focus(),Y.select()})}),C(),w.x(t)}),b(u,H)}var o,_,M,O,F,N,H,S,D,j,B,Y,t=e.config,n=t.classes[""],i=e.ui,r=i.tools,f=["b i a img pre,code","p blockquote,q p,h1,h2,h3,h4,h5,h6 ul ol hr"],s="tool "+n+"-tool",l=i.el.modal,u=i.el.bubble,a=e.target,c=e._,d=c.css,p=c.dom,b=p.append,h=p.data.get,y=p.get,g=p.is,v=p.next,x=p.previous,k=(c.edge,c.el),w=c.event,E=c.extend,$=(c.format,c.hook),z=c.timer.set,L=c.trim,C=function(){z(function(){i.bubble.fit()})};t.tools_alt&&(w.set("keydown",a,function(t){return j=t.TE.key,B=!t.TE.shift()&&y(u)[0],Y=e.$(),B&&j("arrowup")?(e.select(Y.start-("\n"===Y.before.slice(-1)?1:0)),w.x(t)):B&&j("arrowdown")?(y("a",u)[0].focus(),w.x(t)):void 0}),w.set("copy cut keyup mouseup paste scroll",a,function(n){j=e.$(),_=e.get(0)&&/(^|\n)$/.test(j.before)&&/(\n|$)$/.test(j.after),j.length||_?i.bubble(s,function(e){d(e,{padding:0,"font-size":"80%"}),o=t.tools_alt,o=o===!0?f:o,o="string"==typeof o?[o,o]:E(o,f),M=L(o[_?1:0]).split(/\s+/);for(D in M)D=M[D],(F=r[D])&&I(F,D,e)}):i.bubble.exit()}),$.set("enter.bubble",C))});