TE.each(function(e){function Y(e,t,n){r.tools[e].click(null,n);for(O in t)(S=g("[name=data]",o)[0])&&(S.value=t[O],(A=g("[name=y]",o)[0])&&w.fire("click",A))}function I(a,f,c){M=t.languages.tools[f],O=l[f],a=O&&O.i||f,j="|"===f,H=k(j?"span":"a",j?!1:"<"===a[0]?a:'<i class="'+T(i,[O.target?y(O.target,"tool-id"):f,a])+'"></i>',j?{"class":n+"-separator"}:{"class":n+"-button",href:"javascript:;",title:"object"==typeof M?M[0]+(M[1]?" ("+M[1]+")":""):M,data:{"tool-id":f}}),w.set("keydown",H,function(t){if(S=this,A=t.TE.key,B=e.$(),A("arrowdown"))return e.select(B.end+("\n"===B.after[0]?1:0)),w.x(t);if(A(/^(arrowup|escape)$/))return e.select(),w.x(t);if(A("arrowright")&&(N=v(S))){for(;!m(N,"a")&&N;)N=v(N);N.focus()}else if(A("arrowleft")&&(N=x(S))){for(;!m(N,"a")&&N;)N=x(N);N.focus()}}),w.set("click",H,function(t){return O=y(this,"tool-id"),l[O].click(t,e,O),(A=g("[name=data]",o)[0])&&r.bubble(s,function(t){p(t,{"font-size":"80%","line-height":"1.25em"}),B=A.value,N=k("input",!1,{type:"text",value:B,placeholder:B,"class":n+"-input",spellcheck:"false"}),w.set("keydown",N,function(t){return A=t.TE.key,B=this.value,A("escape")||A(/^(backspace|enter)$/)&&!B?(r.bubble.exit(1),w.x(t)):A("enter")?(Y(O,[B,"",""],e),w.x(t)):void 0}),h(t,N),z(function(){N.focus(),N.select()})}),F(),w.x(t)}),h(c,H)}var a,L,D,M,C,j,H,O,S,A,B,N,t=e.config,n=t.classes[""],i=t.classes.i,r=e.ui,l=r.tools,f=["b i a img pre,code","p blockquote,q p,h1,h2,h3,h4,h5,h6 ol ul hr"],s="tool "+n+"-tool",o=r.el.modal,c=r.el.bubble,u=e.target,d=e._,p=d.css,b=d.dom,h=b.append,y=b.data.get,g=b.get,m=b.is,v=b.next,x=b.previous,k=(d.edge,d.el),w=d.event,E=d.extend,T=d.format,$=d.hook,z=d.timer.set,R=d.trim,F=function(){z(function(){r.bubble.fit()})};t.tools_alt&&(w.set("keydown",u,function(t){return A=t.TE.key,B=!t.TE.shift()&&g(c)[0],N=e.$(),B&&A("arrowup")?(e.select(N.start-("\n"===N.before.slice(-1)?1:0)),w.x(t)):B&&A("arrowdown")?(g("a",c)[0].focus(),w.x(t)):void 0}),w.set("copy cut keyup mouseup paste scroll",u,function(n){A=e.$(),L=e.get(0)&&/(^|\n)$/.test(A.before)&&/(\n|$)$/.test(A.after),A.length||L?r.bubble(s,function(e){p(e,{padding:0,"font-size":"80%"}),a=t.tools_alt,a=a===!0?f:a,a="string"==typeof a?[a,a]:E(a,f),D=R(a[L?1:0]).split(/\s+/);for(S in D)S=D[S],(C=l[S])&&I(C,S,e)}):r.bubble.exit()}),$.set("enter.bubble",F))});