/*!
 * ==========================================================
 *  BUBBLE TOOLS PLUGIN FOR USER INTERFACE MODULE 1.0.9
 * ==========================================================
 * Author: Taufik Nurrohman <https://github.com/tovic>
 * License: MIT
 * ----------------------------------------------------------
 */
TE.each(function(e){function j(e,t,n){i.tools[e].click(null,n);for(N in t)(B=y("[name=data]",u)[0])&&(B.value=t[N],(F=y("[name=y]",u)[0])&&w.fire("click",F))}function I(o,f,l){M=t.languages.tools[f],N=r[f],o=N&&N.i||f,D="|"===f,H=k(D?"span":"a",D?!1:-1!==o.indexOf("<")?o:i.i(f,N.i),D?{"class":n+"-separator"}:{"class":n+"-button",href:"javascript:;",title:"object"==typeof M?M[0]+(M[1]?" ("+M[1]+")":""):M,data:{"tool-id":f}}),w.set("keydown",H,function(t){if(B=this,F=t.TE.key,Y=e.$(),F("arrowdown"))return e.select(Y.end+("\n"===Y.after[0]?1:0)),w.x(t);if(F(/^(arrowup|escape)$/))return e.select(),w.x(t);if(F("arrowright")&&(A=v(B))){for(;!g(A,"a")&&A;)A=v(A);A.focus()}else if(F("arrowleft")&&(A=m(B))){for(;!g(A,"a")&&A;)A=m(A);A.focus()}}),w.set("click",H,function(t){return N=h(this,"tool-id"),r[N].click(t,e,N),(F=y("[name=data]",u)[0])&&i.bubble(s,function(t){d(t,{"font-size":"80%"}),Y=F.value,A=k("input",!1,{type:"text",value:Y,placeholder:Y,"class":n+"-input",spellcheck:"false"}),w.set("keydown",A,function(t){return F=t.TE.key,Y=this.value,F("escape")||F(/^(backspace|enter)$/)&&!Y?(i.bubble.exit(1),w.x(t)):F("enter")?(j(N,[Y,"",""],e),w.x(t)):void 0}),b(t,A),L(function(){A.focus(),A.select()})}),_(),w.x(t)}),b(l,H)}var o,O,C,M,S,D,H,N,B,F,Y,A,t=e.config,n=t.classes[""],i=e.ui,r=i.tools,f=["b i a img pre,code","p blockquote,q p,h1,h2,h3,h4,h5,h6 ul ol hr"],s="tool "+n+"-tool",u=i.el.modal,l=i.el.bubble,a=e.target,c=e._,d=c.css,p=c.dom,b=p.append,h=p.data.get,y=p.get,g=p.is,v=p.next,m=p.previous,k=(c.edge,c.el),w=c.event,E=c.extend,$=(c.format,c.hook),L=c.timer.set,z=c.trim,_=function(){L(function(){i.bubble.fit()})};t.tools_alt&&(w.set("keydown",a,function(t){return F=t.TE.key,Y=!t.TE.shift()&&y(l)[0],A=e.$(),Y&&F("arrowup")?(e.select(A.start-("\n"===A.before.slice(-1)?1:0)),w.x(t)):Y&&F("arrowdown")?(y("a",l)[0].focus(),w.x(t)):void 0}),w.set("copy cut keyup mouseup paste scroll",a,function(n){F=e.$(),O=e.get(0)&&/(^|\n)$/.test(F.before)&&/(\n|$)$/.test(F.after),F.length||O?i.bubble(s,function(e){d(e,{padding:0,"font-size":"80%"}),o=t.tools_alt,o=o===!0?f:o,o="string"==typeof o?[o,o]:E(o,f),C=z(o[O?1:0]).split(/\s+/);for(B in C)B=C[B],(S=r[B])&&I(S,B,e)}):i.bubble.exit()}),$.set("enter.bubble",_))});