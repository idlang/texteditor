/*!
 * ===========================================================
 *  FIND AND REPLACE PLUGIN FOR USER INTERFACE MODULE 1.1.0
 * ===========================================================
 * Author: Taufik Nurrohman <https://github.com/tovic>
 * License: MIT
 * -----------------------------------------------------------
 */
TE.each(function(e){function H(e,t,n){n=n||0;var a=e.slice(n).search(t);return a>=0?a+n:a}function P(){T=Z.value,Y=e.get(),C=1===i?Y.indexOf(T,o):2===i?H(Y,m(T),o):3===i?H(Y,m(T,"i"),o):Y.toLowerCase().indexOf(T.toLowerCase(),o),-1===C?n.alert(j[0],y(j[1],[T]),q):(2!==i&&3!==i&&(T=v(T)),Y=(Y.slice(C).match(m("^"+T,0===i||2===i?"i":""))||[""])[0].length,o=C+Y,e.select(C,C+Y),u.scrollTop=e.$(1).caret[0].y)}function B(t){C=Z.value,e.select(!0).replace(m(0!==i&&1!==i?C:v(C),(t?"":"g")+(1!==i&&3!==i?"i":"")),N.value),t&&(N.focus(),N.select())}function K(e){n.prompt(L[0],L[1],""+i,function(e,t,n){q(),h(D,L[1][i=+n])},2)}function $(e){return w=e.TE.key,w("alt")?(K(),A(e)):w(/^(arrowdown|enter)$/)?(P(),A(e)):void 0}function q(){o=0,p(Z,!1,{type:"text","class":r+"-input "+r+"-input-find",id:r+"-find:"+t,title:z[0]}),p(N,!1,{type:"text","class":r+"-input "+r+"-input-replace",id:r+"-replace:"+t,title:z[1]}),p(G,n.i("config","cogs"),{href:"javascript:;","class":r+"-a",title:L[0],style:"width:1.125em;height:1.125em;line-height:1.125em;margin:0 .25em 0 .5em;"}),p(M,S[0],{"class":r+"-label "+r+"-label-find","for":r+"-find:"+t,style:"padding:0 .5em;"}),p(J,S[1],{"class":r+"-label "+r+"-label-replace","for":r+"-replace:"+t,style:"padding:0 .5em;"}),p(D,L[1][i],{"class":r+"-label "+r+"-label-status"}),p(G.firstChild,!1,{style:"display:block;background-size:100% auto;"}),p(R,[M,Z,J,N,G,D],{"class":r+k+" "+x,id:r+k+":"+t,style:"font-size:80%;padding:.25em;border-top:1px solid;border-top-color:inherit;"}),C=e.blur().$(),!f(R)[0]&&(C=C.value)&&(Z.value=C),g(n.el.header,R),U(function(){Z.focus(),Z.select()}),b("keydown",u,$)}function F(){d(R),e.select(),E("keydown",u,$)}var w,C,Y,T,z,S,L,j,t=Date.now(),n=e.ui,a=e.config,i=0,o=0,s=a.languages,r=a.classes[""],u=e.target,c=e._,l=c.dom,h=l.content.set,f=l.get,d=l.reset,g=l.set,p=c.el,v=c.x,E=c.events.reset,b=c.events.set,A=c.events.x,O=c.extend,y=c.format,m=c.pattern,U=c.timer.set,k="-find-replace",x=r+k+"--"+t;O(s,{tools:{find:["Find and Replace","⌘+F"]},modals:{find:["Mode",["Ignore Case","Match Case","Match Pattern","Match Case and Pattern"]],find_alert:["Not Found","Can’t find “%1”. Find again from top?"]},placeholders:{find:["find…","replace with…"]},labels:{find:["Find","Replace"]}});var R=p(),Z=p("input"),N=p("input"),G=p("a"),M=p("label"),J=p("label"),D=p("span");z=s.placeholders.find,S=s.labels.find,L=s.modals.find,j=s.modals.find_alert,b("click",u,F),b("keydown",Z,function(e){return w=e.TE.key,T=this.value,e.TE.control("f")||w("backspace")&&!T?(T?q():F(),A(e)):w("alt")?(K(),A(e)):w("tab")?(!N.value&&(N.value=Z.value),N.focus(),N.select(),A(e)):w("enter")&&T?(P(),A(e)):void 0}),b("keydown",N,function(e){return w=e.TE.key,T=this.value,e.TE.control("f")?(T?q():F(),A(e)):w("backspace")&&!T?(Z.focus(),A(e)):w("alt")?(K(),A(e)):w("tab")?(G.focus(),A(e)):w("enter")?(B(e.TE.control()),A(e)):void 0}),b("click",G,K),b("click",D,K),n.tool("find",{i:"binoculars",click:function(e,t){return f(R)[0]?F():q(),!1}}),n.key("control+f","find")});