/*!
 * ===========================================================
 *  FIND AND REPLACE PLUGIN FOR USER INTERFACE MODULE 1.0.1
 * ===========================================================
 * Author: Taufik Nurrohman <https://github.com/tovic>
 * License: MIT
 * -----------------------------------------------------------
 */
TE.each(function(e){function B(e,t,n){n=n||0;var i=e.slice(n).search(t);return i>=0?i+n:i}function F(){z=M.value,O=f.modals.find_alert,C=e.get(),s=1===r?C.indexOf(z,o):2===r?B(C,w(z),o):3===r?B(C,w(z,"i"),o):C.toLowerCase().indexOf(z.toLowerCase(),o),-1===s?n.alert(O[0],k(O[1],[z]),I):(2!==r&&3!==r&&(z=g(z)),C=(C.slice(s).match(w("^"+z,0===r||2===r?"i":""))||[""])[0].length,o=s+C,e.select(s,s+C),l.scrollTop=e.$(1).caret[0].y)}function A(){s=M.value,e.select(!0).replace(w(0!==r&&1!==r?s:g(s),"g"+(1!==r&&3!==r?"i":"")),S.value)}function Y(e){O=f.modals.find,n.prompt(O[0],O[1],""+r,function(e,t,n){I(),c(H,O[1][r=+n])},2)}function j(e){return _=e.TE.key,_("alt")?(Y(),v(e)):_(/^(arrowdown|enter)$/)?(F(),v(e)):void 0}function I(){o=0,s=e.blur().$(),!d(N)[0]&&(s=s.value)&&(M.value=s),b(n.el.header,N),E(function(){M.focus(),M.select()}),m("keydown",l,j)}function q(){n.key.set("control"),p(N,0),e.select(),y("keydown",l,j)}var _,s,z,O,C,t=Date.now(),n=e.ui,i=e.config,r=0,o=0,f=i.languages,s=i.classes[""],l=e.target,u=e._,a=u.dom,c=a.content.set,d=a.get,p=a.reset,b=a.set,h=u.el,g=u.x,y=u.event.reset,m=u.event.set,v=u.event.x,x=u.extend,k=u.format,w=u.pattern,E=u.timer.set,$="-find-replace",T=s+$+"--"+t;x(f,{tools:{find:["Find and Replace","⌘+F"]},modals:{find:["Mode",["Ignore Case","Match Case","Match Pattern","Match Case and Pattern"]],find_alert:["Not Found","Can’t find “%1”. Find again from top?"]},placeholders:{find:["find…","replace with…"]},labels:{find:["Find","Replace"]}}),O=f.placeholders.find;var M=h("input",!1,{type:"text","class":s+"-input "+s+"-input-find",id:s+"-find:"+t,title:O[0]}),S=h("input",!1,{type:"text","class":s+"-input "+s+"-input-replace",id:s+"-replace:"+t,title:O[1]}),D=h("a",n.i("config","cogs"),{href:"javascript:;","class":s+"-a",title:f.modals.find[0],style:"padding:0 .25em 0 .5em;"}),H=h("span",f.modals.find[1][0],{"class":s+"-label"});D.firstChild.style.backgroundSize="100% auto",O=f.labels.find;var N=h("div",[h("label",O[0],{"class":s+"-label "+s+"-label-find","for":s+"-find:"+t,style:"padding:0 .5em;"}),M,h("label",O[1],{"class":s+"-label "+s+"-label-replace","for":s+"-replace:"+t,style:"padding:0 .5em;"}),S,D,H],{"class":s+$+" "+T,id:s+$+":"+t,style:"font-size:80%;line-height:1.25em;padding:.25em;border-top:1px solid;border-top-color:inherit;"});m("click",l,q),m("keydown",M,function(e){return _=e.TE.key,z=this.value,e.TE.control("f")||_("backspace")&&!z?(z?I():q(),v(e)):_("alt")?(Y(),v(e)):_("tab")?(S.value=M.value,S.focus(),S.select(),v(e)):_("enter")&&z?(F(),v(e)):void 0}),m("keydown",S,function(e){return _=e.TE.key,z=this.value,e.TE.control("f")?(z?I():q(),v(e)):_("backspace")&&!z?(M.focus(),v(e)):_("alt")?(Y(),v(e)):_("tab")?(D.focus(),v(e)):_("enter")?(A(),v(e)):void 0}),m("click",D,Y),m("click",H,Y),n.tool("find",{i:"binoculars",click:function(e,t){return d(N)[0]?q():I(),!1}}),n.key("control+f","find")});