/*!
 * ===========================================================
 *  FIND AND REPLACE PLUGIN FOR USER INTERFACE MODULE 1.1.1
 * ===========================================================
 * Author: Taufik Nurrohman <https://github.com/tovic>
 * License: MIT
 * -----------------------------------------------------------
 */
TE.each(function(E){function w(E,T,A){A=A||0;var L=E.slice(A).search(T);return L>=0?L+A:L}function k(){W=B.value,D=E.get(),F=1===e?D.indexOf(W,I):2===e?w(D,G(W),I):3===e?w(D,G(W,"i"),I):D.toLowerCase().indexOf(W.toLowerCase(),I),-1===F?A.alert(m[0],f(m[1],[W]),q):(2!==e&&3!==e&&(W=l(W)),D=(D.slice(F).match(G("^"+W,0===e||2===e?"i":""))||[""])[0].length,I=F+D,E.select(F,F+D),r.scrollTop=E.$(1).caret[0].y)}function V(T){F=B.value,E.select(!0).replace(G(0!==e&&1!==e?F:l(F),(T?"":"g")+(1!==e&&3!==e?"i":"")),b.value),T&&(b.focus(),b.select())}function Q(E){A.prompt(h[0],h[1],""+e,function(E,T,A){q(),O(x,h[1][e=+A])},2)}function X(E){return d=E.TE.key,d("alt")?(Q(),u(E)):d(["down","enter"])?(k(),u(E)):void 0}function q(){I=0,S(B,!1,{type:"text","class":t+"-input "+t+"-input-find",id:t+"-find:"+T,title:p[0]}),S(b,!1,{type:"text","class":t+"-input "+t+"-input-replace",id:t+"-replace:"+T,title:p[1]}),S(v,A.i("config","cogs"),{href:"javascript:;","class":t+"-a",title:h[0],style:"width:1.125em;height:1.125em;line-height:1.125em;margin:0 .25em 0 .5em;"}),S(Y,K[0],{"class":t+"-label "+t+"-label-find","for":t+"-find:"+T,style:"padding:0 .5em;"}),S(y,K[1],{"class":t+"-label "+t+"-label-replace","for":t+"-replace:"+T,style:"padding:0 .5em;"}),S(x,h[1][e],{"class":t+"-label "+t+"-label-status"}),S(v.firstChild,!1,{style:"display:block;background-size:100% auto;"}),S(g,[Y,B,y,b,v,x],{"class":t+H+" "+P,id:t+H+":"+T,style:"font-size:80%;padding:.25em;border-top:1px solid;border-top-color:inherit;"}),F=E.blur().$(),!N(g)[0]&&(F=F.value)&&(B.value=F),a(A.el.header,g),M(function(){B.focus(),B.select()}),s("keydown",r,X)}function z(){o(g),E.select(),C("keydown",r,X)}var d,F,D,W,p,K,h,m,T=Date.now(),A=E.ui,L=E.config,e=0,I=0,R=L.languages,t=L.classes[""],r=E.target,i=E._,n=i.dom,O=n.content.set,N=n.get,o=n.reset,a=n.set,S=i.el,l=i.x,C=i.events.reset,s=i.events.set,u=i.events.x,c=i.extend,f=i.format,G=i.pattern,M=i.timer.set,H="-find-replace",P=t+H+"--"+T;c(R,{tools:{find:["Find and Replace","⌘+F"]},modals:{find:["Mode",["Ignore Case","Match Case","Match Pattern","Match Case and Pattern"]],find_alert:["Not Found","Can’t find “%1”. Find again from top?"]},placeholders:{find:["find…","replace with…"]},labels:{find:["Find","Replace"]}});var g=S(),B=S("input"),b=S("input"),v=S("a"),Y=S("label"),y=S("label"),x=S("span");p=R.placeholders.find,K=R.labels.find,h=R.modals.find,m=R.modals.find_alert,s("click",r,z),s("keydown",B,function(E){return d=E.TE.key,W=this.value,E.TE.control("f")||d("back")&&!W?(W?q():z(),u(E)):d("alt")?(Q(),u(E)):d("tab")?(!b.value&&(b.value=B.value),b.focus(),b.select(),u(E)):d("enter")&&W?(k(),u(E)):void 0}),s("keydown",b,function(E){return d=E.TE.key,W=this.value,E.TE.control("f")?(W?q():z(),u(E)):d("back")&&!W?(B.focus(),u(E)):d("alt")?(Q(),u(E)):d("tab")?(v.focus(),u(E)):d("enter")?(V(E.TE.control()),u(E)):void 0}),s("click",v,Q),s("click",x,Q),A.tool("find",{i:"binoculars",click:function(E,T){return N(g)[0]?z():q(),!1}}),A.key("control+f","find")});