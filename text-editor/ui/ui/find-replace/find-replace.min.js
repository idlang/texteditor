/*!
 * ===========================================================
 *  FIND AND REPLACE PLUGIN FOR USER INTERFACE MODULE 1.0.2
 * ===========================================================
 * Author: Taufik Nurrohman <https://github.com/tovic>
 * License: MIT
 * -----------------------------------------------------------
 */
TE.each(function(e){function B(e,t,n){n=n||0;var i=e.slice(n).search(t);return i>=0?i+n:i}function Y(){C=D.value,M=f.modals.find_alert,O=e.get(),s=1===r?O.indexOf(C,o):2===r?B(O,E(C),o):3===r?B(O,E(C,"i"),o):O.toLowerCase().indexOf(C.toLowerCase(),o),-1===s?n.alert(M[0],w(M[1],[C]),q):(2!==r&&3!==r&&(C=g(C)),O=(O.slice(s).match(E("^"+C,0===r||2===r?"i":""))||[""])[0].length,o=s+O,e.select(s,s+O),u.scrollTop=e.$(1).caret[0].y)}function j(t){s=D.value,e.select(!0).replace(E(0!==r&&1!==r?s:g(s),(t?"":"g")+(1!==r&&3!==r?"i":"")),S.value),t&&(S.focus(),S.select())}function A(e){M=f.modals.find,n.prompt(M[0],M[1],""+r,function(e,t,n){q(),d(N,M[1][r=+n])},2)}function I(e){return _=e.TE.key,_("alt")?(A(),x(e)):_(/^(arrowdown|enter)$/)?(Y(),x(e)):void 0}function q(){o=0,s=e.blur().$(),!p(F)[0]&&(s=s.value)&&(D.value=s),h(n.el.header,F),T(function(){D.focus(),D.select()}),m("keydown",u,I)}function R(){b(F,0),e.select(),v("keydown",u,I)}var _,s,C,M,O,t=Date.now(),n=e.ui,i=e.config,r=0,o=0,f=i.languages,s=i.classes[""],u=e.target,l=e._,c=(l.css,l.dom),d=c.content.set,p=c.get,b=c.reset,h=c.set,y=l.el,g=l.x,v=l.event.reset,m=l.event.set,x=l.event.x,k=l.extend,w=l.format,E=l.pattern,T=l.timer.set,$="-find-replace",L=s+$+"--"+t;k(f,{tools:{find:["Find and Replace","⌘+F"]},modals:{find:["Mode",["Ignore Case","Match Case","Match Pattern","Match Case and Pattern"]],find_alert:["Not Found","Can’t find “%1”. Find again from top?"]},placeholders:{find:["find…","replace with…"]},labels:{find:["Find","Replace"]}}),M=f.placeholders.find;var D=y("input",!1,{type:"text","class":s+"-input "+s+"-input-find",id:s+"-find:"+t,title:M[0]}),S=y("input",!1,{type:"text","class":s+"-input "+s+"-input-replace",id:s+"-replace:"+t,title:M[1]}),H=y("a",n.i("config","cogs"),{href:"javascript:;","class":s+"-a",title:f.modals.find[0],style:"width:1.125em;height:1.125em;line-height:1.125em;margin:0 .25em 0 .5em;"}),N=y("span",f.modals.find[1][0],{"class":s+"-label"});H.firstChild.style.backgroundSize="100% auto",M=f.labels.find;var F=y("div",[y("label",M[0],{"class":s+"-label "+s+"-label-find","for":s+"-find:"+t,style:"padding:0 .5em;"}),D,y("label",M[1],{"class":s+"-label "+s+"-label-replace","for":s+"-replace:"+t,style:"padding:0 .5em;"}),S,H,N],{"class":s+$+" "+L,id:s+$+":"+t,style:"font-size:80%;padding:.25em;border-top:1px solid;border-top-color:inherit;"});m("click",u,R),m("keydown",D,function(e){return _=e.TE.key,C=this.value,e.TE.control("f")||_("backspace")&&!C?(C?q():R(),x(e)):_("alt")?(A(),x(e)):_("tab")?(S.value=D.value,S.focus(),S.select(),x(e)):_("enter")&&C?(Y(),x(e)):void 0}),m("keydown",S,function(e){return _=e.TE.key,C=this.value,e.TE.control("f")?(C?q():R(),x(e)):_("backspace")&&!C?(D.focus(),x(e)):_("alt")?(A(),x(e)):_("tab")?(H.focus(),x(e)):_("enter")?(j(e.TE.control()),x(e)):void 0}),m("click",H,A),m("click",N,A),n.tool("find",{i:"binoculars",click:function(e,t){return p(F)[0]?R():q(),!1}}),n.key("control+f","find")});