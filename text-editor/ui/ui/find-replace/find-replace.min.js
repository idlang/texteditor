/*!
 * ===========================================================
 *  FIND AND REPLACE PLUGIN FOR USER INTERFACE MODULE 0.0.9
 * ===========================================================
 * Author: Taufik Nurrohman <https://github.com/tovic>
 * License: MIT
 * -----------------------------------------------------------
 */
TE.each(function(e){function R(e,t,n){n=n||0;var i=e.slice(n).search(t);return i>=0?i+n:i}function D(){C=P.value,F=a.modals.find,$=e.get(),r=1===l?$.indexOf(C,z):2===l?R($,w(C),z):3===l?R($,w(C,"i"),z):$.toLowerCase().indexOf(C.toLowerCase(),z),-1===r?n.alert(F[0],F[1],A):(2!==l&&3!==l&&(C=h(C)),$=($.slice(r).match(w("^"+C,0===l||2===l?"i":""))||[""])[0].length,z=r+$,e.select(r,r+$),o.scrollTop=e.$(1).caret[0].y)}function j(){r=e.$().length,r||e.select(!0),r=P.value,e.replace(w(0!==l&&1!==l?r:h(r),"g"+(1!==l&&3!==l?"i":"")),O.value)}function W(e){F=a.modals.find_config,n.prompt(F[0],F[1],""+l,function(e,t,n){A(),c(I,F[1][l=+n])},2)}function S(e){return M=e.TE.key,M("alt")?(W(),m(e)):M(/^(arrowdown|enter)$/)?(D(),m(e)):void 0}function A(){z=0,r=e.blur().$(),!d(L)[0]&&(r=r.value)&&(P.value=r),p(n.el.header,L),x(function(){P.focus(),P.select()}),v("keydown",o,S)}function H(){n.key.set("control"),u(L,!1),e.select(),b("keydown",o,S)}var M,r,C,F,$,t=Date.now(),n=e.ui,i=e.config,l=0,a=i.languages,r=i.classes[""],o=e.target,f=e._,s=f.dom,c=s.content.set,d=s.get,u=s.reset,p=s.set,g=f.el,h=f.x,b=f.event.reset,v=f.event.set,m=f.event.x,y=f.extend,k=f.format,w=f.pattern,x=f.timer.set,E="-find-replace",T=r+E+"--"+t;y(a,{tools:{find:["Find and Replace","⌘+F"]},modals:{find:["No Matches","We couldn’t find what you were looking for. Find again from top?"],find_config:["Mode",["Ignore Case","Match Case","Match Pattern","Match Case and Pattern"]]},placeholders:{find:["find…","replace with…"]},labels:{find:["Find","Replace"]}}),F=a.placeholders.find;var P=g("input",!1,{type:"text","class":r+"-input "+r+"-input-find",id:r+"-find:"+t,title:F[0]}),O=g("input",!1,{type:"text","class":r+"-input "+r+"-input-replace",id:r+"-replace:"+t,title:F[1]}),N=g("a",'<i class="'+k(i.classes.i,["config","cogs"])+'"></i>',{href:"javascript:;","class":r+"-a",title:a.modals.find_config[0],style:"padding:0 .5em;"}),I=g("label",a.modals.find_config[1][0],{"class":r+"-label"});F=a.labels.find;var L=g("div",[g("label",F[0],{"class":r+"-label "+r+"-label-find","for":r+"-find:"+t,style:"padding:0 .5em;"}),P,g("label",F[1],{"class":r+"-label "+r+"-label-replace","for":r+"-replace:"+t,style:"padding:0 .5em;"}),O,N,I],{"class":r+E+" "+T,id:r+E+":"+t,style:"font-size:80%;line-height:1.25em;padding:.25em;border-top:1px solid;border-top-color:inherit;"}),z=0;v("click",o,H),v("keydown",P,function(e){return M=e.TE.key,C=this.value,e.TE.control("f")||M("backspace")&&!C?(H(),m(e)):M("alt")?(W(),m(e)):M("tab")?(O.value=P.value,O.focus(),O.select(),m(e)):M("enter")&&C?(D(),m(e)):void 0}),v("keydown",O,function(e){return M=e.TE.key,C=this.value,e.TE.control("f")?(H(),m(e)):M("backspace")&&!C?(P.focus(),m(e)):M("alt")?(W(),m(e)):M("tab")?(N.focus(),m(e)):M("enter")?(j(),m(e)):void 0}),v("click",N,W),n.tool("find",{i:"binoculars",click:function(e,t){return d(L)[0]?H():A(),!1}}),n.key("control+f","find")});