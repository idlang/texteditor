/*!
 * ===========================================================
 *  FIND AND REPLACE PLUGIN FOR USER INTERFACE MODULE 1.0.3
 * ===========================================================
 * Author: Taufik Nurrohman <https://github.com/tovic>
 * License: MIT
 * -----------------------------------------------------------
 */
TE.each(function(e){function J(e,t,n){n=n||0;var i=e.slice(n).search(t);return i>=0?i+n:i}function U(){K=H.value,F=e.get(),M=1===a?F.indexOf(K,r):2===a?J(F,w(K),r):3===a?J(F,w(K,"i"),r):F.toLowerCase().indexOf(K.toLowerCase(),r),-1===M?n.alert(z[0],x(z[1],[K]),Y):(2!==a&&3!==a&&(K=g(K)),F=(F.slice(M).match(w("^"+K,0===a||2===a?"i":""))||[""])[0].length,r=M+F,e.select(M,M+F),s.scrollTop=e.$(1).caret[0].y)}function N(t){M=H.value,e.select(!0).replace(w(0!==a&&1!==a?M:g(M),(t?"":"g")+(1!==a&&3!==a?"i":"")),S.value),t&&(S.focus(),S.select())}function I(e){n.prompt(R[0],R[1],""+a,function(e,t,n){Y(),u(P,R[1][a=+n])},2)}function A(e){return L=e.TE.key,L("alt")?(I(),y(e)):L(/^(arrowdown|enter)$/)?(U(),y(e)):void 0}function Y(){r=0,h(H,!1,{type:"text","class":o+"-input "+o+"-input-find",id:o+"-find:"+t,title:D[0]}),h(S,!1,{type:"text","class":o+"-input "+o+"-input-replace",id:o+"-replace:"+t,title:D[1]}),h(j,n.i("config","cogs"),{href:"javascript:;","class":o+"-a",title:R[0],style:"width:1.125em;height:1.125em;line-height:1.125em;margin:0 .25em 0 .5em;"}),h(O,$[0],{"class":o+"-label "+o+"-label-find","for":o+"-find:"+t,style:"padding:0 .5em;"}),h(G,$[1],{"class":o+"-label "+o+"-label-replace","for":o+"-replace:"+t,style:"padding:0 .5em;"}),h(P,R[1][a],{"class":o+"-label "+o+"-label-status"}),h(j.firstChild,!1,{style:"display:block;background-size:100% auto;"}),h(B,[O,H,G,S,j,P],{"class":o+E+" "+C,id:o+E+":"+t,style:"font-size:80%;padding:.25em;border-top:1px solid;border-top-color:inherit;"}),M=e.blur().$(),!d(B)[0]&&(M=M.value)&&(H.value=M),b(n.el.header,B),T(function(){H.focus(),H.select()}),k("keydown",s,A)}function q(){p(B),e.select(),m("keydown",s,A)}var L,M,F,K,D,$,R,z,t=Date.now(),n=e.ui,i=e.config,a=0,r=0,l=i.languages,o=i.classes[""],s=e.target,f=e._,c=f.dom,u=c.content.set,d=c.get,p=c.reset,b=c.set,h=f.el,g=f.x,m=f.event.reset,k=f.event.set,y=f.event.x,v=f.extend,x=f.format,w=f.pattern,T=f.timer.set,E="-find-replace",C=o+E+"--"+t;v(l,{tools:{find:["Find and Replace","⌘+F"]},modals:{find:["Mode",["Ignore Case","Match Case","Match Pattern","Match Case and Pattern"]],find_alert:["Not Found","Can’t find “%1”. Find again from top?"]},placeholders:{find:["find…","replace with…"]},labels:{find:["Find","Replace"]}});var B=h(),H=h("input"),S=h("input"),j=h("a"),O=h("label"),G=h("label"),P=h("span");D=l.placeholders.find,$=l.labels.find,R=l.modals.find,z=l.modals.find_alert,k("click",s,q),k("keydown",H,function(e){return L=e.TE.key,K=this.value,e.TE.control("f")||L("backspace")&&!K?(K?Y():q(),y(e)):L("alt")?(I(),y(e)):L("tab")?(!S.value&&(S.value=H.value),S.focus(),S.select(),y(e)):L("enter")&&K?(U(),y(e)):void 0}),k("keydown",S,function(e){return L=e.TE.key,K=this.value,e.TE.control("f")?(K?Y():q(),y(e)):L("backspace")&&!K?(H.focus(),y(e)):L("alt")?(I(),y(e)):L("tab")?(j.focus(),y(e)):L("enter")?(N(e.TE.control()),y(e)):void 0}),k("click",j,I),k("click",P,I),n.tool("find",{i:"binoculars",click:function(e,t){return d(B)[0]?q():Y(),!1}}),n.key("control+f","find")});