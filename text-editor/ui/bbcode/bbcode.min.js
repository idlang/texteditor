/*!
 * ==========================================================
 *  BBCODE TEXT EDITOR PLUGIN 1.1.2
 * ==========================================================
 * Author: Taufik Nurrohman <https://github.com/tovic>
 * License: MIT
 * ----------------------------------------------------------
 */
TE.ui.BBCode=function(e,t){function b(e){return e.split(p("("+m[3]+")+"))[0]}function y(e){return h(e.replace(/\s+/g," "))}function w(e){return d(y(e),[/(<.*?>)|(\[.*?\])/g,/\s/g,'"',"(",")","[","]"],["","%20","%22","%28","%29","%5B","%5D"])}var u,n=TE.ui.HTML||TE.ui,r=n(e,{auto_p:0,advance_table:0,tools:"clear | b i u s | sub sup | a img | p,h1,h2,h3,h4,h5,h6 | blockquote,q pre,code | ul ol | indent outdent | table | hr | undo redo",unit:[[["[","]"]],[["\\u005B","\\u005D"],["\\u003D","\\u0022","\\u0022","\\u0020|\\u003D"]]],formats:{b:"b",i:"i",u:"u",s:"s",a:"url",email:"email",p:"",blockquote:"quote",code:"code",table:"table=1",caption:""}}),i=r.ui,o=r._,f=o.dom.get,a=o.x,s=o.extend,c=o.event.fire,l=o.hook.set,p=o.pattern,d=o.replace,h=o.trim,g=r.config.unit[1][0],m=r.config.unit[1][1];r.update(t,0),r.type="BBCode";var $=r.config,x=$.formats,k=$.languages,_=($.states,$.tab,k.placeholders);return s(i.tools,{a:{click:function(e,t){var n=x.a,r=k.modals.a,u=t.$().value;return/^[a-z]+:\/\/\S+$/i.test(u)?(t.format(n),!1):/^[\w.-]+@[\w.-]+(?:\.[\w.-]+)?$/i.test(u)?(t.format(x.email),!1):(i.prompt(["a[href]",r.title[0]],r.placeholder[0],1,function(e,t,r){t.format(n+"="+w(r))}).record(),!1)}},img:{click:function(e,t){var n=x.img,r=k.modals.img;return t.$().length?(t.format(n),!1):(i.prompt(["img[src]",r.title[0]],r.placeholder[0],1,function(e,t,r){t[0]().format(n).insert(w(r))[1]()}).record(),!1)}},abbr:0,p:{click:function(e,t){return t.$().length?(t.tidy("\n\n").replace(/([\t ]*\n[\t ]*){2,}/g,"\n\n"),!1):(t.tidy("\n\n").insert(_[""]),!1)}},"blockquote,q":{click:function(e,t){return t.format(x.blockquote,0,"\n\n","\n"),!1}},"pre,code":{click:function(e,t){function u(e){return n?d(e,["&","<",">"],["&amp;","&lt;","&gt;"]):e}function o(e){return n?d(e,["&amp;","&lt;","&gt;"],["&","<",">"]):e}var n=$.auto_encode_html,r=x.code,i=b(r);return t[0]().format(r,0,"\n\n","\n").replace(/^[\s\S]*?$/,function(e){return p("^\\s*"+g[0]+g[2]+a(i)+g[1]).test(t.$().after)?u(e):o(e)})[1](),!1}}}),s(i.keys,{"control+shift+?":0}),l("enter.modal.prompt:table>caption",function(e){!x.caption&&(u=f("[name=y]",i.el.modal)[0])&&c("click",u)}),r.update({},0)};