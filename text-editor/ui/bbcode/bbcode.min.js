/*!
 * ==========================================================
 *  BBCODE TEXT EDITOR PLUGIN 1.2.0
 * ==========================================================
 * Author: Taufik Nurrohman <https://github.com/tovic>
 * License: MIT
 * ----------------------------------------------------------
 */
TE.ui.BBCode=function(e,t){function I(e){return e.split(A("("+O[3]+")+"))[0]}function g(e){return f(e.replace(/\s+/g," "))}function p(e){return E(g(e),[/(<.*?>)|(\[.*?\])/g,/\s/g,'"',"(",")","[","]"],["","%20","%22","%28","%29","%5B","%5D"])}var o,n=TE.ui.HTML||TE.ui,a=n(e,{auto_p:0,advance_table:0,tools:"clear | b i u s | sub sup | a img | p,h1,h2,h3,h4,h5,h6 | blockquote,q pre,code | ul ol | indent outdent | table | hr | undo redo",union:[[["\\u005B","\\u005D"],["\\u003D","\\u0022","\\u0022","\\u0020|\\u003D"]],[["[","]"]]],formats:{b:"b",i:"i",u:"u",s:"s",a:"url",email:"email",p:"",blockquote:"quote",code:"code",table:"table=1",caption:""}}),i=a.ui,s=a._,r=s.dom.get,u=s.x,c=s.extend,l=s.events.fire,h=s.hooks.set,A=s.pattern,E=s.replace,f=s.trim,d=a.config.union[0][0],O=a.config.union[0][1];a.update(t,0),a.type="BBCode";var L=a.config,T=L.formats,N=L.languages,U=(L.states,L.tab,N.placeholders);return c(i.tools,{a:{click:function(e,t){var n=T.a,a=N.modals.a,o=t.$().value;return/^[a-z]+:\/\/\S+$/i.test(o)?(t.format(n),!1):/^[\w.-]+@[\w.-]+(?:\.[\w.-]+)?$/i.test(o)?(t.format(T.email),!1):(i.prompt(a.title[0],a.placeholder[0],1,function(e,t,a){t.format(n+"="+p(a))},0,0,"a[href]").record(),!1)}},img:{click:function(e,t){var n=T.img,a=N.modals.img;return t.$().length?(t.format(n),!1):(i.prompt(a.title[0],a.placeholder[0],1,function(e,t,a){t[0]().format(n).insert(p(a))[1]()},0,0,"img[src]").record(),!1)}},abbr:0,p:{click:function(e,t){return t.$().length?(t.tidy("\n\n").replace(/([\t ]*\n[\t ]*){2,}/g,"\n\n").scroll(2),!1):(t.tidy("\n\n").insert(U[""]).scroll(2),!1)}},"blockquote,q":{click:function(e,t){return t.format(T.blockquote,0,"\n\n","\n"),!1}},"pre,code":{click:function(e,t){function o(e){return n?E(e,["&","<",">"],["&amp;","&lt;","&gt;"]):e}function s(e){return n?E(e,["&amp;","&lt;","&gt;"],["&","<",">"]):e}var n=L.auto_encode_html,a=T.code,i=I(a);return t[0]().format(a,0,"\n\n","\n").replace(/^[\s\S]*?$/,function(e){return A("^\\s*"+d[0]+d[2]+u(i)+d[1]).test(t.$().after)?o(e):s(e)})[1](),!1}}}),c(i.keys,{"control+shift+?":0}),h("enter.modal.prompt:table>caption",function(e){!T.caption&&(o=r("[name=y]",i.el.modal)[0])&&l("click",o)}),a.update({},0)};